<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¸ƒå…°ç‰¹ | ä¸å¿˜åˆå¿ƒ</title>
  
  <subtitle>äººå¤„åœ¨ä¸€ç§é»˜é»˜å¥‹æ–—çš„çŠ¶æ€ï¼Œç²¾ç¥å°±ä¼šä»çç¢ç”Ÿæ´»ä¸­å¾—åˆ°å‡å</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="cpeixin.cn/"/>
  <updated>2020-05-28T15:08:18.891Z</updated>
  <id>cpeixin.cn/</id>
  
  <author>
    <name>Brent</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Linuxç›´æ¥ä¸‹è½½Google Driveæ–‡ä»¶</title>
    <link href="cpeixin.cn/2020/05/28/Linux%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BDGoogle-Drive%E6%96%87%E4%BB%B6/"/>
    <id>cpeixin.cn/2020/05/28/Linux%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BDGoogle-Drive%E6%96%87%E4%BB%B6/</id>
    <published>2020-05-27T17:03:54.000Z</published>
    <updated>2020-05-28T15:08:18.891Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>åœ¨Google Colabä¸­è®­ç»ƒå®Œæ¨¡å‹ï¼Œä¿å­˜åœ¨Google Driveä¸­ï¼Œæ•´ä¸ªé¡¹ç›®å¤§å°æœ‰3ã€4GBå¤§å°ï¼Œæ­¤æ—¶æƒ³å°†è¿™æ•´ä¸ªé¡¹ç›®æ”¾åˆ°æœåŠ¡å™¨ä¸­è¿›è¡Œéƒ¨ç½²æµ‹è¯•ã€‚<br><br><br>é¦–é€‰æ–¹æ¡ˆæ˜¯å°†æ•´ä¸ªé¡¹ç›®ä¸Šä¼ åˆ°GitHubä¸­ï¼Œéšååœ¨æœåŠ¡å™¨ä¸­ç›´æ¥wgetï¼Œä½†æ˜¯æ¨¡å‹æ–‡ä»¶è¿‡å¤§ï¼ŒGitHubå•ä¸ªæ–‡ä»¶çš„é™åˆ¶æ˜¯100MBã€‚<br><br><br>çªç„¶æƒ³åˆ°å¯ä¸å¯ä»¥ç›´æ¥ä»Google Driveä¸Šè¿›è¡Œä¸‹è½½æ¨¡å‹æ–‡ä»¶åˆ°æœåŠ¡å™¨ğŸ˜…<br><br><br><strong>ä¸‹è½½å°æ–‡ä»¶ï¼š</strong><br><br><br>é€‰æ‹©è¦ä¸‹è½½çš„æ–‡ä»¶å³é”®<br><br><br>ç‚¹å‡»â€œå…±äº«â€<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1590598566164-b176f9b4-62bf-41d6-82bf-36e8837816f6.png#align=left&display=inline&height=1066&margin=%5Bobject%20Object%5D&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-05-28%20%E4%B8%8A%E5%8D%8812.51.36.png&originHeight=1066&originWidth=1712&size=193930&status=done&style=none&width=1712" alt="å±å¹•å¿«ç…§ 2020-05-28 ä¸Šåˆ12.51.36.png"><br><br><br><br><br>ç‚¹å‡»â€œæ›´æ”¹â€ï¼Œè®¾ç½®åˆ†äº«æƒé™<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1590598584015-3b9be292-6dd3-4edc-86ef-de50b58be55b.png#align=left&display=inline&height=1088&margin=%5Bobject%20Object%5D&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-05-28%20%E4%B8%8A%E5%8D%8812.52.08.png&originHeight=1088&originWidth=2036&size=141068&status=done&style=none&width=2036" alt="å±å¹•å¿«ç…§ 2020-05-28 ä¸Šåˆ12.52.08.png"><br><br><br>è¿™æ˜¯å¤åˆ¶å›¾ä¸­é€‰ä¸­éƒ¨åˆ†çš„ID<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1590598604200-c2f98348-2daf-423b-9792-df03ad395236.png#align=left&display=inline&height=1078&margin=%5Bobject%20Object%5D&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-05-28%20%E4%B8%8A%E5%8D%8812.53.24.png&originHeight=1078&originWidth=1858&size=172147&status=done&style=none&width=1858" alt="å±å¹•å¿«ç…§ 2020-05-28 ä¸Šåˆ12.53.24.png"><br><br><br>æ‹¼æ¥ä¸‹è½½é“¾æ¥ï¼Œè¿›è¡Œä¸‹è½½<br><br><br>wget <a href="https://drive.google.com/uc?id=1sT6GvdtCG3AnV-62beWCP6LNdtFgmX-o" target="_blank" rel="external nofollow noopener noreferrer">https://drive.google.com/uc?id=</a>å¤åˆ¶ä¸‹æ¥çš„å…±äº«id -O your_file_name</p><p><strong>ä¸‹è½½å¤§æ–‡ä»¶ï¼š</strong></p><p>ä¸Šé¢çš„æ–¹æ³•ï¼Œé€‚åˆä¸‹è½½ä¸€äº›å°æ–‡ä»¶ï¼Œå¤§æ–‡ä»¶å°±ä¸å¯ä»¥äº†ã€‚æ›´æ¢ä¸‹é¢å‘½ä»¤çš„idé€‰é¡¹ï¼Œå¹¶ä¸”å‡†å¤‡å¥½cookies.txt<br><br><br>å…³äºcookies.txtï¼Œå¯ä»¥åœ¨Chromeæµè§ˆå™¨ä¸­ä¸‹è½½cookie.txtè¿™ä¸ªæ’ä»¶ï¼Œç‚¹å‡»ä¸‹è½½ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­/tmpç›®å½•ä¸‹å³å¯<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1590678181832-6ba38a09-0ea7-4d48-a6a3-5cd116d19e1d.png#align=left&display=inline&height=1472&margin=%5Bobject%20Object%5D&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-05-28%20%E4%B8%8B%E5%8D%8810.59.19.png&originHeight=1472&originWidth=3094&size=893365&status=done&style=none&width=3094" alt="å±å¹•å¿«ç…§ 2020-05-28 ä¸‹åˆ10.59.19.png"><br><br><br>å…³äºæ–‡ä»¶idï¼Œå’Œä¸Šé¢æ–¹æ³•è·å–ä¸€è‡´ï¼Œæ¥ä¸‹æ¥è¿è¡Œä¸‹é¢å‘½ä»¤å³å¯ã€‚<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&amp;confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=15q9WdqjpZKiVXUo7FOII7O2WLxZag' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=15q9WdqjpZKiVXUo7FOII7O2WLxZagARe" -O pytorch_model.bin</span><br></pre></td></tr></table></figure><br><br><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;åœ¨Google Colabä¸­è®­ç»ƒå®Œæ¨¡å‹ï¼Œä¿å­˜åœ¨Google Driveä¸­ï¼Œæ•´ä¸ªé¡¹ç›®å¤§å°æœ‰3ã€4GBå¤§å°ï¼Œæ­¤æ—¶æƒ³å°†è¿™æ•´ä¸ªé¡¹ç›®æ”¾åˆ°æœåŠ¡å™¨ä¸­è¿›è¡Œéƒ¨ç½²æµ‹
      
    
    </summary>
    
    
      <category term="Tools" scheme="cpeixin.cn/categories/Tools/"/>
    
    
  </entry>
  
  <entry>
    <title>def neverGrowUp()</title>
    <link href="cpeixin.cn/2020/04/06/def-neverGrowUp/"/>
    <id>cpeixin.cn/2020/04/06/def-neverGrowUp/</id>
    <published>2020-04-05T16:00:00.000Z</published>
    <updated>2020-04-05T15:10:24.541Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">neverGrowUp</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">while</span> <span class="title">true</span>:</span></span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br><span class="line">å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒ</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span c
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>æŠ—ç–«è‹±é›„</title>
    <link href="cpeixin.cn/2020/04/04/%E6%8A%97%E7%96%AB%E8%8B%B1%E9%9B%84/"/>
    <id>cpeixin.cn/2020/04/04/%E6%8A%97%E7%96%AB%E8%8B%B1%E9%9B%84/</id>
    <published>2020-04-04T14:45:15.000Z</published>
    <updated>2020-04-05T14:46:33.308Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>è‡´æ•¬ç¼…æ€€æ¯ä¸€ä½æŠ—ç–«è‹±é›„<br><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/1072113/1586098032229-b4c6c795-bf87-4105-8f82-87a86e48a89a.jpeg#align=left&display=inline&height=1796&name=WechatIMG86.jpeg&originHeight=1796&originWidth=1072&size=175464&status=done&style=none&width=1072" alt="WechatIMG86.jpeg"></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;è‡´æ•¬ç¼…æ€€æ¯ä¸€ä½æŠ—ç–«è‹±é›„&lt;br&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2020/jpeg/1072113
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>python Flask &amp; Ajax æ•°æ®ä¼ è¾“</title>
    <link href="cpeixin.cn/2020/03/11/python-Flask-Ajax-%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93/"/>
    <id>cpeixin.cn/2020/03/11/python-Flask-Ajax-%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93/</id>
    <published>2020-03-11T14:43:01.000Z</published>
    <updated>2020-04-04T17:13:00.080Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>å¸®æœ‹å‹å†™ä¸ªå°å·¥å…·ï¼Œæ²¡æƒ³åˆ°è¿˜è¦æå®šJSï¼Œå¤§å­¦æ¯•ä¸šåå°±æ²¡æœ‰å†™è¿‡JSï¼ŒçœŸçš„æ˜¯éš¾ä¸ºæˆ‘äº†ğŸ˜‚</p><p>å¿™æ´»ä¸‰ä¸ªå°æ—¶ï¼Œç»ˆäºæŠŠå‰ç«¯å’Œåç«¯æ‰“é€šäº†ï½ï½</p><p>å‰ç«¯demoï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å‘é€æ•°æ®ï¼Œè¡¨å•æ–¹å¼ ï¼ˆæ³¨æ„ï¼šåç«¯æ¥æ”¶æ•°æ®å¯¹åº”ä»£ç ä¸åŒï¼‰--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&#123;&#123; url_for('send_message') &#125;&#125;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span> =<span class="string">"domain"</span> <span class="attr">rows</span>=<span class="string">"30"</span> <span class="attr">cols</span>=<span class="string">"100"</span> <span class="attr">placeholder</span>=<span class="string">"è¯·è¾“å…¥éœ€è¦æŸ¥è¯¢çš„åŸŸå,å¦‚cq5999.com"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;input id="submit" type="submit" value="å‘é€"&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"btn-bq"</span> <span class="attr">data-toggle</span>=<span class="string">"modal"</span> <span class="attr">data-target</span>=<span class="string">"#myModal"</span>&gt;</span>æŸ¥è¯¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å‘é€æ•°æ®ï¼Œinputæ–¹å¼ ï¼ˆæ³¨æ„ï¼šåç«¯æ¥æ”¶æ•°æ®å¯¹åº”ä»£ç ä¸åŒï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"send_content"</span>&gt;</span>å‘åå°å‘é€æ¶ˆæ¯ï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"send_content"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"send_content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"send"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"å‘é€"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"recv_content"</span>&gt;</span>ä»åå°æ¥æ”¶æ¶ˆæ¯ï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"recv_content"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"recv_content"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- inputæ–¹å¼ å¯¹åº”çš„jsä»£ç ï¼Œå¦‚ç”¨è¡¨å•æ–¹å¼è¯·æ³¨é‡Šæ‰ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å‘é€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">"#send"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> message = $(<span class="string">"#send_content"</span>).val()</span></span><br><span class="line">        alert(message)</span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">            url:<span class="string">"/send_message"</span>,</span></span><br><span class="line"><span class="actionscript">            type:<span class="string">"POST"</span>,</span></span><br><span class="line">            data:&#123;</span><br><span class="line">                message:message</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            dataType: <span class="string">'json'</span>,</span></span><br><span class="line"><span class="actionscript">            success:<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ¥æ”¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">"#send"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $.getJSON(<span class="string">"/change_to_json"</span>,<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">"#recv_content"</span>).val(data.message) <span class="comment">//å°†åç«¯æ•°æ®æ˜¾ç¤ºåœ¨å‰ç«¯</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">"ä¼ åˆ°å‰ç«¯çš„æ•°æ®çš„ç±»å‹ï¼š"</span> + <span class="keyword">typeof</span> (data.message))</span></span><br><span class="line"><span class="javascript">            $(<span class="string">"#send_content"</span>).val(<span class="string">""</span>)<span class="comment">//å‘é€çš„è¾“å…¥æ¡†æ¸…ç©º</span></span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åç«¯demo:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">"index_v6.html"</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/send_message', methods=['POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_message</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> message_get</span><br><span class="line">    message_get = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    message_get = request.form[<span class="string">"domain"</span>].split(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="comment"># message_get = request.form['message'] #inputæäº¤</span></span><br><span class="line">    print(<span class="string">"æ”¶åˆ°å‰ç«¯å‘è¿‡æ¥çš„ä¿¡æ¯ï¼š%s"</span> % message_get)</span><br><span class="line">    print(<span class="string">"æ”¶åˆ°æ•°æ®çš„ç±»å‹ä¸ºï¼š"</span> + str(type(message_get)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"æ”¶åˆ°æ¶ˆæ¯"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/change_to_json', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_to_json</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> message_get</span><br><span class="line">    message_json = &#123;</span><br><span class="line">        <span class="string">"message"</span>: message_get</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonify(message_json)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;å¸®æœ‹å‹å†™ä¸ªå°å·¥å…·ï¼Œæ²¡æƒ³åˆ°è¿˜è¦æå®šJSï¼Œå¤§å­¦æ¯•ä¸šåå°±æ²¡æœ‰å†™è¿‡JSï¼ŒçœŸçš„æ˜¯éš¾ä¸ºæˆ‘äº†ğŸ˜‚&lt;/p&gt;&lt;p&gt;å¿™æ´»ä¸‰ä¸ªå°æ—¶ï¼Œç»ˆäºæŠŠå‰ç«¯å’Œåç«¯æ‰“é€šäº†ï½ï½&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="python" scheme="cpeixin.cn/categories/python/"/>
    
    
      <category term="flask" scheme="cpeixin.cn/tags/flask/"/>
    
  </entry>
  
  <entry>
    <title>Python Flaskæ¥å£è®¾è®¡-ç¤ºä¾‹</title>
    <link href="cpeixin.cn/2020/03/10/Python-Flask%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1-%E7%A4%BA%E4%BE%8B/"/>
    <id>cpeixin.cn/2020/03/10/Python-Flask%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1-%E7%A4%BA%E4%BE%8B/</id>
    <published>2020-03-10T15:08:35.000Z</published>
    <updated>2020-04-04T17:12:52.356Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="LHF1q"></a></p><h3 id="Get-è¯·æ±‚"><a href="#Get-è¯·æ±‚" class="headerlink" title="Get è¯·æ±‚"></a>Get è¯·æ±‚</h3><p><strong><strong>å¼€å‘ä¸€ä¸ªåªæ¥å—getæ–¹æ³•çš„æ¥å£ï¼Œæ¥å—å‚æ•°ä¸ºnameå’Œageï¼Œå¹¶è¿”å›ç›¸åº”å†…å®¹ã€‚</strong></strong><br><strong><br>**</strong>æ–¹æ³• 1:****</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/test_1.0", methods=["GET"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="comment"># é»˜è®¤è¿”å›å†…å®¹</span></span><br><span class="line">  return_dict = &#123;<span class="string">'return_code'</span>: <span class="string">'200'</span>, <span class="string">'return_info'</span>: <span class="string">'å¤„ç†æˆåŠŸ'</span>, <span class="string">'result'</span>: <span class="literal">False</span>&#125;</span><br><span class="line">  <span class="comment"># åˆ¤æ–­å…¥å‚æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">  <span class="keyword">if</span> request.args <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    return_dict[<span class="string">'return_code'</span>] = <span class="string">'5004'</span></span><br><span class="line">    return_dict[<span class="string">'return_info'</span>] = <span class="string">'è¯·æ±‚å‚æ•°ä¸ºç©º'</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(return_dict, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">  <span class="comment"># è·å–ä¼ å…¥çš„paramså‚æ•°</span></span><br><span class="line">  get_data = request.args.to_dict()</span><br><span class="line">  name = get_data.get(<span class="string">'name'</span>)</span><br><span class="line">  age = get_data.get(<span class="string">'age'</span>)</span><br><span class="line">  <span class="comment"># å¯¹å‚æ•°è¿›è¡Œæ“ä½œ</span></span><br><span class="line">  return_dict[<span class="string">'result'</span>] = tt(name, age)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> json.dumps(return_dict, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠŸèƒ½å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tt</span><span class="params">(name, age)</span>:</span></span><br><span class="line">  result_str = <span class="string">"%sä»Šå¹´%så²"</span> % (name, age)</span><br><span class="line">  <span class="keyword">return</span> result_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>æ­¤ç§æ–¹å¼å¯¹åº”çš„requestè¯·æ±‚æ–¹å¼ï¼š</p><ol><li>æ‹¼æ¥è¯·æ±‚é“¾æ¥, ç›´æ¥è¯·æ±‚ï¼š<a href="http://0.0.0.0/test_1.0?name=ccc&age=18" target="_blank" rel="external nofollow noopener noreferrer">http://0.0.0.0/test_1.0?name=ccc&amp;age=18</a></li><li>request è¯·æ±‚ä¸­å¸¦æœ‰å‚æ•°ï¼Œå¦‚ä¸‹å›¾</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1583826674613-bc99538a-988e-4386-b8e6-9eb9fce1862f.png#align=left&display=inline&height=610&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-03-10%20%E4%B8%8B%E5%8D%883.47.43.png&originHeight=610&originWidth=1424&size=98593&status=done&style=none&width=1424" alt="å±å¹•å¿«ç…§ 2020-03-10 ä¸‹åˆ3.47.43.png"></p><p>æ–¹æ³• 2:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/api/banWordSingle/&lt;string:word&gt;', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">banWordSingleStart</span><span class="params">(word)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> getWordStatus(word)</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³• ä¸ æ–¹æ³• 1 ä¸­çš„æ‹¼æ¥é“¾æ¥ç›¸ä¼¼ï¼Œä½†æ˜¯ä¸ç”¨è¾“å…¥å…³é”®å­—</p><p>è¯·æ±‚é“¾æ¥ï¼š<a href="http://0.0.0.0/test_1.0?name=ccc&age=18" target="_blank" rel="external nofollow noopener noreferrer">http://0.0.0.0</a>/api/banWordSingle/è¾“å…¥è¯</p><p><a name="vJdOc"></a></p><h3 id="Post-è¯·æ±‚"><a href="#Post-è¯·æ±‚" class="headerlink" title="Post è¯·æ±‚"></a>Post è¯·æ±‚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/test_1.0", methods=["POST"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="comment"># é»˜è®¤è¿”å›å†…å®¹</span></span><br><span class="line">  return_dict = &#123;<span class="string">'return_code'</span>: <span class="string">'200'</span>, <span class="string">'return_info'</span>: <span class="string">'å¤„ç†æˆåŠŸ'</span>, <span class="string">'result'</span>: <span class="literal">False</span>&#125;</span><br><span class="line">  <span class="comment"># åˆ¤æ–­å…¥å‚æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">  <span class="keyword">if</span> request.args <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    return_dict[<span class="string">'return_code'</span>] = <span class="string">'5004'</span></span><br><span class="line">    return_dict[<span class="string">'return_info'</span>] = <span class="string">'è¯·æ±‚å‚æ•°ä¸ºç©º'</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(return_dict, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">  <span class="comment"># è·å–ä¼ å…¥çš„paramså‚æ•°</span></span><br><span class="line">  get_data = request.args.to_dict()</span><br><span class="line">  name = get_data.get(<span class="string">'name'</span>)</span><br><span class="line">  age = get_data.get(<span class="string">'age'</span>)</span><br><span class="line">  <span class="comment"># å¯¹å‚æ•°è¿›è¡Œæ“ä½œ</span></span><br><span class="line">  return_dict[<span class="string">'result'</span>] = tt(name, age)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> json.dumps(return_dict, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠŸèƒ½å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tt</span><span class="params">(name, age)</span>:</span></span><br><span class="line">  result_str = <span class="string">"%sä»Šå¹´%så²"</span> % (name, age)</span><br><span class="line">  <span class="keyword">return</span> result_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>è¯·æ±‚æ–¹å¼ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1583831085097-3a858ae4-259d-408d-a162-6a4ed8c5e291.png#align=left&display=inline&height=692&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-03-10%20%E4%B8%8B%E5%8D%885.00.28.png&originHeight=692&originWidth=1438&size=99272&status=done&style=none&width=1438" alt="å±å¹•å¿«ç…§ 2020-03-10 ä¸‹åˆ5.00.28.png"></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;LHF1q&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h3 id=&quot;Get-è¯·æ±‚&quot;&gt;&lt;a href=&quot;#Get-è¯·æ±‚&quot; class=&quot;headerl
      
    
    </summary>
    
    
      <category term="python" scheme="cpeixin.cn/categories/python/"/>
    
    
      <category term="flask" scheme="cpeixin.cn/tags/flask/"/>
    
  </entry>
  
  <entry>
    <title>IDEA install TabNine</title>
    <link href="cpeixin.cn/2020/01/22/IDEA-install-TabNine/"/>
    <id>cpeixin.cn/2020/01/22/IDEA-install-TabNine/</id>
    <published>2020-01-22T02:26:15.000Z</published>
    <updated>2020-04-04T11:06:48.223Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>TabNineæ˜¯æˆ‘ç›®å‰é‡åˆ°è¿‡æœ€å¥½çš„æ™ºèƒ½è¡¥å…¨å·¥å…·</p><p>TabNineåŸºäºGPT-2çš„æ’ä»¶</p><p>å®‰è£…<br>IDEAç¼–è¯‘å™¨ï¼Œæ‰¾åˆ°plugins</p><p>Windows pycharmï¼šFile&gt;settings&gt;plugins;<br>Mac pycharmï¼šperformence&gt;plugins&gt;marketplace or plugins&gt;Install JetBrains Plugins</p><p>æŸ¥æ‰¾ TabNine, ç‚¹å‡» install, éšå restart</p><p>é‡å¯åï¼šHelp&gt;Edit Custom Propertiesâ€¦&gt;Create;</p><p>åœ¨è·³å‡ºæ¥çš„idea.propertiesä¸­è¾“å…¥ï¼ˆæ³¨ï¼šè‹±æ–‡å­—ç¬¦ï¼‰ TabNine::config</p><p>éšå³ä¼šè‡ªåŠ¨å¼¹å‡ºTabNineæ¿€æ´»é¡µé¢ï¼›</p><p>æ¿€æ´»<br>ç‚¹å‡»Activation Keyä¸‹é¢çš„hereï¼›</p><p>è¾“å…¥ä½ çš„é‚®ç®±å·ï¼›</p><p>å¤åˆ¶ç²˜è´´é‚®ä»¶é‡Œé¢çš„API Keyåˆ°Activation Keyä¸‹é¢ï¼›ï¼ˆå¾—åˆ°çš„ key å¯ä»¥åœ¨å„ç§ç¼–è¯‘å™¨ä¸­å…±ç”¨ï¼‰</p><p>ç­‰å¾…è‡ªåŠ¨å®‰è£…ï¼Œè§‚å¯Ÿé¡µé¢ï¼ˆæœ€ä¸‹é¢æœ‰logå¯ä»¥çœ‹å½“å‰è¿›åº¦ï¼‰ï¼›</p><p>æ¿€æ´»å®ŒæˆåTabNine Cloudä¸ºEnabledçŠ¶æ€ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å®‰è£…è¿›åº¦å®Œæˆååˆ·æ–°é¡µé¢æ‰‹åŠ¨é€‰æ‹©Enabledï¼›</p><p>ç¡®è®¤æ¿€æ´»å®Œæˆï¼Œé‡å¯pycharmå³å¯ï¼›</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;TabNineæ˜¯æˆ‘ç›®å‰é‡åˆ°è¿‡æœ€å¥½çš„æ™ºèƒ½è¡¥å…¨å·¥å…·&lt;/p&gt;&lt;p&gt;TabNineåŸºäºGPT-2çš„æ’ä»¶&lt;/p&gt;&lt;p&gt;å®‰è£…&lt;br&gt;IDEAç¼–è¯‘å™¨ï¼Œæ‰¾åˆ°pl
      
    
    </summary>
    
    
      <category term="å¼€å‘å·¥å…·" scheme="cpeixin.cn/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="IDEA" scheme="cpeixin.cn/tags/IDEA/"/>
    
  </entry>
  
  <entry>
    <title>GPT-2 Chinese è‡ªåŠ¨ç”Ÿæˆæ–‡ç«  - ç¯å¢ƒå‡†å¤‡</title>
    <link href="cpeixin.cn/2020/01/01/GPT-2-Chinese-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%96%87%E7%AB%A0-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/"/>
    <id>cpeixin.cn/2020/01/01/GPT-2-Chinese-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%96%87%E7%AB%A0-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</id>
    <published>2020-01-01T14:28:43.000Z</published>
    <updated>2020-04-13T09:28:23.224Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="R14AA"></a></p><h2 id="Google-Colab"><a href="#Google-Colab" class="headerlink" title="Google Colab"></a>Google Colab</h2><p><br>Colaboratory æ˜¯ä¸€ä¸ª Google ç ”ç©¶é¡¹ç›®ï¼Œæ—¨åœ¨å¸®åŠ©ä¼ æ’­æœºå™¨å­¦ä¹ åŸ¹è®­å’Œç ”ç©¶æˆæœã€‚å®ƒæ˜¯ä¸€ä¸ª Jupyter ç¬”è®°æœ¬ç¯å¢ƒï¼Œä¸éœ€è¦è¿›è¡Œä»»ä½•è®¾ç½®å°±å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”å®Œå…¨åœ¨äº‘ç«¯è¿è¡Œã€‚<br><br><br>Colaboratory ç¬”è®°æœ¬å­˜å‚¨åœ¨ Google äº‘ç«¯ç¡¬ç›˜ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å…±äº«ï¼Œå°±å¦‚åŒæ‚¨ä½¿ç”¨ Google æ–‡æ¡£æˆ–è¡¨æ ¼ä¸€æ ·ã€‚Colaboratory å¯å…è´¹ä½¿ç”¨ã€‚åˆ©ç”¨Colaboratory ï¼Œå¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨Keras,TensorFlow,PyTorchç­‰æ¡†æ¶è¿›è¡Œæ·±åº¦å­¦ä¹ åº”ç”¨çš„å¼€å‘ã€‚<br><br><br>ç¼ºç‚¹æ˜¯æœ€å¤šåªèƒ½è¿è¡Œ12å°æ—¶ï¼Œæ—¶é—´ä¸€åˆ°å°±ä¼šæ¸…ç©ºVMä¸Šæ‰€æœ‰æ•°æ®ã€‚è¿™åŒ…æ‹¬æˆ‘ä»¬å®‰è£…çš„è½¯ä»¶ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä¸‹è½½çš„æ•°æ®ï¼Œå­˜æ”¾çš„è®¡ç®—ç»“æœï¼Œ æ‰€ä»¥æœ€å¥½ä¸è¦ç›´æ¥åœ¨colabä¸Šè¿›è¡Œæ–‡ä»¶çš„ä¿®æ”¹ï¼Œä»¥é˜²ä¿å­˜ä¸åŠæ—¶è€Œé€ æˆä¸¢å¤±ï¼Œè€Œä¸”Google Driveåªæœ‰å…è´¹çš„15Gç©ºé—´ï¼Œå¦‚æœè®­ç»ƒæ–‡ä»¶å¾ˆå¤§çš„è¯ï¼Œéœ€è¦æ‰©å®¹ã€‚<br><br><br><strong>ä¼˜ç‚¹ å…è´¹ï¼ å…è´¹ï¼å…è´¹ï¼</strong><br>**<br><a name="dpofS"></a></p><h3 id="è°·æ­Œäº‘ç›˜"><a href="#è°·æ­Œäº‘ç›˜" class="headerlink" title="è°·æ­Œäº‘ç›˜"></a>è°·æ­Œäº‘ç›˜</h3><p><br>å½“ç™»å½•è´¦å·è¿›å…¥<a href="https://drive.google.com/drive/my-drive" target="_blank" rel="external nofollow noopener noreferrer">è°·æ­Œäº‘ç›˜</a>æ—¶ï¼Œç³»ç»Ÿä¼šç»™äºˆ15Gå…è´¹ç©ºé—´å¤§å°ã€‚ç”±äºColabéœ€è¦ä¾é è°·æ­Œäº‘ç›˜ï¼Œæ•…éœ€è¦åœ¨äº‘ç›˜ä¸Šæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¥å­˜æ”¾ä½ çš„ä»£ç æˆ–è€…æ•°æ®ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1583723531238-28bbbd81-69e8-472d-b048-1ac67166a201.png#align=left&display=inline&height=612&name=image.png&originHeight=612&originWidth=1268&size=104029&status=done&style=none&width=1268" alt="image.png"><br>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ï¼Œæˆ‘çš„å­˜å‚¨ç©ºé—´å‡ ä¹å¿«æ»¡äº†ï¼Œåœ¨é€‰æ‹©è¿›è¡Œæ‰©å®¹çš„æ—¶å€™å‘¢ï¼Œåˆ™éœ€è¦å›½å¤–é“¶è¡Œå¡å’Œå›½å¤–æ”¯ä»˜æ–¹å¼ï¼Œè¿™ä¸€ç‚¹å°±æœ‰ç‚¹å¤´ç—›ï¼Œä½†æ˜¯ä¸è¦å¿˜è®°ä¸‡èƒ½çš„æ·˜å®ï¼Œæœ€åé€šè¿‡æ·˜å®çš„ï¼ŒèŠ±è´¹20å…ƒå·¦å³ï¼Œå°±å‡çº§åˆ°äº†æ— é™ç©ºé—´ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå‡çº§å­˜å‚¨ç©ºé—´çš„æ–¹å¼æ˜¯æ·»åŠ ä¸€å—å…±äº«äº‘ç›˜ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><a name="EHdj9"></a></p><h3 id="å¼•å…¥Colab"><a href="#å¼•å…¥Colab" class="headerlink" title="å¼•å…¥Colab"></a>å¼•å…¥Colab</h3><p><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1583723706098-527d9fff-e46e-4dd1-b92a-0640b0d61555.png#align=left&display=inline&height=674&name=image.png&originHeight=674&originWidth=1125&size=104056&status=done&style=none&width=1125" alt="image.png"><br><br><br><br><br></p><p><a name="kykCO"></a></p><h3 id="è®¾ç½®GPUç¯å¢ƒ"><a href="#è®¾ç½®GPUç¯å¢ƒ" class="headerlink" title="è®¾ç½®GPUç¯å¢ƒ"></a>è®¾ç½®GPUç¯å¢ƒ</h3><p><br>æ‰“å¼€colabåï¼Œæˆ‘ä»¬è¦è®¾ç½®è¿è¡Œç¯å¢ƒã€‚â€ä¿®æ”¹â€â€”&gt;â€ç¬”è®°æœ¬è®¾ç½®â€<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1583723911273-f07371f9-e982-44b2-af34-b3781f294879.png#align=left&display=inline&height=739&name=image.png&originHeight=739&originWidth=1191&size=94677&status=done&style=none&width=1191" alt="image.png"><br><br><br></p><p><a name="f4U2h"></a></p><h3 id="æŒ‚è½½å’Œåˆ‡æ¢å·¥ä½œç›®å½•"><a href="#æŒ‚è½½å’Œåˆ‡æ¢å·¥ä½œç›®å½•" class="headerlink" title="æŒ‚è½½å’Œåˆ‡æ¢å·¥ä½œç›®å½•"></a>æŒ‚è½½å’Œåˆ‡æ¢å·¥ä½œç›®å½•</h3><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> google.colab <span class="keyword">import</span> drive</span><br><span class="line">drive.mount(<span class="string">'/content/drive'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># os.chdir('/content/drive/My Drive/code/GPT2-Chinese') # åŸæœ¬Google driveçš„ç›®å½•</span></span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">'/content/drive/Shared drives/brentfromchina/code_warehouse/GPT2-Chinese'</span>) <span class="comment">## å…±äº«äº‘ç›˜çš„ç›®å½•</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š My Drive ä»£è¡¨ä½ çš„googleç½‘ç›˜æ ¹ç›®å½•</p><pre><code>code/GPT2-Chinese æˆ–è€… code_warehouse/GPT2-Chinese ä»£è¡¨ç½‘ç›˜ä¸­ä½ çš„ç¨‹åºæ–‡ä»¶ç›®å½•</code></pre><p><a name="MyewB"></a></p><h3 id="åœ¨Colabä¸­è¿è¡Œä»»åŠ¡"><a href="#åœ¨Colabä¸­è¿è¡Œä»»åŠ¡" class="headerlink" title="åœ¨Colabä¸­è¿è¡Œä»»åŠ¡"></a>åœ¨Colabä¸­è¿è¡Œä»»åŠ¡</h3><p>ä¸‹å›¾æ˜¯æˆ‘google driveä¸­çš„æ–‡ä»¶ç»“æ„ï¼Œ åœ¨é¡¹ç›®æ–‡ä»¶ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª.ipynbæ–‡ä»¶ï¼Œæ¥æ‰§è¡Œä½ çš„æ‰€æœ‰æ“ä½œã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586769633567-4e4118a0-5c52-4517-9233-71d897e7fd68.png#align=left&display=inline&height=1748&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-04-13%20%E4%B8%8B%E5%8D%885.15.46.png&originHeight=1748&originWidth=3096&size=378104&status=done&style=none&width=3096" alt="å±å¹•å¿«ç…§ 2020-04-13 ä¸‹åˆ5.15.46.png"></p><p><a name="GZDbL"></a></p><h3 id="ipynbæ–‡ä»¶å†…å®¹"><a href="#ipynbæ–‡ä»¶å†…å®¹" class="headerlink" title=".ipynbæ–‡ä»¶å†…å®¹"></a>.ipynbæ–‡ä»¶å†…å®¹</h3><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586769997876-4536842e-6bb3-4d6f-8df9-e220a66026a0.png#align=left&display=inline&height=1702&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-04-13%20%E4%B8%8B%E5%8D%885.23.22.png&originHeight=1702&originWidth=3154&size=396138&status=done&style=none&width=3154" alt="å±å¹•å¿«ç…§ 2020-04-13 ä¸‹åˆ5.23.22.png"><br><br><br></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;R14AA&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2 id=&quot;Google-Colab&quot;&gt;&lt;a href=&quot;#Google-Colab&quot; cl
      
    
    </summary>
    
    
      <category term="NLP" scheme="cpeixin.cn/categories/NLP/"/>
    
    
      <category term="GPT-2" scheme="cpeixin.cn/tags/GPT-2/"/>
    
  </entry>
  
  <entry>
    <title>æ¶æ„æ€æƒ³</title>
    <link href="cpeixin.cn/2019/12/20/%E6%9E%B6%E6%9E%84%E6%80%9D%E6%83%B3/"/>
    <id>cpeixin.cn/2019/12/20/%E6%9E%B6%E6%9E%84%E6%80%9D%E6%83%B3/</id>
    <published>2019-12-20T02:26:15.000Z</published>
    <updated>2020-04-04T11:23:45.206Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="-2"></a></p><h2><a href="#" class="headerlink"></a></h2><p>å…³äºä»€ä¹ˆæ˜¯æ¶æ„ï¼Œä¸€ç§æ¯”è¾ƒé€šä¿—çš„è¯´æ³•æ˜¯ â€œæœ€é«˜å±‚æ¬¡çš„è§„åˆ’ï¼Œéš¾ä»¥æ”¹å˜çš„å†³å®šâ€ï¼Œè¿™äº›è§„åˆ’å’Œå†³å®šå¥ å®šäº†äº‹ç‰©æœªæ¥å‘å±•çš„æ–¹å‘å’Œæœ€ç»ˆçš„è“å›¾ã€‚<br><br><br>ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼Œäººç”Ÿè§„åˆ’ä¹Ÿæ˜¯ä¸€ç§æ¶æ„ã€‚é€‰ä»€ä¹ˆå­¦æ ¡ã€å­¦ä»€ä¹ˆä¸“ä¸šã€è¿›ä»€ä¹ˆå…¬å¸ã€æ‰¾ä»€ä¹ˆå¯¹è±¡ï¼Œè¿‡ä»€ä¹ˆæ ·çš„ç”Ÿæ´»ï¼Œéƒ½æ˜¯è‡ªå·±äººç”Ÿçš„æ¶æ„ã€‚<br><br><br>å…·ä½“åˆ°è½¯ä»¶æ¶æ„ï¼Œç»´åŸºç™¾ç§‘æ˜¯è¿™æ ·å®šä¹‰çš„ï¼šâ€œæœ‰å…³è½¯ä»¶æ•´ä½“ç»“æ„ä¸ç»„ä»¶çš„æŠ½è±¡æè¿°ï¼Œç”¨äºæŒ‡å¯¼å¤§å‹è½¯ä»¶ç³»ç»Ÿå„ä¸ªæ–¹é¢çš„è®¾è®¡â€ã€‚ç³»ç»Ÿçš„å„ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†åŠå…¶å…³ç³»æ„æˆäº†ç³»ç»Ÿçš„æ¶æ„ï¼Œè¿™äº›ç»„æˆéƒ¨åˆ†å¯ä»¥æ˜¯å…·ä½“çš„åŠŸèƒ½æ¨¡å—ï¼Œä¹Ÿå¯ä»¥æ˜¯éåŠŸèƒ½çš„è®¾è®¡ä¸å†³ç­–ï¼Œä»–ä»¬ç›¸äº’å…³ç³»ç»„æˆä¸€ä¸ªæ•´ä½“ï¼Œå…±åŒæ„æˆäº†è½¯ä»¶ç³»ç»Ÿçš„æ¶æ„ã€‚<br><br><br>æ¶æ„å…¶å®å°±æ˜¯æŠŠå¤æ‚çš„é—®é¢˜æŠ½è±¡åŒ–ã€ç®€å•åŒ–ï¼Œå¯èƒ½ä½ ä¼šè§‰å¾—â€œè¯´èµ·æ¥å®¹æ˜“ä½†åšèµ·æ¥éš¾â€ï¼Œå¦‚ä½•èƒ½å¿«é€Ÿä¸Šæ‰‹ã€‚å¯ä»¥å¤šè§‚å¯Ÿï¼Œæ ¹æ®ç‰©è´¨å†³å®šæ„è¯†ï¼Œå€ŸåŠ©ç”Ÿæ´»çœŸå®åœºæ™¯ï¼ˆç”¨æˆ·æ•…äº‹ï¼Œè¦å¾ˆå¤šæ•…äº‹ï¼‰æ¥è¿˜åŸè¿™ä¸€ç³»åˆ—é—®é¢˜ï¼ŒæŠ“ä½å¹¶æå–æ ¸å¿ƒç‰¹å¾ã€‚<br><a name="-3"></a></p><h4 id="æ¶æ„æ€æƒ³"><a href="#æ¶æ„æ€æƒ³" class="headerlink" title="æ¶æ„æ€æƒ³"></a>æ¶æ„æ€æƒ³</h4><p>CPUè¿ç®—é€Ÿåº¦&gt;&gt;&gt;&gt;&gt;å†…å­˜çš„è¯»å†™é€Ÿåº¦&gt;&gt;&gt;&gt;ç£ç›˜è¯»å†™é€Ÿåº¦</p><ul><li><p>æ»¡è¶³ä¸šåŠ¡å‘å±•éœ€æ±‚æ˜¯æœ€é«˜å‡†åˆ™</p></li><li><p>ä¸šåŠ¡å»ºæ¨¡ï¼ŒæŠ½è±¡å’Œæšä¸¾æ˜¯ä¸¤ç§æ–¹å¼ï¼Œéœ€è¦å¹³è¡¡ï¼Œä¸èƒ½èµ°æç«¯</p></li><li><p>æ¨¡å‹è¦èƒ½æ›´çœŸå®çš„ååº”äº‹ç‰©çš„æœ¬è´¨ï¼Œä¸æ˜¯åè¯æ¦‚å¿µçš„å †ç Œï¼Œä¸èƒ½è¿‡åº¦è®¾è®¡</p></li><li><p>åŸºç¡€æ¶æ„æœ€å…³é”®çš„æ˜¯åˆ†ç¦»ä¸åŒä¸šåŠ¡é¢†åŸŸã€ä¸åŒæŠ€æœ¯é¢†åŸŸï¼Œè®©æ•´ä¸ªç³»ç»Ÿå…·æœ‰æŒç»­ä¼˜åŒ–çš„èƒ½åŠ›ã€‚</p></li><li><p>åˆ†ç¦»åŸºç¡€æœåŠ¡ã€ä¸šåŠ¡è§„åˆ™ã€ä¸šåŠ¡æµç¨‹ï¼Œé€‰æ‹©åˆé€‚çš„å·¥å…·å¤–åŒ–ä¸šåŠ¡è§„åˆ™å’Œä¸šåŠ¡æµç¨‹</p></li><li><p>åˆ†ç¦»ä¸šåŠ¡ç»„ä»¶å’ŒæŠ€æœ¯ç»„ä»¶ï¼Œé«˜ç±»èšï¼Œä½è€¦åˆ - ä¸šåŠ¡ä¿¡æ¯çš„æ‰§è¡Œå¯ä»¥åˆ†æ•£ï¼Œä½†ä¸šåŠ¡ä¿¡æ¯çš„ç®¡ç†è¦å°½é‡é›†ä¸­</p></li><li><p>ä¸è¦è®©è½¯ä»¶çš„é€»è¾‘æ¶æ„ä¸æœ€åç‰©ç†éƒ¨ç½²ç»‘æ­» - é€‰æ‹©åˆé€‚çš„æŠ€æœ¯è€Œä¸æ˜¯é«˜æ·±çš„æŠ€æœ¯ï¼Œéšç€ä¸šåŠ¡çš„å‘å±•è°ƒæ•´ä½¿ç”¨çš„æŠ€æœ¯</p></li><li><p>å¥½çš„ç³»ç»Ÿæ¶æ„éœ€è¦åˆé€‚çš„ç»„ç»‡æ¶æ„å»ä¿éšœ - å›¢é˜Ÿæˆå‘˜æ€æƒ³çš„è½¬å˜ï¼Œæ¼«é•¿è€Œè‰°éš¾</p></li><li><p>ä¸šåŠ¡æ¶æ„ã€ç³»ç»Ÿæ¶æ„ã€æ•°æ®æ¨¡å‹<br><a name="-4"></a></p><h4 id="é¢å¯¹ä¸€å—æ–°ä¸šåŠ¡ï¼Œå¦‚ä½•ç³»ç»Ÿæ¶æ„ï¼Ÿ"><a href="#é¢å¯¹ä¸€å—æ–°ä¸šåŠ¡ï¼Œå¦‚ä½•ç³»ç»Ÿæ¶æ„ï¼Ÿ" class="headerlink" title="é¢å¯¹ä¸€å—æ–°ä¸šåŠ¡ï¼Œå¦‚ä½•ç³»ç»Ÿæ¶æ„ï¼Ÿ"></a>é¢å¯¹ä¸€å—æ–°ä¸šåŠ¡ï¼Œå¦‚ä½•ç³»ç»Ÿæ¶æ„ï¼Ÿ</h4></li><li><p>ä¸šåŠ¡åˆ†æï¼šè¾“å‡ºä¸šåŠ¡æ¶æ„å›¾ï¼Œè¿™ä¸ªç³»ç»Ÿé‡Œæœ‰å¤šå°‘ä¸ªä¸šåŠ¡æ¨¡å—ï¼Œä»å‰å°ç”¨æˆ·åˆ°åº•å±‚ä¸€å…±æœ‰å¤šå°‘å±‚ã€‚</p></li><li><p>ç³»ç»Ÿåˆ’åˆ†ï¼šæ ¹æ®ä¸šåŠ¡æ¶æ„å›¾è¾“å‡ºç³»ç»Ÿæ¶æ„å›¾ï¼Œéœ€è¦æ€è€ƒçš„æ˜¯è¿™å—ä¸šåŠ¡åˆ’åˆ†æˆå¤šå°‘ä¸ªç³»ç»Ÿï¼Œå¯èƒ½ä¸€ä¸ªç³»ç»Ÿèƒ½æ”¯æŒå¤šä¸ªä¸šåŠ¡ã€‚åŸºäºä»€ä¹ˆåŸåˆ™å°†ä¸€ä¸ªç³»ç»Ÿæ‹†åˆ†æˆå¤šä¸ªç³»ç»Ÿï¼ŸåˆåŸºäºä»€ä¹ˆåŸåˆ™å°†ä¸¤ä¸ªç³»ç»Ÿåˆå¹¶æˆä¸€ä¸ªç³»ç»Ÿï¼Ÿ</p></li><li><p>ç³»ç»Ÿåˆ†å±‚ï¼šç³»ç»Ÿæ˜¯å‡ å±‚æ¶æ„ï¼ŒåŸºäºä»€ä¹ˆåŸåˆ™å°†ä¸€ä¸ªç³»ç»Ÿè¿›è¡Œåˆ†å±‚ï¼Œåˆ†æˆå¤šå°‘å±‚ï¼Ÿ</p></li><li><p>æ¨¡å—åŒ–ï¼šç³»ç»Ÿé‡Œæœ‰å¤šå°‘ä¸ªæ¨¡å—ï¼Œå“ªäº›éœ€è¦æ¨¡å—åŒ–ï¼ŸåŸºäºä»€ä¹ˆåŸåˆ™å°†ä¸€ç±»ä»£ç å˜æˆä¸€ä¸ªæ¨¡å—ã€‚<br><a name="-5"></a></p><h4 id="å¦‚ä½•æ¨¡å—åŒ–"><a href="#å¦‚ä½•æ¨¡å—åŒ–" class="headerlink" title="å¦‚ä½•æ¨¡å—åŒ–"></a>å¦‚ä½•æ¨¡å—åŒ–</h4></li><li><p>åŸºäºæ°´å¹³åˆ‡åˆ†ã€‚æŠŠä¸€ä¸ªç³»ç»ŸæŒ‰ç…§ä¸šåŠ¡ç±»å‹è¿›è¡Œæ°´å¹³åˆ‡åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œæ¯”å¦‚æƒé™ç®¡ç†æ¨¡å—ï¼Œç”¨æˆ·ç®¡ç†æ¨¡å—ï¼Œå„ç§ä¸šåŠ¡æ¨¡å—ç­‰ã€‚</p></li><li><p>åŸºäºå‚ç›´åˆ‡åˆ†ã€‚æŠŠä¸€ä¸ªç³»ç»ŸæŒ‰ç…§ç³»ç»Ÿå±‚æ¬¡è¿›è¡Œå‚ç›´åˆ‡åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œå¦‚DAOå±‚ï¼ŒSERVICEå±‚ï¼Œä¸šåŠ¡é€»è¾‘å±‚ã€‚</p></li><li><p>åŸºäºå•ä¸€èŒè´£ã€‚å°†ä»£ç æŒ‰ç…§èŒè´£æŠ½è±¡å‡ºæ¥å½¢æˆä¸€ä¸ªä¸€ä¸ªçš„æ¨¡å—ã€‚å°†ç³»ç»Ÿä¸­åŒä¸€èŒè´£çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ¨¡å—é‡Œã€‚æ¯”å¦‚æˆ‘ä»¬å¼€å‘çš„ç³»ç»Ÿè¦å¯¹æ¥å¤šä¸ªæ¸ é“çš„æ•°æ®ï¼Œæ¯ä¸ªæ¸ é“çš„å¯¹æ¥æ–¹å¼å’Œæ•°æ®è§£ææ–¹å¼ä¸ä¸€æ ·ï¼Œä¸ºé¿å…ä¸åŒæ¸ é“ä»£ç çš„ç›¸äº’å½±å“ï¼Œæˆ‘ä»¬æŠŠå„ä¸ªæ¸ é“çš„ä»£ç æ”¾åœ¨å„è‡ªçš„æ¨¡å—é‡Œã€‚</p></li><li><p>åŸºäºæ˜“å˜å’Œä¸æ˜“å˜ã€‚å°†ä¸æ˜“å˜çš„ä»£ç æŠ½è±¡åˆ°ä¸€ä¸ªæ¨¡å—é‡Œï¼Œæ¯”å¦‚ç³»ç»Ÿçš„æ¯”è¾ƒé€šç”¨çš„åŠŸèƒ½ã€‚å°†æ˜“å˜çš„ä»£ç æ”¾åœ¨å¦å¤–ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—é‡Œï¼Œæ¯”å¦‚ä¸šåŠ¡é€»è¾‘ã€‚å› ä¸ºæ˜“å˜çš„ä»£ç ç»å¸¸ä¿®æ”¹ï¼Œä¼šå¾ˆä¸ç¨³å®šï¼Œåˆ†å¼€ä¹‹åæ˜“å˜ä»£ç åœ¨ä¿®æ”¹æ—¶å€™ï¼Œä¸ä¼šå°†BUGä¼ æŸ“ç»™ä¸å˜çš„ä»£ç ã€‚<br><a name="-6"></a></p><h4 id="æå‡ç³»ç»Ÿçš„ç¨³å®šæ€§"><a href="#æå‡ç³»ç»Ÿçš„ç¨³å®šæ€§" class="headerlink" title="æå‡ç³»ç»Ÿçš„ç¨³å®šæ€§"></a>æå‡ç³»ç»Ÿçš„ç¨³å®šæ€§</h4></li><li><p>æµæ§</p></li></ul><p>åŒ11æœŸé—´ï¼Œå¯¹äºä¸€äº›é‡è¦çš„æ¥å£ï¼ˆæ¯”å¦‚å¸å·çš„æŸ¥è¯¢æ¥å£ï¼Œåº—é“ºé¦–é¡µï¼‰åšæµé‡æ§åˆ¶ï¼Œè¶…è¿‡é˜ˆå€¼ç›´æ¥è¿”å›å¤±è´¥ã€‚<br>å¦å¤–å¯¹äºä¸€äº›ä¸é‡è¦çš„ä¸šåŠ¡ä¹Ÿå¯ä»¥è€ƒè™‘é‡‡ç”¨é™çº§æ–¹æ¡ˆï¼Œå¤§ä¿ƒâ€”&gt;é‚®ä»¶ç³»ç»Ÿã€‚æ ¹æ®28åŸåˆ™ï¼Œæå‰å°†å¤§å–å®¶çº¦1Wå·¦å³åœ¨ç¼“å­˜ä¸­é¢„çƒ­ï¼Œå¹¶è®¾ç½®èµ·æ­¢æ—¶é—´ï¼Œæ´»åŠ¨æœŸé—´å†…è¿™éƒ¨åˆ†å¤§å–å®¶ä¸å‘äº¤æ˜“é‚®ä»¶æé†’ï¼Œä»¥å‡è½»SAé‚®ä»¶æœåŠ¡å™¨çš„å‹åŠ›ã€‚</p><ul><li>å®¹ç¾</li></ul><p>æœ€å¤§ç¨‹åº¦ä¿è¯ä¸»é“¾è·¯çš„å¯ç”¨æ€§ï¼Œæ¯”å¦‚æˆ‘è´Ÿè´£äº¤æ˜“çš„ä¸‹å•ï¼Œè€Œä¸‹å•è¿‡ç¨‹ä¸­æœ‰ä¼˜æƒ çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ­¤æ—¶éœ€è¦è€ƒè™‘UMPç³»ç»ŸæŒ‚æ‰ï¼Œä¸ä¼šå½±å“ç”¨æˆ·ä¸‹å•ï¼ˆåé¢å¯ä»¥é€šè¿‡ä¿®æ”¹ä»·æ ¼å¼¥è¡¥ï¼‰ï¼Œé‡‡ç”¨çš„æ–¹å¼æ˜¯ï¼Œå¦‚æœä¼˜æƒ æŒ‚æ‰ï¼Œé‡æ–°æ¸²æŸ“é¡µé¢ï¼Œå¹¶å¢åŠ umpå±è”½æ ‡è®°ï¼Œä¸‹å•æ—¶ä¼šè‡ªåŠ¨å±è”½umpçš„ä»£ç é€»è¾‘ã€‚<br>å¦å¤–è¿˜ä¼šè®°å½•umpç³»ç»Ÿä¸å¯ç”¨æ¬¡æ•°ï¼Œä¸€å®šæ—¶é—´å†…è¶…è¿‡é˜ˆå€¼ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦ã€‚</p><ul><li>ç¨³å®šæ€§</li></ul><p>ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¯èƒ½ä¼šä¸ç¨³å®šï¼Œå­˜åœ¨æ¥å£è¶…æ—¶æˆ–å®•æœºï¼Œä¸ºäº†å¢åŠ ç³»ç»Ÿçš„å¥å£®æ€§ï¼Œè°ƒç”¨æ¥å£æ—¶è®¾ç½®è¶…æ—¶æ—¶é—´ä»¥åŠå¼‚å¸¸æ•è·å¤„ç†ã€‚</p><ul><li>å®¹é‡è§„åˆ’</li></ul><p>åšå¥½å®¹é‡è§„åˆ’ã€ç³»ç»Ÿé—´å¼ºå¼±ä¾èµ–å…³ç³»æ¢³ç†ã€‚<br>å¦‚ï¼šå†·çƒ­æ•°æ®ä¸åŒå¤„ç†ï¼Œæ—©æœŸçš„è®¢å•é‡‡ç”¨oracleå­˜å‚¨ï¼Œéšç€è®¢å•çš„æ•°é‡è¶Šæ¥è¶Šå¤šï¼ŒæŸ¥è¯¢ç¼“æ…¢ï¼Œè€ƒè™‘æ•°æ®è¿ç§»ï¼Œå¼•å…¥å†å²è¡¨ï¼Œå°†å·²å½’æ¡£çš„è®°å½•è¿ç§»åˆ°å†å²è¡¨ä¸­ã€‚å½“ç„¶æœ€å¥½çš„æ–¹æ³•æ˜¯åˆ†åº“åˆ†è¡¨ã€‚<br><a name="-7"></a></p><h4 id="åˆ†å¸ƒå¼æ¶æ„"><a href="#åˆ†å¸ƒå¼æ¶æ„" class="headerlink" title="åˆ†å¸ƒå¼æ¶æ„"></a>åˆ†å¸ƒå¼æ¶æ„</h4><ul><li><p>åˆ†å¸ƒå¼ç³»ç»Ÿ</p></li><li><p>åˆ†å¸ƒå¼ç¼“å­˜</p></li><li><p>åˆ†å¸ƒå¼æ•°æ®<br><a name="api"></a></p><h4 id="API-å’Œä¹é«˜ç§¯æœ¨æœ‰ä»€ä¹ˆç›¸ä¼¼ä¹‹å¤„ï¼Ÿ"><a href="#API-å’Œä¹é«˜ç§¯æœ¨æœ‰ä»€ä¹ˆç›¸ä¼¼ä¹‹å¤„ï¼Ÿ" class="headerlink" title="API å’Œä¹é«˜ç§¯æœ¨æœ‰ä»€ä¹ˆç›¸ä¼¼ä¹‹å¤„ï¼Ÿ"></a>API å’Œä¹é«˜ç§¯æœ¨æœ‰ä»€ä¹ˆç›¸ä¼¼ä¹‹å¤„ï¼Ÿ</h4><p>ç›¸ä¿¡æˆ‘ä»¬å¤§å¤šæ•°äººåœ¨å„¿ç«¥æ—¶æœŸéƒ½å–œæ¬¢ç©ä¹é«˜ç§¯æœ¨ã€‚ä¹é«˜ç§¯æœ¨çš„çœŸæ­£ä¹è¶£å’Œå¸å¼•åŠ›åœ¨äºï¼Œå°½ç®¡åŒ…è£…ç›’å¤–é¢éƒ½å¸¦æœ‰ç¤ºæ„å›¾ç‰‡ï¼Œä½†ä½ æœ€ç»ˆéƒ½å¯ä»¥éšå¿ƒæ‰€æ¬²å¾—æ­å‡ºå„ç§æ ·å­æˆ–é€ å‹ã€‚<br>å¯¹ API çš„æœ€ä½³è§£é‡Šå°±æ˜¯å®ƒä»¬åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ã€‚æˆ‘ä»¬å¯ä»¥ç”¨åˆ›é€ æ€§çš„æ–¹å¼æ¥ç»„åˆå®ƒä»¬ï¼Œè€Œä¸ç”¨åœ¨æ„å®ƒä»¬åŸæœ¬çš„è®¾è®¡å’Œå®ç°æ„å›¾ã€‚<br>ä½ å¯ä»¥å‘ç°å¾ˆå¤š API å’Œä¹é«˜ç§¯æœ¨çš„ç›¸ä¼¼ä¹‹å¤„ï¼š</p></li><li><p>æ ‡å‡†åŒ–ï¼šé€šç”¨ã€æ ‡å‡†åŒ–çš„ç»„ä»¶ï¼Œä½œä¸ºåŸºæœ¬çš„æ„å»ºå—ï¼ˆbuilding blocksï¼‰ï¼›<br></p></li><li><p>å¯ç”¨æ€§ï¼šå¼ºè°ƒå¯ç”¨æ€§ï¼Œé™„æœ‰æ–‡æ¡£æˆ–ä½¿ç”¨è¯´æ˜ï¼›<br></p></li><li><p>å¯å®šåˆ¶ï¼šä¸ºä¸åŒåŠŸèƒ½ä½¿ç”¨ä¸åŒçš„APIï¼›<br></p></li><li><p>åˆ›é€ æ€§ï¼šèƒ½å¤Ÿç»„åˆä¸åŒçš„ API æ¥åˆ›é€ æ··æ­çš„ç»“æœï¼›</p></li></ul><p><br>ä¹é«˜å’Œ API éƒ½æœ‰è¶…ç®€å•çš„ç•Œé¢/æ¥å£ï¼Œå¹¶ä¸”å€ŸåŠ©è¿™æ ·ç®€å•çš„ç•Œé¢/æ¥å£ï¼Œå®ƒå¯ä»¥éå¸¸ç›´è§‚ã€å®¹æ˜“ã€å¿«é€Ÿå¾—æ„å»ºã€‚<br>è™½ç„¶ä¹é«˜å’Œ API ä¸€æ ·å¯èƒ½é™„å¸¦ç¤ºæ„å›¾ç‰‡æˆ–ä½¿ç”¨æ–‡æ¡£ï¼Œå¤§æ¦‚æè¿°äº†æ¨èç©æ³•æˆ–ç”¨é€”ï¼Œä½†çœŸæ­£ä»¤äººå…´å¥‹çš„ç»“æœæˆ–æ”¶è·æ°æ°æ˜¯é€šè¿‡åˆ›é€ åŠ›äº§ç”Ÿçš„ã€‚<br><br><br>è®©æˆ‘ä»¬ä»”ç»†åœ°æ€è€ƒä¸‹ä¸Šè¿°çš„ææ³•ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒAPI çš„ä½¿ç”¨è€…æ„å»ºå‡ºäº† API çš„æ„å»ºè€…è¶…å‡ºé¢„æœŸçš„æœåŠ¡æˆ–äº§å“ï¼ŒAPI ä½¿ç”¨è€…æƒ³è¦çš„ï¼Œå’Œ API æ„å»ºè€…è®¤ä¸ºä½¿ç”¨è€…æƒ³è¦çš„ï¼Œè¿™äºŒè€…ä¹‹é—´é€šå¸¸æœ‰ä¸ªæ–­å±‚ã€‚äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œåœ¨ IoT é¢†åŸŸï¼Œæˆ‘ä»¬ä½¿ç”¨ API åˆ›é€ å‡ºäº†ä¸€äº›éå¸¸æœ‰åˆ›é€ æ€§çš„ä½¿ç”¨åœºæ™¯ã€‚</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;-2&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;å…³äºä»€ä¹ˆ
      
    
    </summary>
    
    
      <category term="æ¶æ„" scheme="cpeixin.cn/categories/%E6%9E%B6%E6%9E%84/"/>
    
    
  </entry>
  
  <entry>
    <title>kaliä¸­æ–‡è®¾ç½®</title>
    <link href="cpeixin.cn/2019/12/01/kali%E4%B8%AD%E6%96%87%E8%AE%BE%E7%BD%AE/"/>
    <id>cpeixin.cn/2019/12/01/kali%E4%B8%AD%E6%96%87%E8%AE%BE%E7%BD%AE/</id>
    <published>2019-12-01T02:26:15.000Z</published>
    <updated>2020-04-04T11:06:21.313Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>æ›´æ–°æº</p><p><a href="https://blog.csdn.net/qq_38333291/article/details/89764967" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_38333291/article/details/89764967</a></p><p>è®¾ç½®ç¼–ç å’Œä¸­æ–‡å­—ä½“å®‰è£…</p><p><a href="http://www.linuxdiyf.com/linux/20701.html" target="_blank" rel="external nofollow noopener noreferrer">http://www.linuxdiyf.com/linux/20701.html</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;æ›´æ–°æº&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq_38333291/article/details/897
      
    
    </summary>
    
    
      <category term="Linux" scheme="cpeixin.cn/categories/Linux/"/>
    
    
      <category term="kali" scheme="cpeixin.cn/tags/kali/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼ä¸‹çš„æ•°æ®hashåˆ†å¸ƒ</title>
    <link href="cpeixin.cn/2019/11/19/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AEhash%E5%88%86%E5%B8%83/"/>
    <id>cpeixin.cn/2019/11/19/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%95%B0%E6%8D%AEhash%E5%88%86%E5%B8%83/</id>
    <published>2019-11-19T15:05:08.000Z</published>
    <updated>2020-04-04T11:24:04.737Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;!-- rebuild by neat --&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ã€è½¬è½½ã€‘å­—èŠ‚è·³åŠ¨åœ¨Spark SQLä¸Šçš„æ ¸å¿ƒä¼˜åŒ–å®è·µ</title>
    <link href="cpeixin.cn/2019/11/12/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%E5%9C%A8Spark-SQL%E4%B8%8A%E7%9A%84%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/"/>
    <id>cpeixin.cn/2019/11/12/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%E5%9C%A8Spark-SQL%E4%B8%8A%E7%9A%84%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/</id>
    <published>2019-11-12T10:57:27.000Z</published>
    <updated>2020-05-16T10:59:03.835Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:02 GMT+0800 (GMT+08:00) --><p><br>æœ¬æ–‡è½¬è½½è‡ªå­—èŠ‚è·³åŠ¨æŠ€æœ¯å›¢é˜Ÿåœ¨æ˜é‡‘ç½‘ä¸Šå‘è¡¨çš„æ–‡ç« ï¼Œä¸»è¦æ˜¯Spark SQLåœ¨å­—èŠ‚æ•°æ®ä»“åº“åº”ç”¨æ–¹é¢çš„ä¼˜åŒ–å®è·µ<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://juejin.im/post/5dc3ed336fb9a04a7847f25c" target="_blank" rel="external nofollow noopener noreferrer">https://juejin.im/post/5dc3ed336fb9a04a7847f25c</a><br><a name="KLy4v"></a></p><h2 id="Spark-SQL-æ¶æ„ç®€ä»‹"><a href="#Spark-SQL-æ¶æ„ç®€ä»‹" class="headerlink" title="Spark SQL æ¶æ„ç®€ä»‹"></a>Spark SQL æ¶æ„ç®€ä»‹</h2><p>æˆ‘ä»¬å…ˆç®€å•èŠä¸€ä¸‹Spark SQL çš„æ¶æ„ã€‚ä¸‹é¢è¿™å¼ å›¾æè¿°äº†ä¸€æ¡ SQL æäº¤ä¹‹åéœ€è¦ç»å†çš„å‡ ä¸ªé˜¶æ®µï¼Œç»“åˆè¿™äº›é˜¶æ®µå°±å¯ä»¥çœ‹åˆ°åœ¨å“ªäº›ç¯èŠ‚å¯ä»¥åšä¼˜åŒ–ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589617132571-55a23e83-cc96-437b-93a9-871d41c6724e.webp#align=left&display=inline&height=448&margin=%5Bobject%20Object%5D&originHeight=448&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>å¾ˆå¤šæ—¶å€™ï¼Œåšæ•°æ®ä»“åº“å»ºæ¨¡çš„åŒå­¦æ›´å€¾å‘äºç›´æ¥å†™ SQL è€Œéä½¿ç”¨ Spark çš„ DSLã€‚ä¸€æ¡ SQL æäº¤ä¹‹åä¼šè¢« Parser è§£æå¹¶è½¬åŒ–ä¸º Unresolved Logical Planã€‚å®ƒçš„é‡ç‚¹æ˜¯ Logical Plan ä¹Ÿå³é€»è¾‘è®¡åˆ’ï¼Œå®ƒæè¿°äº†å¸Œæœ›åšä»€ä¹ˆæ ·çš„æŸ¥è¯¢ã€‚Unresolved æ˜¯æŒ‡è¯¥æŸ¥è¯¢ç›¸å…³çš„ä¸€äº›ä¿¡æ¯æœªçŸ¥ï¼Œæ¯”å¦‚ä¸çŸ¥é“æŸ¥è¯¢çš„ç›®æ ‡è¡¨çš„ Schema ä»¥åŠæ•°æ®ä½ç½®ã€‚<br>ä¸Šè¿°ä¿¡æ¯å­˜äº Catalog å†…ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ç”± Hive Metastore æä¾› Catalog æœåŠ¡ã€‚Analyzer ä¼šç»“åˆ Catalog å°† Unresolved Logical Plan è½¬æ¢ä¸º Resolved Logical Planã€‚</p><p>åˆ°è¿™é‡Œè¿˜ä¸å¤Ÿã€‚ä¸åŒçš„äººå†™å‡ºæ¥çš„ SQL ä¸ä¸€æ ·ï¼Œç”Ÿæˆçš„ Resolved Logical Plan ä¹Ÿå°±ä¸ä¸€æ ·ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿä¸ä¸€æ ·ã€‚ä¸ºäº†ä¿è¯æ— è®ºç”¨æˆ·å¦‚ä½•å†™ SQL éƒ½å¯ä»¥é«˜æ•ˆçš„æ‰§è¡Œï¼ŒSpark SQL éœ€è¦å¯¹ Resolved Logical Plan è¿›è¡Œä¼˜åŒ–ï¼Œè¿™ä¸ªä¼˜åŒ–ç”± Optimizer å®Œæˆã€‚Optimizer åŒ…å«äº†ä¸€ç³»åˆ—è§„åˆ™ï¼Œå¯¹ Resolved Logical Plan è¿›è¡Œç­‰ä»·è½¬æ¢ï¼Œæœ€ç»ˆç”Ÿæˆ Optimized Logical Planã€‚<strong>è¯¥ Optimized Logical Plan ä¸èƒ½ä¿è¯æ˜¯å…¨å±€æœ€ä¼˜çš„ï¼Œä½†è‡³å°‘æ˜¯æ¥è¿‘æœ€ä¼˜çš„ã€‚</strong><br>ä¸Šè¿°è¿‡ç¨‹åªä¸ SQL æœ‰å…³ï¼Œä¸æŸ¥è¯¢æœ‰å…³ï¼Œä½†æ˜¯ä¸ Spark æ— å…³ï¼Œå› æ­¤æ— æ³•ç›´æ¥æäº¤ç»™ Spark æ‰§è¡Œã€‚Query Planner è´Ÿè´£å°† Optimized Logical Plan è½¬æ¢ä¸º Physical Planï¼Œè¿›è€Œå¯ä»¥ç›´æ¥ç”± Spark æ‰§è¡Œã€‚<br><br><br>ç”±äºåŒä¸€ç§é€»è¾‘ç®—å­å¯ä»¥æœ‰å¤šç§ç‰©ç†å®ç°ã€‚å¦‚ Join æœ‰å¤šç§å®ç°ï¼ŒShuffledHashJoinã€BroadcastHashJoinã€BroadcastNestedLoopJoinã€SortMergeJoin ç­‰ã€‚å› æ­¤ Optimized Logical Plan å¯è¢« Query Planner è½¬æ¢ä¸ºå¤šä¸ª Physical Planã€‚å¦‚ä½•é€‰æ‹©æœ€ä¼˜çš„ Physical Plan æˆä¸ºä¸€ä»¶éå¸¸å½±å“æœ€ç»ˆæ‰§è¡Œæ€§èƒ½çš„äº‹æƒ…ã€‚ä¸€ç§æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯ï¼Œ<strong>æ„å»ºä¸€ä¸ª Cost Modelï¼Œå¹¶å¯¹æ‰€æœ‰å€™é€‰çš„ Physical Plan åº”ç”¨è¯¥ Model å¹¶æŒ‘é€‰ Cost æœ€å°çš„ Physical Plan ä½œä¸ºæœ€ç»ˆçš„ Selected Physical Planã€‚</strong></p><p>Physical Plan å¯ç›´æ¥è½¬æ¢æˆ RDD ç”± Spark æ‰§è¡Œã€‚æˆ‘ä»¬ç»å¸¸è¯´â€œè®¡åˆ’èµ¶ä¸ä¸Šå˜åŒ–â€ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å‘ç°åŸè®¡åˆ’ä¸æ˜¯æœ€ä¼˜çš„ï¼Œåç»­æ‰§è¡Œè®¡åˆ’å¦‚æœèƒ½æ ¹æ®è¿è¡Œæ—¶çš„ç»Ÿè®¡ä¿¡æ¯è¿›è¡Œè°ƒæ•´å¯èƒ½æå‡æ•´ä½“æ‰§è¡Œæ•ˆç‡ã€‚è¿™éƒ¨åˆ†<strong>åŠ¨æ€è°ƒæ•´ç”± Adaptive Execution</strong> å®Œæˆã€‚<br><br><br>åé¢ä»‹ç»å­—èŠ‚è·³åŠ¨åœ¨ Spark SQL ä¸Šåšçš„ä¸€äº›ä¼˜åŒ–ï¼Œä¸»è¦å›´ç»•è¿™ä¸€èŠ‚ä»‹ç»çš„é€»è¾‘è®¡åˆ’ä¼˜åŒ–ä¸ç‰©ç†è®¡åˆ’ä¼˜åŒ–å±•å¼€ã€‚<br><a name="Z68Tc"></a></p><h2 id="Spark-SQLå¼•æ“ä¼˜åŒ–"><a href="#Spark-SQLå¼•æ“ä¼˜åŒ–" class="headerlink" title="Spark SQLå¼•æ“ä¼˜åŒ–"></a>Spark SQLå¼•æ“ä¼˜åŒ–</h2><p><a name="L4CUN"></a></p><h3 id="Bucket-Joinæ”¹è¿›"><a href="#Bucket-Joinæ”¹è¿›" class="headerlink" title="Bucket Joinæ”¹è¿›"></a>Bucket Joinæ”¹è¿›</h3><p>åœ¨ Spark é‡Œï¼Œå®é™…å¹¶æ²¡æœ‰ Bucket Join ç®—å­ã€‚è¿™é‡Œè¯´çš„ Bucket Join æ³›æŒ‡ä¸éœ€è¦ Shuffle çš„ Sort Merge Joinã€‚<br>ä¸‹å›¾å±•ç¤ºäº† Sort Merge Join çš„åŸºæœ¬åŸç†ã€‚ç”¨è™šçº¿æ¡†ä»£è¡¨çš„ Table 1 å’Œ Table 2 æ˜¯ä¸¤å¼ éœ€è¦æŒ‰æŸå­—æ®µè¿›è¡Œ Join çš„è¡¨ã€‚è™šçº¿æ¡†å†…çš„ partition 0 åˆ° partition m æ˜¯è¯¥è¡¨è½¬æ¢æˆ RDD åçš„ Partitionï¼Œè€Œéè¡¨çš„åˆ†åŒºã€‚</p><p>å‡è®¾ Table 1 ä¸ Table 2 è½¬æ¢ä¸º RDD ååˆ†åˆ«åŒ…å« m å’Œ k ä¸ª Partitionã€‚ä¸ºäº†è¿›è¡Œ Joinï¼Œéœ€è¦é€šè¿‡ Shuffle ä¿è¯ç›¸åŒ Join Key çš„æ•°æ®åœ¨åŒä¸€ä¸ª Partition å†…ä¸” Partition å†…æŒ‰ Key æ’åºï¼ŒåŒæ—¶ä¿è¯ Table 1 ä¸ Table 2 ç»è¿‡ Shuffle åçš„ RDD çš„ Partition æ•°ç›¸åŒã€‚<br><br><br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»è¿‡ Shuffle ååªéœ€è¦å¯åŠ¨ n ä¸ª Taskï¼Œæ¯ä¸ª Task å¤„ç† Table 1 ä¸ Table 2 ä¸­å¯¹åº” Partition çš„æ•°æ®è¿›è¡Œ Join å³å¯ã€‚å¦‚ Task 0 åªéœ€è¦é¡ºåºæ‰«æ Shuffle åçš„å·¦å³ä¸¤è¾¹çš„ partition 0 å³å¯å®Œæˆ Joinã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443202-f22b73ca-17f1-450c-86ca-e47c9b934bca.webp#align=left&display=inline&height=629&margin=%5Bobject%20Object%5D&originHeight=629&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>è¯¥æ–¹æ³•çš„ä¼˜åŠ¿æ˜¯é€‚ç”¨åœºæ™¯å¹¿ï¼Œå‡ ä¹å¯ç”¨äºä»»æ„å¤§å°çš„æ•°æ®é›†ã€‚åŠ£åŠ¿æ˜¯æ¯æ¬¡ Join éƒ½éœ€è¦å¯¹å…¨é‡æ•°æ®è¿›è¡Œ Shuffleï¼Œè€Œ Shuffle æ˜¯æœ€å½±å“ Spark SQL æ€§èƒ½çš„ç¯èŠ‚ã€‚å¦‚æœèƒ½é¿å… Shuffle å¾€å¾€èƒ½å¤§å¹…æå‡ Spark SQL æ€§èƒ½ã€‚</p><p>å¯¹äºå¤§æ•°æ®çš„åœºæ™¯æ¥è®²ï¼Œæ•°æ®ä¸€èˆ¬æ˜¯ä¸€æ¬¡å†™å…¥å¤šæ¬¡æŸ¥è¯¢ã€‚å¦‚æœç»å¸¸å¯¹ä¸¤å¼ è¡¨æŒ‰ç›¸åŒæˆ–ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œ Joinï¼Œæ¯æ¬¡éƒ½éœ€è¦ä»˜å‡º Shuffle çš„ä»£ä»·ã€‚ä¸å…¶è¿™æ ·ï¼Œ<strong>ä¸å¦‚è®©æ•°æ®åœ¨å†™çš„æ—¶å€™ï¼Œå°±è®©æ•°æ®æŒ‰ç…§åˆ©äº Join çš„æ–¹å¼åˆ†å¸ƒï¼Œä»è€Œä½¿å¾— Join æ—¶æ— éœ€è¿›è¡Œ Shuffleã€‚</strong>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTable 1 ä¸ Table 2 å†…çš„æ•°æ®æŒ‰ç…§ç›¸åŒçš„ Key è¿›è¡Œåˆ†æ¡¶ä¸”æ¡¶æ•°éƒ½ä¸º nï¼ŒåŒæ—¶æ¡¶å†…æŒ‰è¯¥ Key æ’åºã€‚å¯¹è¿™ä¸¤å¼ è¡¨è¿›è¡Œ Join æ—¶ï¼Œå¯ä»¥é¿å… Shuffleï¼Œç›´æ¥å¯åŠ¨ n ä¸ª Task è¿›è¡Œ Joinã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443345-00aac217-cf9d-4ca2-beea-3a27868e9709.webp#align=left&display=inline&height=697&margin=%5Bobject%20Object%5D&originHeight=697&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>å­—èŠ‚è·³åŠ¨å¯¹ Spark SQL çš„ BucketJoin åšäº†å››é¡¹æ¯”è¾ƒå¤§çš„æ”¹è¿›ã€‚<br><strong><br></strong>æ”¹è¿›ä¸€ï¼šæ”¯æŒä¸ Hive å…¼å®¹**<br>åœ¨è¿‡å»ä¸€æ®µæ—¶é—´ï¼Œå­—èŠ‚è·³åŠ¨æŠŠå¤§é‡çš„ Hive ä½œä¸šè¿ç§»åˆ°äº† SparkSQLã€‚è€Œ Hive ä¸ Spark SQL çš„ Bucket è¡¨ä¸å…¼å®¹ã€‚å¯¹äºä½¿ç”¨ Bucket è¡¨çš„åœºæ™¯ï¼Œå¦‚æœç›´æ¥æ›´æ–°è®¡ç®—å¼•æ“ï¼Œä¼šé€ æˆ Spark SQL å†™å…¥ Hive Bucket è¡¨çš„æ•°æ®æ— æ³•è¢«ä¸‹æ¸¸çš„ Hive ä½œä¸šå½“æˆ Bucket è¡¨è¿›è¡Œ Bucket Joinï¼Œä»è€Œé€ æˆä½œä¸šæ‰§è¡Œæ—¶é—´å˜é•¿ï¼Œå¯èƒ½å½±å“ SLAã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®© Spark SQL æ”¯æŒ Hive å…¼å®¹æ¨¡å¼ï¼Œä»è€Œä¿è¯ Spark SQL å†™å…¥çš„ Bucket è¡¨ä¸ Hive å†™å…¥çš„ Bucket è¡¨æ•ˆæœä¸€è‡´ï¼Œå¹¶ä¸”è¿™ç§è¡¨å¯ä»¥è¢« Hive å’Œ Spark SQL å½“æˆ Bucket è¡¨è¿›è¡Œ Bucket Join è€Œä¸éœ€è¦ Shuffleã€‚é€šè¿‡è¿™ç§æ–¹å¼ä¿è¯ Hive å‘ Spark SQL çš„é€æ˜è¿ç§»ã€‚</p><p>ç¬¬ä¸€ä¸ªéœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼ŒHive çš„ä¸€ä¸ª Bucket ä¸€èˆ¬åªåŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œ Spark SQL çš„ä¸€ä¸ª Bucket å¯èƒ½åŒ…å«å¤šä¸ªæ–‡ä»¶ã€‚<strong>è§£å†³åŠæ³•æ˜¯åŠ¨æ€å¢åŠ ä¸€æ¬¡ä»¥ Bucket Key ä¸º Key å¹¶ä¸”å¹¶è¡Œåº¦ä¸ Bucket ä¸ªæ•°ç›¸åŒçš„ Shuffleã€‚</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443237-9db92d7d-db57-44a7-8c38-d02bece98cc8.webp#align=left&display=inline&height=609&margin=%5Bobject%20Object%5D&originHeight=609&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br><br><br>ç¬¬äºŒä¸ªéœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼ŒHive 1.x çš„å“ˆå¸Œæ–¹å¼ä¸ Spark SQL 2.x çš„å“ˆå¸Œæ–¹å¼ï¼ˆMurmur3Hashï¼‰ä¸åŒï¼Œä½¿å¾—ç›¸åŒçš„æ•°æ®åœ¨ Hive ä¸­çš„ Bucket ID ä¸ Spark SQL ä¸­çš„ Bucket ID ä¸åŒè€Œæ— æ³•ç›´æ¥ Joinã€‚åœ¨ Hive å…¼å®¹æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬è®©ä¸Šè¿°åŠ¨æ€å¢åŠ çš„ Shuffle ä½¿ç”¨ Hive ç›¸åŒçš„å“ˆå¸Œæ–¹å¼ï¼Œä»è€Œè§£å†³è¯¥é—®é¢˜ã€‚<br><strong><br></strong>æ”¹è¿›äºŒï¼šæ”¯æŒå€æ•°å…³ç³»Bucket Join**<br>Spark SQL è¦æ±‚åªæœ‰ Bucket ç›¸åŒçš„è¡¨æ‰èƒ½ï¼ˆå¿…è¦éå……åˆ†æ¡ä»¶ï¼‰è¿›è¡Œ Bucket Joinã€‚å¯¹äºä¸¤å¼ å¤§å°ç›¸å·®å¾ˆå¤§çš„è¡¨ï¼Œæ¯”å¦‚å‡ ç™¾ GB çš„ç»´åº¦è¡¨ä¸å‡ å TB ï¼ˆå•åˆ†åŒºï¼‰çš„äº‹å®è¡¨ï¼Œå®ƒä»¬çš„ Bucket ä¸ªæ•°å¾€å¾€ä¸åŒï¼Œå¹¶ä¸”ä¸ªæ•°ç›¸å·®å¾ˆå¤šï¼Œé»˜è®¤æ— æ³•è¿›è¡Œ Bucket Joinã€‚å› æ­¤æˆ‘ä»¬é€šè¿‡ä¸¤ç§æ–¹å¼æ”¯æŒäº†å€æ•°å…³ç³»çš„ Bucket Joinï¼Œå³å½“ä¸¤å¼  Bucket è¡¨çš„ Bucket æ•°æ˜¯å€æ•°å…³ç³»æ—¶æ”¯æŒ Bucket Joinã€‚</p><p>ç¬¬ä¸€ç§æ–¹å¼ï¼ŒTask ä¸ªæ•°ä¸å°è¡¨ Bucket ä¸ªæ•°ç›¸åŒã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTable A åŒ…å« 3 ä¸ª Bucketï¼ŒTable B åŒ…å« 6 ä¸ª Bucketã€‚æ­¤æ—¶ Table B çš„ bucket 0 ä¸ bucket 3 çš„æ•°æ®åˆé›†åº”è¯¥ä¸ Table A çš„ bucket 0 è¿›è¡Œ Joinã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯åŠ¨ 3 ä¸ª Taskã€‚å…¶ä¸­ Task 0 å¯¹ Table A çš„ bucket 0 ä¸ Table B çš„ bucket 0 + bucket 3 è¿›è¡Œ Joinã€‚åœ¨è¿™é‡Œï¼Œéœ€è¦å¯¹ Table B çš„ bucket 0 ä¸ bucket 3 çš„æ•°æ®å†åšä¸€æ¬¡ merge sort ä»è€Œä¿è¯åˆé›†æœ‰åºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443244-bfe94284-63b6-4abe-8e6f-1df98c09fd08.webp#align=left&display=inline&height=616&margin=%5Bobject%20Object%5D&originHeight=616&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444353-c4e9ece6-e014-4583-ba9d-28bda6a5fe62.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"></p><p>å¦‚æœ Table A ä¸ Table B çš„ Bucket ä¸ªæ•°ç›¸å·®ä¸å¤§ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šè¿°æ–¹å¼ã€‚å¦‚æœ Table B çš„ Bucket ä¸ªæ•°æ˜¯ Bucket A Bucket ä¸ªæ•°çš„ 10 å€ï¼Œé‚£ä¸Šè¿°æ–¹å¼è™½ç„¶é¿å…äº† Shuffleï¼Œä½†å¯èƒ½å› ä¸ºå¹¶è¡Œåº¦ä¸å¤Ÿåè€Œæ¯”åŒ…å« Shuffle çš„ SortMergeJoin é€Ÿåº¦æ…¢ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå³ Task ä¸ªæ•°ä¸å¤§è¡¨ Bucket ä¸ªæ•°ç›¸ç­‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443251-d514de79-4fd1-4960-9e27-2a4e408c88ba.webp#align=left&display=inline&height=555&margin=%5Bobject%20Object%5D&originHeight=555&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>åœ¨è¯¥æ–¹æ¡ˆä¸‹ï¼Œå¯å°† Table A çš„ 3 ä¸ª Bucket è¯»å¤šæ¬¡ã€‚åœ¨ä¸Šå›¾ä¸­ï¼Œç›´æ¥å°† Table A ä¸ Table A è¿›è¡Œ Bucket Union ï¼ˆæ–°çš„ç®—å­ï¼Œä¸ Union ç±»ä¼¼ï¼Œä½†ä¿ç•™äº† Bucket ç‰¹æ€§ï¼‰ï¼Œç»“æœç›¸å½“äº 6 ä¸ª Bucketï¼Œä¸ Table B çš„ Bucket ä¸ªæ•°ç›¸åŒï¼Œä»è€Œå¯ä»¥è¿›è¡Œ Bucket Joinã€‚<br><strong><br></strong>æ”¹è¿›ä¸‰ï¼šæ”¯æŒBucketJoin é™çº§**<br>å…¬å¸å†…éƒ¨è¿‡å»ä½¿ç”¨ Bucket çš„è¡¨è¾ƒå°‘ï¼Œåœ¨æˆ‘ä»¬å¯¹ Bucket åšäº†ä¸€ç³»åˆ—æ”¹è¿›åï¼Œå¤§é‡ç”¨æˆ·å¸Œæœ›å°†è¡¨è½¬æ¢ä¸º Bucket è¡¨ã€‚è½¬æ¢åï¼Œè¡¨çš„å…ƒä¿¡æ¯æ˜¾ç¤ºè¯¥è¡¨ä¸º Bucket è¡¨ï¼Œè€Œå†å²åˆ†åŒºå†…çš„æ•°æ®å¹¶æœªæŒ‰ Bucket è¡¨è¦æ±‚åˆ†å¸ƒï¼Œåœ¨æŸ¥è¯¢å†å²æ•°æ®æ—¶ä¼šå‡ºç°æ— æ³•è¯†åˆ« Bucket çš„é—®é¢˜ã€‚</p><p>åŒæ—¶ï¼Œç”±äºæ•°æ®é‡ä¸Šæ¶¨å¿«ï¼Œå¹³å‡ Bucket å¤§å°ä¹Ÿå¿«é€Ÿå¢é•¿ã€‚è¿™ä¼šé€ æˆå• Task éœ€è¦å¤„ç†çš„æ•°æ®é‡è¿‡å¤§è¿›è€Œå¼•èµ·ä½¿ç”¨ Bucket åçš„æ•ˆæœå¯èƒ½ä¸å¦‚ç›´æ¥ä½¿ç”¨åŸºäº Shuffle çš„ Joinã€‚<br><br><br>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å®ç°äº†æ”¯æŒé™çº§çš„ Bucket è¡¨ã€‚åŸºæœ¬åŸç†æ˜¯ï¼Œæ¯æ¬¡ä¿®æ”¹ Bucket ä¿¡æ¯ï¼ˆåŒ…å«ä¸Šè¿°ä¸¤ç§æƒ…å†µâ€”â€”å°†é Bucket è¡¨è½¬ä¸º Bucket è¡¨ï¼Œä»¥åŠä¿®æ”¹ Bucket ä¸ªæ•°ï¼‰æ—¶ï¼Œè®°å½•ä¿®æ”¹æ—¥æœŸã€‚å¹¶ä¸”åœ¨å†³å®šä½¿ç”¨å“ªç§ Join æ–¹å¼æ—¶ï¼Œå¯¹äº Bucket è¡¨å…ˆæ£€æŸ¥æ‰€æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦åªåŒ…å«è¯¥æ—¥æœŸä¹‹åçš„åˆ†åŒºã€‚å¦‚æœæ˜¯ï¼Œåˆ™å½“æˆ Bucket è¡¨å¤„ç†ï¼Œæ”¯æŒ Bucket Joinï¼›å¦åˆ™å½“æˆæ™®é€šæ—  Bucket çš„è¡¨ã€‚<br><strong><br></strong>æ”¹è¿›å››ï¼šæ”¯æŒè¶…é›†<strong><br>å¯¹äºä¸€å¼ å¸¸ç”¨è¡¨ï¼Œå¯èƒ½ä¼šä¸å¦å¤–ä¸€å¼ è¡¨æŒ‰ User å­—æ®µåš Joinï¼Œä¹Ÿå¯èƒ½ä¼šä¸å¦å¤–ä¸€å¼ è¡¨æŒ‰ User å’Œ App å­—æ®µåš Joinï¼Œä¸å…¶å®ƒè¡¨æŒ‰ User ä¸ Item å­—æ®µè¿›è¡Œ Joinã€‚è€Œ Spark SQL åŸç”Ÿçš„ Bucket Join è¦æ±‚ Join Key Set ä¸è¡¨çš„ Bucket Key Set å®Œå…¨ç›¸åŒæ‰èƒ½è¿›è¡Œ Bucket Joinã€‚åœ¨è¯¥åœºæ™¯ä¸­ï¼Œä¸åŒ Join çš„ Key Set ä¸åŒï¼Œå› æ­¤æ— æ³•åŒæ—¶ä½¿ç”¨ Bucket Joinã€‚è¿™æå¤§çš„é™åˆ¶äº† Bucket Join çš„é€‚ç”¨åœºæ™¯ã€‚<br><br><br>é’ˆå¯¹æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬æ”¯æŒäº†è¶…é›†åœºæ™¯ä¸‹çš„ Bucket Joinã€‚åªè¦ Join Key Set åŒ…å«äº† Bucket Key Setï¼Œå³å¯è¿›è¡Œ Bucket Joinã€‚<br><br><br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTable X ä¸ Table Yï¼Œéƒ½æŒ‰å­—æ®µ A åˆ† Bucketã€‚è€ŒæŸ¥è¯¢éœ€è¦å¯¹ Table X ä¸ Table Y è¿›è¡Œ Joinï¼Œä¸” Join Key Set ä¸º A ä¸ Bã€‚æ­¤æ—¶ï¼Œç”±äº A ç›¸ç­‰çš„æ•°æ®ï¼Œåœ¨ä¸¤è¡¨ä¸­çš„ Bucket ID ç›¸åŒï¼Œé‚£ A ä¸ B å„è‡ªç›¸ç­‰çš„æ•°æ®åœ¨ä¸¤è¡¨ä¸­çš„ Bucket ID è‚¯å®šä¹Ÿç›¸åŒï¼Œæ‰€ä»¥æ•°æ®åˆ†å¸ƒæ˜¯æ»¡è¶³ Join è¦æ±‚çš„ï¼Œä¸éœ€è¦ Shuffleã€‚åŒæ—¶ï¼ŒBucket Join è¿˜éœ€è¦ä¿è¯ä¸¤è¡¨æŒ‰ Join Key Set å³ A å’Œ B æ’åºï¼Œæ­¤æ—¶åªéœ€è¦å¯¹ Table X ä¸ Table Y è¿›è¡Œåˆ†åŒºå†…æ’åºå³å¯ã€‚ç”±äºä¸¤è¾¹å·²ç»æŒ‰å­—æ®µ A æ’åºäº†ï¼Œæ­¤æ—¶å†æŒ‰ A ä¸ B æ’åºï¼Œä»£ä»·ç›¸å¯¹è¾ƒä½ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443338-9f06a217-9078-4734-84ce-860707b4612e.webp#align=left&display=inline&height=661&margin=%5Bobject%20Object%5D&originHeight=661&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444719-a5289c2c-0dea-4316-8924-1e4377bce1ea.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br></strong>ç‰©åŒ–åˆ—**<br>Spark SQL å¤„ç†åµŒå¥—ç±»å‹æ•°æ®æ—¶ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><strong>è¯»å–å¤§é‡ä¸å¿…è¦çš„æ•°æ®</strong>ï¼šå¯¹äº Parquet / ORC ç­‰åˆ—å¼å­˜å‚¨æ ¼å¼ï¼Œå¯åªè¯»å–éœ€è¦çš„å­—æ®µï¼Œè€Œç›´æ¥è·³è¿‡å…¶å®ƒå­—æ®µï¼Œä»è€Œæå¤§èŠ‚çœ IOã€‚è€Œå¯¹äºåµŒå¥—æ•°æ®ç±»å‹çš„å­—æ®µï¼Œå¦‚ä¸‹å›¾ä¸­çš„ Map ç±»å‹çš„ people å­—æ®µï¼Œå¾€å¾€åªéœ€è¦è¯»å–å…¶ä¸­çš„å­å­—æ®µï¼Œå¦‚ people.ageã€‚å´éœ€è¦å°†æ•´ä¸ª Map ç±»å‹çš„ people å­—æ®µå…¨éƒ¨è¯»å–å‡ºæ¥ç„¶åæŠ½å–å‡º people.age å­—æ®µã€‚è¿™ä¼šå¼•å…¥å¤§é‡çš„æ— æ„ä¹‰çš„ IO å¼€é”€ã€‚åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸­ï¼Œå­˜åœ¨ä¸å°‘ Map ç±»å‹çš„å­—æ®µï¼Œè€Œä¸”å¾ˆå¤šåŒ…å«å‡ åè‡³å‡ ç™¾ä¸ª Keyï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ IO è¢«æ”¾å¤§äº†å‡ åè‡³å‡ ç™¾å€ã€‚<br></li><li><strong>æ— æ³•è¿›è¡Œå‘é‡åŒ–è¯»å–</strong>ï¼šè€Œå‘é‡åŒ–è¯»èƒ½æå¤§çš„æå‡æ€§èƒ½ã€‚ä½†æˆªæ­¢åˆ°ç›®å‰ï¼ˆ2019å¹´10æœˆ26æ—¥ï¼‰ï¼ŒSpark ä¸æ”¯æŒåŒ…å«åµŒå¥—æ•°æ®ç±»å‹çš„å‘é‡åŒ–è¯»å–ã€‚è¿™æå¤§çš„å½±å“äº†åŒ…å«åµŒå¥—æ•°æ®ç±»å‹çš„æŸ¥è¯¢æ€§èƒ½<br></li><li><strong>ä¸æ”¯æŒ Filter ä¸‹æ¨</strong>ï¼šç›®å‰ï¼ˆ2019å¹´10æœˆ26æ—¥ï¼‰çš„ Spark ä¸æ”¯æŒåµŒå¥—ç±»å‹å­—æ®µä¸Šçš„ Filter çš„ä¸‹æ¨<br></li><li><strong>é‡å¤è®¡ç®—</strong>ï¼šJSON å­—æ®µï¼Œåœ¨ Spark SQL ä¸­ä»¥ String ç±»å‹å­˜åœ¨ï¼Œä¸¥æ ¼æ¥è¯´ä¸ç®—åµŒå¥—æ•°æ®ç±»å‹ã€‚ä¸è¿‡å®è·µä¸­ä¹Ÿå¸¸ç”¨äºä¿å­˜ä¸å›ºå®šçš„å¤šä¸ªå­—æ®µï¼Œåœ¨æŸ¥è¯¢æ—¶é€šè¿‡ JSON Path æŠ½å–ç›®æ ‡å­å­—æ®µï¼Œè€Œå¤§å‹ JSON å­—ç¬¦ä¸²çš„å­—æ®µæŠ½å–éå¸¸æ¶ˆè€— CPUã€‚å¯¹äºçƒ­ç‚¹è¡¨ï¼Œé¢‘ç¹é‡å¤æŠ½å–ç›¸åŒå­å­—æ®µéå¸¸æµªè´¹èµ„æºã€‚<br></li></ul><p><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443241-a0b575d3-4b99-451f-802f-991fd41107f6.webp#align=left&display=inline&height=668&margin=%5Bobject%20Object%5D&originHeight=668&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444769-6635f36d-d873-430c-8223-adcb532766d6.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œåšæ•°ä»“çš„åŒå­¦ä¹Ÿæƒ³äº†ä¸€äº›è§£å†³æ–¹æ¡ˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<strong>åœ¨åä¸º base_table çš„è¡¨ä¹‹å¤–åˆ›å»ºäº†ä¸€å¼ åä¸º sub_table çš„è¡¨ï¼Œå¹¶ä¸”å°†é«˜é¢‘ä½¿ç”¨çš„å­å­—æ®µ people.age è®¾ç½®ä¸ºä¸€ä¸ªé¢å¤–çš„ Integer ç±»å‹çš„å­—æ®µ</strong>ã€‚ä¸‹æ¸¸ä¸å†é€šè¿‡ base_table æŸ¥è¯¢ people.ageï¼Œè€Œæ˜¯ä½¿ç”¨ sub_table ä¸Šçš„ age å­—æ®µä»£æ›¿ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°†åµŒå¥—ç±»å‹å­—æ®µä¸Šçš„æŸ¥è¯¢è½¬ä¸ºäº† Primitive ç±»å‹å­—æ®µçš„æŸ¥è¯¢ï¼ŒåŒæ—¶è§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444716-a4b11d0a-899e-430c-af62-8d0151c63af6.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif">)<img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443482-11bc4e9f-a7bb-4d7d-9026-746ea16d0d27.webp#align=left&display=inline&height=611&margin=%5Bobject%20Object%5D&originHeight=611&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>è¿™ç§æ–¹æ¡ˆå­˜åœ¨æ˜æ˜¾ç¼ºé™·ï¼š</p><ul><li><strong>é¢å¤–ç»´æŠ¤äº†ä¸€å¼ è¡¨</strong>ï¼Œå¼•å…¥äº†å¤§é‡çš„é¢å¤–å­˜å‚¨/è®¡ç®—å¼€é”€ã€‚<br></li><li>æ— æ³•åœ¨æ–°è¡¨ä¸ŠæŸ¥è¯¢æ–°å¢å­—æ®µçš„å†å²æ•°æ®ï¼ˆå¦‚è¦æ”¯æŒå¯¹å†å²æ•°æ®çš„æŸ¥è¯¢ï¼Œéœ€è¦é‡è·‘å†å²ä½œä¸šï¼Œå¼€é”€è¿‡å¤§ï¼Œæ— æ³•æ¥å—ï¼‰ã€‚<br></li><li>è¡¨çš„ç»´æŠ¤æ–¹éœ€è¦åœ¨ä¿®æ”¹è¡¨ç»“æ„åä¿®æ”¹æ’å…¥æ•°æ®çš„ä½œä¸šã€‚<br></li><li>éœ€è¦ä¸‹æ¸¸æŸ¥è¯¢æ–¹ä¿®æ”¹æŸ¥è¯¢è¯­å¥ï¼Œæ¨å¹¿æˆæœ¬è¾ƒå¤§ã€‚<br></li><li><strong>è¿è¥æˆæœ¬é«˜</strong>ï¼šå¦‚æœé«˜é¢‘å­å­—æ®µå˜åŒ–ï¼Œéœ€è¦åˆ é™¤ä¸å†éœ€è¦çš„ç‹¬ç«‹å­å­—æ®µï¼Œå¹¶æ·»åŠ æ–°å­å­—æ®µä¸ºç‹¬ç«‹å­—æ®µã€‚åˆ é™¤å‰ï¼Œéœ€è¦ç¡®ä¿ä¸‹æ¸¸æ— ä¸šåŠ¡ä½¿ç”¨è¯¥å­—æ®µã€‚è€Œæ–°å¢å­—æ®µéœ€è¦é€šçŸ¥å¹¶æ¨è¿›ä¸‹æ¸¸ä¸šåŠ¡æ–¹ä½¿ç”¨æ–°å­—æ®µã€‚<br></li></ul><p>ä¸ºè§£å†³ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬è®¾è®¡å¹¶å®ç°äº†ç‰©åŒ–åˆ—ã€‚å®ƒçš„åŸç†æ˜¯ï¼š</p><ul><li>æ–°å¢ä¸€ä¸ª Primitive ç±»å‹å­—æ®µï¼Œæ¯”å¦‚ Integer ç±»å‹çš„ age å­—æ®µï¼Œå¹¶ä¸”æŒ‡å®šå®ƒæ˜¯ people.age çš„ç‰©åŒ–å­—æ®µã€‚<br></li><li>æ’å…¥æ•°æ®æ—¶ï¼Œä¸ºç‰©åŒ–å­—æ®µè‡ªåŠ¨ç”Ÿæˆæ•°æ®ï¼Œå¹¶åœ¨ Partition Parameter å†…ä¿å­˜ç‰©åŒ–å…³ç³»ã€‚å› æ­¤å¯¹æ’å…¥æ•°æ®çš„ä½œä¸šå®Œå…¨é€æ˜ï¼Œè¡¨çš„ç»´æŠ¤æ–¹ä¸éœ€è¦ä¿®æ”¹å·²æœ‰ä½œä¸šã€‚<br></li><li>æŸ¥è¯¢æ—¶ï¼Œæ£€æŸ¥æ‰€éœ€æŸ¥è¯¢çš„æ‰€æœ‰ Partitionï¼Œå¦‚æœéƒ½åŒ…å«ç‰©åŒ–ä¿¡æ¯ï¼ˆpeople.age åˆ° age çš„æ˜ å°„ï¼‰ï¼Œç›´æ¥å°† select people.age è‡ªåŠ¨é‡å†™ä¸º select ageï¼Œä»è€Œå®ç°å¯¹ä¸‹æ¸¸æŸ¥è¯¢æ–¹çš„å®Œå…¨é€æ˜ä¼˜åŒ–ã€‚åŒæ—¶å…¼å®¹å†å²æ•°æ®ã€‚<br></li></ul><p><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443240-98b45cc3-1d0f-4093-980d-265abb445a8a.webp#align=left&display=inline&height=683&margin=%5Bobject%20Object%5D&originHeight=683&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444777-84f75218-68e0-4929-909d-4c828ab64f33.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br>ä¸‹å›¾å±•ç¤ºäº†åœ¨æŸå¼ æ ¸å¿ƒè¡¨ä¸Šä½¿ç”¨ç‰©åŒ–åˆ—çš„æ”¶ç›Šï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443260-d3424ecd-67fe-41ed-a902-edf0d1ee45ab.webp#align=left&display=inline&height=423&margin=%5Bobject%20Object%5D&originHeight=423&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621444729-1b39919b-8ea5-459e-bc2b-db24d8391b39.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br><strong>ç‰©åŒ–è§†å›¾</strong><br>åœ¨ OLAP é¢†åŸŸï¼Œç»å¸¸ä¼šå¯¹ç›¸åŒè¡¨çš„æŸäº›å›ºå®šå­—æ®µè¿›è¡Œ Group By å’Œ Aggregate / Join ç­‰è€—æ—¶æ“ä½œï¼Œé€ æˆå¤§é‡é‡å¤æ€§è®¡ç®—ï¼Œæµªè´¹èµ„æºï¼Œä¸”å½±å“æŸ¥è¯¢æ€§èƒ½ï¼Œä¸åˆ©äºæå‡ç”¨æˆ·ä½“éªŒã€‚<br>æˆ‘ä»¬å®ç°äº†åŸºäºç‰©åŒ–è§†å›¾çš„ä¼˜åŒ–åŠŸèƒ½ï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443261-8e8f3de2-937d-475b-aca0-d39fed39babb.webp#align=left&display=inline&height=594&margin=%5Bobject%20Object%5D&originHeight=594&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒæŸ¥è¯¢å†å²æ˜¾ç¤ºå¤§é‡æŸ¥è¯¢æ ¹æ® user è¿›è¡Œ group byï¼Œç„¶åå¯¹ num è¿›è¡Œ sum æˆ– count è®¡ç®—ã€‚æ­¤æ—¶å¯åˆ›å»ºä¸€å¼ ç‰©åŒ–è§†å›¾ï¼Œä¸”å¯¹ user è¿›è¡Œ gorup byï¼Œå¯¹ num è¿›è¡Œ avgï¼ˆavg ä¼šè‡ªåŠ¨è½¬æ¢ä¸º count å’Œ sumï¼‰ã€‚ç”¨æˆ·å¯¹åŸå§‹è¡¨è¿›è¡Œ select user, sum(num) æŸ¥è¯¢æ—¶ï¼ŒSpark SQL è‡ªåŠ¨å°†æŸ¥è¯¢é‡å†™ä¸ºå¯¹ç‰©åŒ–è§†å›¾çš„ select user, sum_num æŸ¥è¯¢ã€‚<br><strong><br></strong>Spark SQL å¼•æ“ä¸Šçš„å…¶å®ƒä¼˜åŒ–<strong><br>ä¸‹å›¾å±•ç¤ºäº†æˆ‘ä»¬åœ¨ Spark SQL ä¸Šè¿›è¡Œçš„å…¶å®ƒéƒ¨åˆ†ä¼˜åŒ–å·¥ä½œï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443207-45af67c8-8989-4026-81f3-d646d8123845.webp#align=left&display=inline&height=750&margin=%5Bobject%20Object%5D&originHeight=750&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br></strong><br><a name="5UxSb"></a></p><h2 id="Spark-Shuffleç¨³å®šæ€§æå‡ä¸æ€§èƒ½ä¼˜åŒ–"><a href="#Spark-Shuffleç¨³å®šæ€§æå‡ä¸æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="Spark Shuffleç¨³å®šæ€§æå‡ä¸æ€§èƒ½ä¼˜åŒ–"></a>Spark Shuffleç¨³å®šæ€§æå‡ä¸æ€§èƒ½ä¼˜åŒ–</h2><p><a name="5rTgp"></a></p><h3><a href="#" class="headerlink"></a></h3><p><a name="Ajtpe"></a></p><h3 id="Spark-Shuffle-å­˜åœ¨çš„é—®é¢˜"><a href="#Spark-Shuffle-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="Spark Shuffle å­˜åœ¨çš„é—®é¢˜"></a>Spark Shuffle å­˜åœ¨çš„é—®é¢˜</h3><p>Shuffleçš„åŸç†ï¼Œå¾ˆå¤šåŒå­¦åº”è¯¥å·²ç»å¾ˆç†Ÿæ‚‰äº†ã€‚é‰´äºæ—¶é—´å…³ç³»ï¼Œè¿™é‡Œä¸ä»‹ç»è¿‡å¤šç»†èŠ‚ï¼Œåªç®€å•ä»‹ç»ä¸‹åŸºæœ¬æ¨¡å‹ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621445126-5aa3b134-c904-42d9-ac04-09618bb32553.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif">)<img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621443213-c2f4bcdb-24e6-4fdc-afc2-3397f6608fec.webp#align=left&display=inline&height=679&margin=%5Bobject%20Object%5D&originHeight=679&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°† Shuffle ä¸Šæ¸¸ Stage ç§°ä¸º Mapper Stageï¼Œå…¶ä¸­çš„ Task ç§°ä¸º Mapperã€‚Shuffle ä¸‹æ¸¸ Stage ç§°ä¸º Reducer Stageï¼Œå…¶ä¸­çš„ Task ç§°ä¸º Reducerã€‚<br>æ¯ä¸ª Mapper ä¼šå°†è‡ªå·±çš„æ•°æ®åˆ†ä¸ºæœ€å¤š N ä¸ªéƒ¨åˆ†ï¼ŒN ä¸º Reducer ä¸ªæ•°ã€‚æ¯ä¸ª Reducer éœ€è¦å»æœ€å¤š M ï¼ˆMapper ä¸ªæ•°ï¼‰ä¸ª Mapper è·å–å±äºè‡ªå·±çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚<br><br><br>è¿™ä¸ªæ¶æ„å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><strong>ç¨³å®šæ€§é—®é¢˜</strong>ï¼šMapper çš„ Shuffle Write æ•°æ®å­˜äº Mapper æœ¬åœ°ç£ç›˜ï¼Œåªæœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚å½“è¯¥æœºå™¨å‡ºç°ç£ç›˜æ•…éšœï¼Œæˆ–è€… IO æ»¡è½½ï¼ŒCPU æ»¡è½½æ—¶ï¼ŒReducer æ— æ³•è¯»å–è¯¥æ•°æ®ï¼Œä»è€Œå¼•èµ· FetchFailedExceptionï¼Œè¿›è€Œå¯¼è‡´ Stage Retryã€‚Stage Retry ä¼šé€ æˆä½œä¸šæ‰§è¡Œæ—¶é—´å¢é•¿ï¼Œç›´æ¥å½±å“ SLAã€‚åŒæ—¶ï¼Œæ‰§è¡Œæ—¶é—´è¶Šé•¿ï¼Œå‡ºç° Shuffle æ•°æ®æ— æ³•è¯»å–çš„å¯èƒ½æ€§è¶Šå¤§ï¼Œåè¿‡æ¥åˆä¼šé€ æˆæ›´å¤š Stage Retryã€‚å¦‚æ­¤å¾ªç¯ï¼Œå¯èƒ½å¯¼è‡´å¤§å‹ä½œä¸šæ— æ³•æˆåŠŸæ‰§è¡Œã€‚</li></ul><p><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444392-8549057c-506b-4459-856d-0ce9cddf9910.webp#align=left&display=inline&height=628&margin=%5Bobject%20Object%5D&originHeight=628&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621445074-9921e4da-02ca-438c-9b15-403f41fba339.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"></p><ul><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šæ¯ä¸ª Mapper çš„æ•°æ®ä¼šè¢«å¤§é‡ Reducer è¯»å–ï¼Œå¹¶ä¸”æ˜¯éšæœºè¯»å–ä¸åŒéƒ¨åˆ†ã€‚å‡è®¾ Mapper çš„ Shuffle è¾“å‡ºä¸º 512MBï¼ŒReducer æœ‰ 10 ä¸‡ä¸ªï¼Œé‚£å¹³å‡æ¯ä¸ª Reducer è¯»å–æ•°æ® 512MB / 100000 = 5.24KBã€‚å¹¶ä¸”ï¼Œä¸åŒ Reducer å¹¶è¡Œè¯»å–æ•°æ®ã€‚å¯¹äº Mapper è¾“å‡ºæ–‡ä»¶è€Œè¨€ï¼Œå­˜åœ¨å¤§é‡çš„éšæœºè¯»å–ã€‚è€Œ HDD çš„éšæœº IO æ€§èƒ½è¿œä½äºé¡ºåº IOã€‚æœ€ç»ˆçš„ç°è±¡æ˜¯ï¼ŒReducer è¯»å– Shuffle æ•°æ®éå¸¸æ…¢ï¼Œåæ˜ åˆ° Metrics ä¸Šå°±æ˜¯ Reducer Shuffle Read Blocked Time è¾ƒé•¿ï¼Œç”šè‡³å æ•´ä¸ª Reducer æ‰§è¡Œæ—¶é—´çš„ä¸€å¤§åŠï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</li></ul><p><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444444-a5a5eeea-5d00-473f-892c-bef8ff9e032f.webp#align=left&display=inline&height=545&margin=%5Bobject%20Object%5D&originHeight=545&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621445093-1dba238c-18eb-4bc2-a637-4a5f0f069847.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br><strong>åŸºäºHDFSçš„Shuffleç¨³å®šæ€§æå‡</strong><br>ç»è§‚å¯Ÿï¼Œå¼•èµ· Shuffle å¤±è´¥çš„æœ€å¤§å› ç´ ä¸æ˜¯ç£ç›˜æ•…éšœç­‰ç¡¬ä»¶é—®é¢˜ï¼Œè€Œæ˜¯ CPU æ»¡è½½å’Œç£ç›˜ IO æ»¡è½½ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621445175-a4b309ba-f45b-4141-ac27-8771c622c313.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif">)<img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444483-bc3847a8-0664-4c0d-a4ed-ae5f1781331b.webp#align=left&display=inline&height=684&margin=%5Bobject%20Object%5D&originHeight=684&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæœºå™¨çš„ CPU ä½¿ç”¨ç‡æ¥è¿‘ 100%ï¼Œä½¿å¾— Mapper ä¾§çš„ Node Manager å†…çš„ Spark External Shuffle Service æ— æ³•åŠæ—¶æä¾› Shuffle æœåŠ¡ã€‚<br>ä¸‹å›¾ä¸­ Data Node å ç”¨äº†æ•´å°æœºå™¨ IO èµ„æºçš„ 84%ï¼Œéƒ¨åˆ†ç£ç›˜ IO å®Œå…¨æ‰“æ»¡ï¼Œè¿™ä½¿å¾—è¯»å– Shuffle æ•°æ®éå¸¸æ…¢ï¼Œè¿›è€Œä½¿å¾— Reducer ä¾§æ— æ³•åœ¨è¶…æ—¶æ—¶é—´å†…è¯»å–æ•°æ®ï¼Œé€ æˆ FetchFailedExceptionã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444481-5779db89-9d8b-4b17-82e3-7b60b08eed02.webp#align=left&display=inline&height=627&margin=%5Bobject%20Object%5D&originHeight=627&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>æ— è®ºæ˜¯ä½•ç§åŸå› ï¼Œé—®é¢˜çš„ç—‡ç»“éƒ½æ˜¯ Mapper ä¾§çš„ Shuffle Write æ•°æ®åªä¿å­˜åœ¨æœ¬åœ°ï¼Œä¸€æ—¦è¯¥èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼Œä¼šé€ æˆè¯¥èŠ‚ç‚¹ä¸Šæ‰€æœ‰ Shuffle Write æ•°æ®æ— æ³•è¢« Reducer è¯»å–ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªé€šç”¨æ–¹æ³•æ˜¯ï¼Œé€šè¿‡å¤šå‰¯æœ¬ä¿è¯å¯ç”¨æ€§ã€‚<br>æœ€åˆå§‹çš„ä¸€ä¸ªç®€å•æ–¹æ¡ˆæ˜¯ï¼ŒMapper ä¾§æœ€ç»ˆæ•°æ®æ–‡ä»¶ä¸ç´¢å¼•æ–‡ä»¶ä¸å†™åœ¨æœ¬åœ°ç£ç›˜ï¼Œè€Œæ˜¯ç›´æ¥å†™åˆ° HDFSã€‚Reducer ä¸å†é€šè¿‡ Mapper ä¾§çš„ External Shuffle Service è¯»å– Shuffle æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥ä» HDFS ä¸Šè·å–æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444436-0efdf8b6-0082-47c1-9218-36b6e6bbee4f.webp#align=left&display=inline&height=541&margin=%5Bobject%20Object%5D&originHeight=541&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>å¿«é€Ÿå®ç°è¿™ä¸ªæ–¹æ¡ˆåï¼Œæˆ‘ä»¬åšäº†å‡ ç»„ç®€å•çš„æµ‹è¯•ã€‚ç»“æœè¡¨æ˜ï¼š</p><ul><li>Mapper ä¸ Reducer ä¸å¤šæ—¶ï¼ŒShuffle è¯»å†™æ€§èƒ½ä¸åŸå§‹æ–¹æ¡ˆç›¸æ¯”æ— å·®å¼‚ã€‚<br></li><li>Mapper ä¸ Reducer è¾ƒå¤šæ—¶ï¼ŒShuffle è¯»å˜å¾—éå¸¸æ…¢ã€‚<br></li></ul><p><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444384-9bb761c9-fbe1-43c8-9a82-a51e97c97f8e.webp#align=left&display=inline&height=540&margin=%5Bobject%20Object%5D&originHeight=540&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>åœ¨ä¸Šé¢çš„å®éªŒè¿‡ç¨‹ä¸­ï¼ŒHDFS å‘å‡ºäº†æŠ¥è­¦ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒHDFS Name Node Proxy çš„ QPS å³°å€¼è¾¾åˆ° 60 ä¸‡ã€‚ï¼ˆæ³¨ï¼šå­—èŠ‚è·³åŠ¨è‡ªç ”äº† Node Name Proxyï¼Œå¹¶åœ¨ Proxy å±‚å®ç°äº†ç¼“å­˜ï¼Œå› æ­¤è¯» QPS å¯ä»¥æ”¯æ’‘åˆ°è¿™ä¸ªé‡çº§ï¼‰ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444590-4c232e53-8507-472c-844c-18249a03f85f.webp#align=left&display=inline&height=698&margin=%5Bobject%20Object%5D&originHeight=698&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>åŸå› åœ¨äºï¼Œæ€»å…± 10000 Reducerï¼Œéœ€è¦ä» 10000 ä¸ª Mapper å¤„è¯»å–æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶ï¼Œæ€»å…±éœ€è¦è¯»å– HDFS 10000 * 1000 * 2 = 2 äº¿æ¬¡ã€‚</p><p>å¦‚æœåªæ˜¯ Name Node çš„å•ç‚¹æ€§èƒ½é—®é¢˜ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸€äº›ç®€å•çš„æ–¹æ³•è§£å†³ã€‚ä¾‹å¦‚åœ¨ Spark Driver ä¾§ä¿å­˜æ‰€æœ‰ Mapper çš„ Block Locationï¼Œç„¶å Driver å°†è¯¥ä¿¡æ¯å¹¿æ’­è‡³æ‰€æœ‰ Executorï¼Œæ¯ä¸ª Reducer å¯ä»¥ç›´æ¥ä» Executor å¤„è·å– Block Locationï¼Œç„¶åæ— é¡»è¿æ¥ Name Nodeï¼Œè€Œæ˜¯ç›´æ¥ä» Data Node è¯»å–æ•°æ®ã€‚ä½†é‰´äº Data Node çš„çº¿ç¨‹æ¨¡å‹ï¼Œè¿™ç§æ–¹æ¡ˆä¼šå¯¹ Data Node é€ æˆè¾ƒå¤§å†²å‡»ã€‚<br>æœ€åæˆ‘ä»¬é€‰æ‹©äº†ä¸€ç§æ¯”è¾ƒç®€å•å¯è¡Œçš„æ–¹æ¡ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444471-aaff74d3-ec02-4014-8d71-1b201eafdbf1.webp#align=left&display=inline&height=582&margin=%5Bobject%20Object%5D&originHeight=582&originWidth=1080&size=0&status=done&style=none&width=1080" alt><br><br><br>Mapper çš„ Shuffle è¾“å‡ºæ•°æ®ä»ç„¶æŒ‰åŸæ–¹æ¡ˆå†™æœ¬åœ°ç£ç›˜ï¼Œå†™å®Œåä¸Šä¼ åˆ° HDFSã€‚Reducer ä»ç„¶æŒ‰åŸå§‹æ–¹æ¡ˆé€šè¿‡ Mapper ä¾§çš„ External Shuffle Service è¯»å– Shuffle æ•°æ®ã€‚å¦‚æœå¤±è´¥äº†ï¼Œåˆ™ä» HDFS è¯»å–ã€‚è¿™ç§æ–¹æ¡ˆæå¤§å‡å°‘äº†å¯¹ HDFS çš„è®¿é—®é¢‘ç‡ã€‚<br>è¯¥æ–¹æ¡ˆä¸Šçº¿è¿‘ä¸€å¹´ï¼š</p><ul><li>è¦†ç›– 57% ä»¥ä¸Šçš„ Spark Shuffle æ•°æ®ã€‚<br></li><li>ä½¿å¾— Spark ä½œä¸šæ•´ä½“æ€§èƒ½æå‡ 14%ã€‚<br></li><li>å¤©çº§å¤§ä½œä¸šæ€§èƒ½æå‡ 18%ã€‚<br></li><li>å°æ—¶çº§ä½œä¸šæ€§èƒ½æå‡ 12%ã€‚<br></li></ul><p><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444424-472f0478-d4b8-47de-a9ea-557b4c201c05.webp#align=left&display=inline&height=670&margin=%5Bobject%20Object%5D&originHeight=670&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><img src="https://cdn.nlark.com/yuque/0/2020/gif/1072113/1589621445065-2ed3ba00-5462-4f5f-9752-f2491fc7ea4d.gif#align=left&display=inline&height=1&margin=%5Bobject%20Object%5D&name=image.gif&originHeight=1&originWidth=1&size=70&status=done&style=none&width=1" alt="image.gif"><br>è¯¥æ–¹æ¡ˆæ—¨åœ¨æå‡ Spark Shuffle ç¨³å®šæ€§ä»è€Œæå‡ä½œä¸šç¨³å®šæ€§ï¼Œä½†æœ€ç»ˆæ²¡æœ‰ä½¿ç”¨æ–¹å·®ç­‰æŒ‡æ ‡æ¥è¡¡é‡ç¨³å®šæ€§çš„æå‡ã€‚åŸå› åœ¨äºæ¯å¤©é›†ç¾¤è´Ÿè½½ä¸ä¸€æ ·ï¼Œæ•´ä½“æ–¹å·®è¾ƒå¤§ã€‚Shuffle ç¨³å®šæ€§æå‡åï¼ŒStage Retry å¤§å¹…å‡å°‘ï¼Œæ•´ä½“ä½œä¸šæ‰§è¡Œæ—¶é—´å‡å°‘ï¼Œä¹Ÿå³æ€§èƒ½æå‡ã€‚æœ€ç»ˆé€šè¿‡å¯¹æ¯”ä½¿ç”¨è¯¥æ–¹æ¡ˆå‰åçš„æ€»çš„ä½œä¸šæ‰§è¡Œæ—¶é—´æ¥å¯¹æ¯”æ€§èƒ½çš„æå‡ï¼Œç”¨äºè¡¡é‡è¯¥æ–¹æ¡ˆçš„æ•ˆæœã€‚<br><strong>Shuffleæ€§èƒ½ä¼˜åŒ–å®è·µä¸æ¢ç´¢</strong><br>å¦‚ä¸Šæ–‡æ‰€åˆ†æï¼ŒShuffle æ€§èƒ½é—®é¢˜çš„åŸå› åœ¨äºï¼ŒShuffle Write ç”± Mapper å®Œæˆï¼Œç„¶å Reducer éœ€è¦ä»æ‰€æœ‰ Mapper å¤„è¯»å–æ•°æ®ã€‚è¿™ç§æ¨¡å‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºä»¥ Mapper ä¸ºä¸­å¿ƒçš„ Shuffleã€‚å®ƒçš„é—®é¢˜åœ¨äºï¼š</p><ul><li>Mapper ä¾§ä¼šæœ‰ M æ¬¡é¡ºåºå†™ IOã€‚<br></li><li>Mapper ä¾§ä¼šæœ‰ M * N * 2 æ¬¡éšæœºè¯» IOï¼ˆè¿™æ˜¯æœ€å¤§çš„æ€§èƒ½ç“¶é¢ˆï¼‰ã€‚<br></li><li>Mapper ä¾§çš„ External Shuffle Service å¿…é¡»ä¸ Mapper ä½äºåŒä¸€å°æœºå™¨ï¼Œæ— æ³•åšåˆ°æœ‰æ•ˆçš„å­˜å‚¨è®¡ç®—åˆ†ç¦»ï¼ŒShuffle æœåŠ¡æ— æ³•ç‹¬ç«‹æ‰©å±•ã€‚<br></li></ul><p>é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä»¥ Reducer ä¸ºä¸­å¿ƒçš„ï¼Œå­˜å‚¨è®¡ç®—åˆ†ç¦»çš„ Shuffle æ–¹æ¡ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/webp/1072113/1589621444445-e51ea3d0-904b-48ff-af72-22657a86b3ba.webp#align=left&display=inline&height=730&margin=%5Bobject%20Object%5D&originHeight=730&originWidth=1200&size=0&status=done&style=none&width=1200" alt><br><br><br>è¯¥æ–¹æ¡ˆçš„åŸç†æ˜¯ï¼ŒMapper ç›´æ¥å°†å±äºä¸åŒ Reducer çš„æ•°æ®å†™åˆ°ä¸åŒçš„ Shuffle Serviceã€‚åœ¨ä¸Šå›¾ä¸­ï¼Œæ€»å…± 2 ä¸ª Mapperï¼Œ5 ä¸ª Reducerï¼Œ5 ä¸ª Shuffle Serviceã€‚æ‰€æœ‰ Mapper éƒ½å°†å±äº Reducer 0 çš„æ•°æ®è¿œç¨‹æµå¼å‘é€ç»™ Shuffle Service 0ï¼Œå¹¶ç”±å®ƒé¡ºåºå†™å…¥ç£ç›˜ã€‚Reducer 0 åªéœ€è¦ä» Shuffle Service 0 é¡ºåºè¯»å–æ‰€æœ‰æ•°æ®å³å¯ï¼Œæ— éœ€å†ä» M ä¸ª Mapper å–æ•°æ®ã€‚è¯¥æ–¹æ¡ˆçš„ä¼˜åŠ¿åœ¨äºï¼š</p><ul><li>å°† M * N * 2 æ¬¡éšæœº IO å˜ä¸º N æ¬¡é¡ºåº IOã€‚<br></li><li>Shuffle Service å¯ä»¥ç‹¬ç«‹äº Mapper æˆ–è€… Reducer éƒ¨ç½²ï¼Œä»è€Œåšåˆ°ç‹¬ç«‹æ‰©å±•ï¼Œåšåˆ°å­˜å‚¨è®¡ç®—åˆ†ç¦»ã€‚<br></li><li>Shuffle Service å¯å°†æ•°æ®ç›´æ¥å­˜äº HDFS ç­‰é«˜å¯ç”¨å­˜å‚¨ï¼Œå› æ­¤å¯åŒæ—¶è§£å†³ Shuffle ç¨³å®šæ€§é—®é¢˜ã€‚<br></li></ul><p>æˆ‘çš„åˆ†äº«å°±åˆ°è¿™é‡Œï¼Œè°¢è°¢å¤§å®¶ã€‚<br><a name="23kL1"></a></p><h2 id="QAé›†é”¦"><a href="#QAé›†é”¦" class="headerlink" title="QAé›†é”¦"></a>QAé›†é”¦</h2><p><strong>- æé—®ï¼šç‰©åŒ–åˆ—æ–°å¢ä¸€åˆ—ï¼Œæ˜¯å¦éœ€è¦ä¿®æ”¹å†å²æ•°æ®ï¼Ÿ</strong><br>å›ç­”ï¼šå†å²æ•°æ®å¤ªå¤šï¼Œä¸é€‚åˆä¿®æ”¹å†å²æ•°æ®ã€‚</p><p><strong>- æé—®ï¼šå¦‚æœç”¨æˆ·çš„è¯·æ±‚åŒæ—¶åŒ…å«æ–°æ•°æ®å’Œå†å²æ•°æ®ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ</strong><br>å›ç­”ï¼šä¸€èˆ¬è€Œè¨€ï¼Œç”¨æˆ·ä¿®æ”¹æ•°æ®éƒ½æ˜¯ä»¥ Partition ä¸ºå•ä½ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ Partition Parameter ä¸Šä¿å­˜äº†ç‰©åŒ–åˆ—ç›¸å…³ä¿¡æ¯ã€‚å¦‚æœç”¨æˆ·çš„æŸ¥è¯¢åŒæ—¶åŒ…å«äº†æ–° Partition ä¸å†å² Partitionï¼Œæˆ‘ä»¬ä¼šåœ¨æ–° Partition ä¸Šé’ˆå¯¹ç‰©åŒ–åˆ—è¿›è¡Œ SQL Rewriteï¼Œå†å² Partition ä¸ Rewriteï¼Œç„¶åå°†æ–°è€ Partition è¿›è¡Œ Unionï¼Œä»è€Œåœ¨ä¿è¯æ•°æ®æ­£ç¡®æ€§çš„å‰æä¸‹å°½å¯èƒ½å……åˆ†åˆ©ç”¨ç‰©åŒ–åˆ—çš„ä¼˜åŠ¿ã€‚</p><p><strong>- æé—®ï¼šä½ å¥½ï¼Œä½ ä»¬é’ˆå¯¹ç”¨æˆ·çš„åœºæ™¯ï¼Œåšäº†å¾ˆå¤šæŒºæœ‰ä»·å€¼çš„ä¼˜åŒ–ã€‚åƒç‰©åŒ–åˆ—ã€ç‰©åŒ–è§†å›¾ï¼Œéƒ½éœ€è¦æ ¹æ®ç”¨æˆ·çš„æŸ¥è¯¢ Pattern è¿›è¡Œè®¾ç½®ã€‚ç›®å‰ä½ ä»¬æ˜¯äººå·¥åˆ†æè¿™äº›æŸ¥è¯¢ï¼Œè¿˜æ˜¯æœ‰æŸç§æœºåˆ¶è‡ªåŠ¨å»åˆ†æå¹¶ä¼˜åŒ–ï¼Ÿ</strong><br>å›ç­”ï¼šç›®å‰æˆ‘ä»¬ä¸»è¦æ˜¯é€šè¿‡ä¸€äº›å®¡è®¡ä¿¡æ¯è¾…åŠ©äººå·¥åˆ†æã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿæ­£åœ¨åšç‰©åŒ–åˆ—ä¸ç‰©åŒ–è§†å›¾çš„æ¨èæœåŠ¡ï¼Œæœ€ç»ˆåšåˆ°æ™ºèƒ½å»ºè®¾ç‰©åŒ–åˆ—ä¸ç‰©åŒ–è§†å›¾ã€‚</p><p><strong>- æé—®ï¼šåˆšåˆšä»‹ç»çš„åŸºäº HDFS çš„ Spark Shuffle ç¨³å®šæ€§æå‡æ–¹æ¡ˆï¼Œæ˜¯å¦å¯ä»¥å¼‚æ­¥ä¸Šä¼  Shuffle æ•°æ®è‡³ HDFSï¼Ÿ</strong><br>å›ç­”ï¼šè¿™ä¸ªæƒ³æ³•æŒºå¥½ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿè€ƒè™‘è¿‡ï¼Œä½†åŸºäºå‡ ç‚¹è€ƒè™‘ï¼Œæœ€ç»ˆæ²¡æœ‰è¿™æ ·åšã€‚ç¬¬ä¸€ï¼Œå• Mapper çš„ Shuffle è¾“å‡ºæ•°æ®é‡ä¸€èˆ¬å¾ˆå°ï¼Œä¸Šä¼ åˆ° HDFS è€—æ—¶åœ¨ 2 ç§’ä»¥å†…ï¼Œè¿™ä¸ªæ—¶é—´å¼€é”€å¯ä»¥å¿½ç•¥ï¼›ç¬¬äºŒï¼Œæˆ‘ä»¬å¹¿æ³›ä½¿ç”¨ External Shuffle Service å’Œ Dynamic Allocationï¼ŒMapper æ‰§è¡Œå®Œæˆåå¯èƒ½ Executor å°±å›æ”¶äº†ï¼Œå¦‚æœè¦å¼‚æ­¥ä¸Šä¼ ï¼Œå°±å¿…é¡»ä¾èµ–å…¶å®ƒç»„ä»¶ï¼Œè¿™ä¼šæå‡å¤æ‚åº¦ï¼ŒROI è¾ƒä½ã€‚</p><p><a name="BtHKy"></a></p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å­—èŠ‚çš„è¿™ç¯‡åˆ†äº«ï¼Œæˆ‘çœŸçš„å¤ªå–œæ¬¢äº†ï¼Œæ‰€æœ‰çš„ä¼˜åŒ–ç‚¹ï¼Œéƒ½æ˜¯æ‹¿çœŸå®çš„ä¸šåŠ¡åœºæ™¯è¿›è¡Œä¸¾ä¾‹ï¼Œè™½ç„¶ä¸Šæ–‡æœ‰çš„æŠ€æœ¯ç‚¹åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸­è¿˜æ²¡å¿…è¦å»åšåˆ°è¿™ç§ä¼˜åŒ–ç¨‹åº¦ï¼Œä½†æ˜¯å¦‚æ­¤å®åœ¨çš„æ¥æºäºçº¿ä¸Šçš„æ–¹æ¡ˆï¼Œéå¸¸å®¹æ˜“ç†è§£ã€‚æˆ‘ä»¬å…¬å¸ç›®å‰çš„æ•°æ®é‡è¦æ¯”å­—èŠ‚çš„é‡å°å¾ˆå¤šï¼Œæœ€è¿‘åœ¨æ–°é—»ä¸Šçœ‹åˆ°æŠ–éŸ³çš„æ—¥æ´»å·²ç»è¾¾åˆ°äº†4äº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ•°ä»“ä¸­çš„æ•°æ®ï¼Œè¿˜æ²¡æœ‰ç”¨åˆ°æ›´ç»†ç²’åº¦çš„Bucketè¡¨ï¼Œåˆ†åŒºè¡¨å°±å·²ç»å®Œå…¨å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ä¸Šæ–‡ä¸­çš„ç‰©åŒ–åˆ—æ–¹æ¡ˆï¼Œæˆ‘è§‰å¾—å¾ˆæ–°é¢–ï¼Œä½†æ˜¯ä»å·¥ç¨‹å¸ˆçš„è§’åº¦æ¥è®²ï¼Œåœ¨ç‰©åŒ–åˆ—æ–¹æ¡ˆä¸­ï¼Œå¤šç»´æŠ¤ä¸€å¼ è¡¨ï¼Œæ·»åŠ äº†å¤æ‚åº¦å’Œè¿è¥æˆæœ¬ï¼Œæˆ‘ä»¬åœ¨æ•°æ®çš„å­˜å‚¨ä¸­ï¼Œå°½å¯é‡çš„å›å»é¿å…å¤æ‚ç»“æ„çš„æ•°æ®ç±»å‹ï¼Œè¿™æ ·ä¼šé™ä½å­˜å‚¨ç«¯å’Œè®¡ç®—ç«¯ä»£ç çš„å¤æ‚åº¦ã€‚è¿™ç¯‡æ–‡ç« æ˜¯é’ˆå¯¹Spark SQLçš„ä¼˜åŒ–æ–¹é¢ï¼Œå¯ä»¥è¯´åŸºæœ¬ä¸Šæ¯ä¸ªå¤§æ•°æ®å…¬å¸éƒ½ä¼šç”¨åˆ°Spark SQLï¼Œä¸Šè¿°çš„ä¼˜åŒ–æ–¹æ¡ˆè‚¯å®šä¼šå¸®åŠ©åˆ°æ›´å¤šçš„å¤§æ•°æ®å›¢é˜Ÿ ğŸ’ª</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:02 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;br&gt;æœ¬æ–‡è½¬è½½è‡ªå­—èŠ‚è·³åŠ¨æŠ€æœ¯å›¢é˜Ÿåœ¨æ˜é‡‘ç½‘ä¸Šå‘è¡¨çš„æ–‡ç« ï¼Œä¸»è¦æ˜¯Spark SQLåœ¨å­—èŠ‚æ•°æ®ä»“åº“åº”ç”¨æ–¹é¢çš„ä¼˜åŒ–å®è·µ&lt;br&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href
      
    
    </summary>
    
    
      <category term="å¤§æ•°æ®" scheme="cpeixin.cn/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    
      <category term="spark" scheme="cpeixin.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„æœåŠ¡å™¨è¢«é»‘äº†ï¼ˆäºŒï¼‰</title>
    <link href="cpeixin.cn/2019/09/09/%E6%88%91%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E9%BB%91%E4%BA%86%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>cpeixin.cn/2019/09/09/%E6%88%91%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E9%BB%91%E4%BA%86%EF%BC%88%E4%BA%8C%EF%BC%89/</id>
    <published>2019-09-09T02:26:15.000Z</published>
    <updated>2020-04-04T12:00:14.168Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>è‹¦é€¼çš„å‘¨ä¸€å¼€å§‹äº†ï¼Œè‹¦é€¼çš„å·¥ä½œå¼€å§‹äº†ï¼Œååˆ°å·¥ä½ä¸Šï¼Œä¸Šç­æ°”æ­£åœ¨é€æ¸çš„å‡å¼±ï¼Œä½†æ˜¯å½“æˆ‘å‘ç°ï¼Œæˆ‘çš„ä¸‰å°æœåŠ¡å™¨åˆè¢«é‚£äº›æ— æƒ…çš„å°é»‘äººä»¬ç›¯ä¸Šäº†çš„æ—¶å€™ï¼Œæˆ‘çš„æ€’æ°”å€¼è¾¾åˆ°äº†é¡¶ç‚¹ï¼ŒåŒæ—¶è¿˜æ„Ÿè§‰æœ‰ç‚¹ä¸¢è„¸ï¼Œå“ˆå“ˆå“ˆã€‚<br><br><br>ç”±äºè¿™ä¸‰å°æœåŠ¡å™¨å±äºæˆ‘ä¸ªäººçš„ï¼Œæ²¡æœ‰ç»è¿‡è¿ç»´å…„å¼Ÿçš„ç…§é¡¾ï¼Œæ‰€ä»¥åœ¨å®‰å…¨æ–¹é¢ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰é˜²æŠ¤ã€‚<br>è¿™æ¬¡æ˜¯æ€ä¹ˆå‘ç°çš„å‘¢ï¼Œæ˜¯å› ä¸ºæˆ‘æœåŠ¡å™¨ä¸Šçš„çˆ¬è™«çªç„¶åœæ­¢äº†ï¼Œæˆ‘å¸¦ç€ç–‘é—®å»çœ‹äº†ä¸‹ç³»ç»Ÿæ—¥å¿—ã€‚äºæ˜¯æ•²ä¸‹äº†ä¸‹é¢çš„å‘½ä»¤<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">journalctl -xe</span><br></pre></td></tr></table></figure><p><br>æ˜ å…¥çœ¼å¸˜çš„æ˜¯æ»¡å±çš„æ‰«æå’Œsshå°è¯•ç™»é™†<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Failed password <span class="keyword">for</span> invalid user admin <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Received disconnect <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span>:<span class="number">11</span>: Bye Bye [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Disconnected <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span> [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Failed password <span class="keyword">for</span> invalid user ansible <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Received disconnect <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span>:<span class="number">11</span>: Bye Bye [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Disconnected <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span> [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span> port <span class="number">45157</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: error: maximum authentication attempts exceeded <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span> port <span class="number">45157</span> ssh2 [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: Disconnecting: Too many authentication failures [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: PAM <span class="number">5</span> more authentication failures; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: PAM service(sshd) ignoring max retries; <span class="number">6</span> &gt; <span class="number">3</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">52</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">310</span>]: pam_unix(sshd:auth): authentication failure; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">52</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">310</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: error: maximum authentication attempts exceeded <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2 [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Disconnecting: Too many authentication failures [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: PAM <span class="number">5</span> more authentication failures; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: PAM service(sshd) ignoring max retries; <span class="number">6</span> &gt; <span class="number">3</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">54</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">314</span>]: pam_unix(sshd:auth): authentication failure; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">54</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">314</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">lines <span class="number">1105</span><span class="number">-1127</span>/<span class="number">1127</span> (END)</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">49</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Failed password <span class="keyword">for</span> invalid user admin <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Received disconnect <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span>:<span class="number">11</span>: Bye Bye [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">303</span>]: Disconnected <span class="keyword">from</span> <span class="number">117.132</span><span class="number">.175</span><span class="number">.25</span> port <span class="number">42972</span> [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Failed password <span class="keyword">for</span> invalid user ansible <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Received disconnect <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span>:<span class="number">11</span>: Bye Bye [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">302</span>]: Disconnected <span class="keyword">from</span> <span class="number">149.56</span><span class="number">.96</span><span class="number">.78</span> port <span class="number">44980</span> [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">50</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span> port <span class="number">45157</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: error: maximum authentication attempts exceeded <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span> port <span class="number">45157</span> ssh2 [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: Disconnecting: Too many authentication failures [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: PAM <span class="number">5</span> more authentication failures; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">51</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65522</span>]: PAM service(sshd) ignoring max retries; <span class="number">6</span> &gt; <span class="number">3</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">52</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">310</span>]: pam_unix(sshd:auth): authentication failure; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">218.92</span><span class="number">.0</span><span class="number">.163</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">52</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">310</span>]: pam_succeed_if(sshd:auth): requirement <span class="string">"uid &gt;= 1000"</span> <span class="keyword">not</span> met by user <span class="string">"root"</span></span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Failed password <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: error: maximum authentication attempts exceeded <span class="keyword">for</span> root <span class="keyword">from</span> <span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span> port <span class="number">24184</span> ssh2 [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: Disconnecting: Too many authentication failures [preauth]</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: PAM <span class="number">5</span> more authentication failures; logname= uid=<span class="number">0</span> euid=<span class="number">0</span> tty=ssh ruser= rhost=<span class="number">49.88</span><span class="number">.112</span><span class="number">.54</span>  user=root</span><br><span class="line">Sep <span class="number">09</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">53</span> <span class="number">4</span>Z-J16-A47 sshd[<span class="number">65525</span>]: PAM service(sshd) ignoring max retries; <span class="number">6</span> &gt; <span class="number">3</span></span><br></pre></td></tr></table></figure><p><br>çœ‹åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰è‡ªå·±å®¶çš„é¸¡ï¼Œéšæ—¶éƒ½è¦è¢«å·èµ°å‘€ã€‚ã€‚ã€‚ã€‚è¿™è¿˜äº†å¾—ã€‚äºæ˜¯é©¬ä¸Šå¼€å§‹äº†åŠ å›ºé˜²æŠ¤<br>å¯¹å¾…è¿™ç§æƒ…å†µï¼Œå°±æ˜¯è¦ç¦æ­¢rootç”¨æˆ·è¿œç¨‹ç™»å½•ï¼Œä½¿ç”¨æ–°å»ºæ™®é€šç”¨æˆ·ï¼Œè¿›è¡Œè¿œç¨‹ç™»å½•ï¼Œè¿˜æœ‰é‡è¦çš„ä¸€ç‚¹ï¼Œä¿®æ”¹é»˜è®¤22ç«¯å£ã€‚<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@*** ~]<span class="comment"># useradd one             #åˆ›å»ºç”¨æˆ·</span></span><br><span class="line">[root@*** ~]<span class="comment"># passwd one              #è®¾ç½®å¯†ç </span></span><br></pre></td></tr></table></figure><p><br>è¾“å…¥æ–°ç”¨æˆ·å¯†ç <br>é¦–å…ˆç¡®ä¿æ–‡ä»¶ /etc/sudoers ä¸­<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">%wheel    ALL=(ALL)    ALL</span><br><span class="line">```  </span><br><span class="line">æ²¡æœ‰è¢«æ³¨é‡Š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```linux</span><br><span class="line">usermod -g wheel onerocket</span><br></pre></td></tr></table></figure><p><br>è®¾ç½®åªæœ‰æŒ‡å®šç”¨æˆ·ç»„æ‰èƒ½ä½¿ç”¨suå‘½ä»¤åˆ‡æ¢åˆ°rootç”¨æˆ·<br><br><br>åœ¨linuxä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤çš„ç®¡ç†ç»„ wheelã€‚åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå³ä½¿æˆ‘ä»¬æœ‰ç³»ç»Ÿç®¡ç†å‘˜rootçš„æƒé™ï¼Œä¹Ÿä¸æ¨èç”¨rootç”¨æˆ·ç™»å½•ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ç”¨æ™®é€šç”¨æˆ·ç™»å½•å°±å¯ä»¥äº†ï¼Œåœ¨éœ€è¦rootæƒé™æ‰§è¡Œä¸€äº›æ“ä½œæ—¶ï¼Œå†suç™»å½•æˆä¸ºrootç”¨æˆ·ã€‚ä½†æ˜¯ï¼Œä»»ä½•äººåªè¦çŸ¥é“äº†rootçš„å¯†ç ï¼Œå°±éƒ½å¯ä»¥é€šè¿‡suå‘½ä»¤æ¥ç™»å½•ä¸ºrootç”¨æˆ·ï¼Œè¿™æ— ç–‘ä¸ºç³»ç»Ÿå¸¦æ¥äº†å®‰å…¨éšæ‚£ã€‚æ‰€ä»¥ï¼Œå°†æ™®é€šç”¨æˆ·åŠ å…¥åˆ°wheelç»„ï¼Œè¢«åŠ å…¥çš„è¿™ä¸ªæ™®é€šç”¨æˆ·å°±æˆäº†ç®¡ç†å‘˜ç»„å†…çš„ç”¨æˆ·ã€‚ç„¶åè®¾ç½®åªæœ‰wheelç»„å†…çš„æˆå‘˜å¯ä»¥ä½¿ç”¨suå‘½ä»¤åˆ‡æ¢åˆ°rootç”¨æˆ·ã€‚<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /bin/bash</span></span><br><span class="line"><span class="comment"># Function: ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—åªæœ‰wheelç»„çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨ su æƒé™</span></span><br><span class="line">sed -i <span class="string">'/pam_wheel.so use_uid/c\auth            required        pam_wheel.so use_uid '</span> /etc/pam.d/su</span><br><span class="line">n=`cat /etc/login.defs | grep SU_WHEEL_ONLY | wc -l`</span><br><span class="line"><span class="keyword">if</span> [ $n -eq <span class="number">0</span> ];then</span><br><span class="line">echo SU_WHEEL_ONLY yes &gt;&gt; /etc/login.defs</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><br>æ‰“å¼€SSHDçš„é…ç½®æ–‡ä»¶<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p><br>æŸ¥æ‰¾â€œ#PermitRootLogin yesâ€ï¼Œå°†å‰é¢çš„â€œ#â€å»æ‰ï¼ŒçŸ­å°¾â€œyesâ€æ”¹ä¸ºâ€œnoâ€ï¼ˆä¸åŒç‰ˆæœ¬å¯èƒ½åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¹¶ä¿å­˜æ–‡ä»¶ã€‚<br><br><br>ä¿®æ”¹sshdé»˜è®¤ç«¯å£<br>è™½ç„¶æ›´æ”¹ç«¯å£æ— æ³•åœ¨æ ¹æœ¬ä¸ŠæŠµå¾¡ç«¯å£æ‰«æï¼Œä½†æ˜¯ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜é˜²å¾¡ã€‚<br>æ‰“å¼€sshdé…ç½®æ–‡ä»¶<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p><br>æ‰¾åˆ°#Port 22 åˆ æ‰æ³¨é‡Š<br><br><br><em>æœåŠ¡å™¨ç«¯å£æœ€å¤§å¯ä»¥å¼€åˆ°65536</em><br><br><br>åŒæ—¶å†æ·»åŠ ä¸€ä¸ªPort 61024 ï¼ˆéšæ„è®¾ç½®ï¼‰<br><br><br>Port 22<br>Port 61024<br><br><br>é‡å¯sshdæœåŠ¡<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart      <span class="comment">#centos6ç³»åˆ—</span></span><br><span class="line">systemctl restart sshd  <span class="comment">#centos7ç³»åˆ—</span></span><br><span class="line">firewall-cmd --add-port=<span class="number">61024</span>/tcp</span><br></pre></td></tr></table></figure><p><br>æµ‹è¯•ï¼Œä½¿ç”¨æ–°ç”¨æˆ·ï¼Œæ–°ç«¯å£è¿›è¡Œç™»å½•<br><br><br>å¦‚æœç™»é™†æˆåŠŸåï¼Œå†å°†Port22æ³¨é‡Šæ‰ï¼Œé‡å¯sshdæœåŠ¡ã€‚<br>åˆ°è¿™é‡Œï¼Œå…³äºè¿œç¨‹ç™»å½•çš„é˜²æŠ¤å·¥ä½œï¼Œå°±åšå¥½äº†ã€‚<br>æœ€åï¼Œå‘Šè¯«å¤§å®¶ï¼Œäº²èº«ä½“éªŒï¼Œæ²¡æœ‰é˜²æŠ¤è£¸å¥”çš„æœåŠ¡å™¨ï¼ŒçœŸçš„å¤ªå®¹æ˜“è¢«æŠ“è‚‰é¸¡äº†ï¼ï¼ï¼ï¼ï¼</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;è‹¦é€¼çš„å‘¨ä¸€å¼€å§‹äº†ï¼Œè‹¦é€¼çš„å·¥ä½œå¼€å§‹äº†ï¼Œååˆ°å·¥ä½ä¸Šï¼Œä¸Šç­æ°”æ­£åœ¨é€æ¸çš„å‡å¼±ï¼Œä½†æ˜¯å½“æˆ‘å‘ç°ï¼Œæˆ‘çš„ä¸‰å°æœåŠ¡å™¨åˆè¢«é‚£äº›æ— æƒ…çš„å°é»‘äººä»¬ç›¯ä¸Šäº†çš„æ—¶å€™ï¼Œæˆ‘çš„æ€’æ°”å€¼
      
    
    </summary>
    
    
      <category term="Linux" scheme="cpeixin.cn/categories/Linux/"/>
    
    
      <category term="æœåŠ¡å™¨å®‰å…¨" scheme="cpeixin.cn/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„æœåŠ¡å™¨è¢«é»‘äº†</title>
    <link href="cpeixin.cn/2019/08/24/%E6%88%91%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E9%BB%91%E4%BA%86/"/>
    <id>cpeixin.cn/2019/08/24/%E6%88%91%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A2%AB%E9%BB%91%E4%BA%86/</id>
    <published>2019-08-24T02:26:15.000Z</published>
    <updated>2020-04-04T12:00:09.871Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="-2"></a></p><h1 id="æœåŠ¡å™¨è‡ªè¿°"><a href="#æœåŠ¡å™¨è‡ªè¿°" class="headerlink" title="æœåŠ¡å™¨è‡ªè¿°"></a>æœåŠ¡å™¨è‡ªè¿°</h1><p>æˆ‘æ˜¯ä¸€å°8æ ¸ï¼Œ16Gå†…å­˜ï¼Œ4Tçš„Linux (centOS 7)æœåŠ¡å™¨â€¦ è¿˜æœ‰ä¸¤å°å’Œæˆ‘ä¸€èµ·è¢«ä¹°æ¥çš„è‹¦ä¸»ï¼Œæˆ‘ä»¬ä¸€åŒé•¿å¤§ï¼Œé…ç½®ä¸€æ ·ï¼Œéƒ½æ˜¯ä»é¦™æ¸¯è¢«è´©å–åˆ°å›½å¤–ï¼Œæˆ‘ä»¬ä¸‰ä¸ªç»„æˆäº†åˆ†å¸ƒå¼çˆ¬è™«æ¡†æ¶ï¼Œå¦ä¸¤ä½è‹¦ä¸»åˆ†åˆ«è´Ÿè´£å¼‚æ­¥çˆ¬å–è¿æ¥ï¼Œå¤šè¿›ç¨‹çˆ¬å–è¿æ¥å’Œscrapy-redisåˆ†å¸ƒå¼çˆ¬å–è§£æã€‚<br><br><br>è€Œæˆ‘æ¯”è¾ƒæ¸…é—²ï¼Œåªè´Ÿè´£å­˜å‚¨. ç½‘é¡µé“¾æ¥æ”¾åœ¨æˆ‘çš„redisä¸­ï¼Œè€Œè§£æå¥½çš„æ–‡ç« ä¿¡æ¯æ”¾åœ¨æˆ‘çš„MySQLä¸­ã€‚ç„¶è€Œæ•…äº‹çš„å¼€å§‹ï¼Œå°±æ˜¯åœ¨å®‰è£…redisçš„é‚£å¤©ï¼Œä¸»äººçš„ç²—å¿ƒå¤§æ„ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œä»è€Œè®©ä»–ä»Šå¤©èŠ±è´¹äº†å°åŠå¤©æ¥å¯¹æˆ‘è¿›è¡Œç»´ä¿®ï¼ï¼ğŸ˜¢<br><a name="-3"></a></p><h1 id="ä¸ºä»€ä¹ˆé»‘æˆ‘çš„æœåŠ¡å™¨"><a href="#ä¸ºä»€ä¹ˆé»‘æˆ‘çš„æœåŠ¡å™¨" class="headerlink" title="ä¸ºä»€ä¹ˆé»‘æˆ‘çš„æœåŠ¡å™¨"></a>ä¸ºä»€ä¹ˆé»‘æˆ‘çš„æœåŠ¡å™¨</h1><p>è¿™æ ·ä¸€å°é…ç½®çš„æœåŠ¡å™¨ï¼Œä¸€ä¸ªæœˆçš„ä»·æ ¼å¤§æ¦‚åœ¨1000RMBä¸€ä¸ªæœˆï¼Œæ€ä¹ˆè¯´å‘¢â€¦ è¿™ä¸ªä»·æ ¼çš„æœåŠ¡å™¨å¯¹äºä¸ªäººç”¨æˆ·æ­å»ºè‡ªå·±ç©çš„ç¯å¢ƒè¿˜æ˜¯æœ‰äº›å°è´µçš„ã€‚ä¾‹å¦‚æˆ‘ç°åœ¨å†™åšå®¢ï¼Œä¹Ÿæ˜¯æ‰˜ç®¡åœ¨GitHubä¸Šçš„ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç§Ÿç”¨ä¸€å°æœåŠ¡å™¨æ¥æ‰˜ç®¡çš„åšå®¢ï¼Œä½†æ˜¯ç›®å‰æˆ‘çš„è¿™ç§çº§åˆ«ï¼Œä¹Ÿæ˜¯è¦è€ƒè™‘åˆ°æŠ•å…¥äº§å‡ºæ¯”æ˜¯å¦åˆé€‚ï¼Œå“ˆå“ˆå“ˆã€‚<br><br><br>ä½†æ˜¯å¯¹äºï¼ŒæœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä»»åŠ¡å’ŒæœåŠ¡äº§å‡ºçš„ä»·å€¼è¦è¿œè¿œå¤§äºæœåŠ¡å™¨ä»·å€¼çš„æ—¶å€™ï¼Œè¿™1000å¤šRMBå°±å¯ä»¥å¿½ç•¥ä¸è®¡äº†ã€‚åŒæ—¶ï¼Œè¿˜æœ‰é»‘è¡£äººï¼Œä»–ä»¬éœ€è¦å¤§é‡çš„æœåŠ¡å™¨ï¼Œæ¥è¿è¡ŒåŒæ ·çš„ç¨‹åºï¼Œäº§å‡ºçš„ä»·å€¼ä»–ä»¬ä¹Ÿæ— æ³•è¡¡é‡ï¼Œæœ‰å¯èƒ½å¾ˆå¤šæœ‰å¯èƒ½å¾ˆå°‘ã€‚ã€‚<br><br><br>é‚£ä¹ˆè¿™æ—¶å€™ï¼Œä»–ä»¬ä¸ºäº†èŠ‚çº¦æˆæœ¬ï¼Œé™ä½æˆæœ¬ï¼Œå°±ä¼šç”¨ä¸€äº›é»‘è‰²çš„æ‰‹æ³•ï¼Œä¾‹å¦‚æ¸—é€ï¼Œsqlæ³¨å…¥ï¼Œæ ¹æ®æ¼æ´æ‰«æç­‰æ–¹æ³•æ¥ æŠ“â€œè‚‰é¸¡â€ï¼ŒæŠ“åˆ°å¤§é‡çš„å¯ä¾µå…¥çš„æœåŠ¡å™¨ï¼Œç„¶ååœ¨ä½ çš„æœåŠ¡å™¨ä¸Šçš„æŸä¸€ä¸ªè§’è½ï¼Œæ”¾ä¸Šä»–çš„ç¨‹åºï¼Œä¸€ç›´åœ¨è¿è¡Œï¼Œä¸€ç›´åœ¨è¿è¡Œï¼Œå ç”¨ç€ä½ çš„cpu,å ç”¨ç€ä½ çš„å¸¦å®½â€¦<br><br><br>é‚£ä¹ˆä¸Šé¢æåˆ°çš„é»‘è¡£äººï¼Œå°±æœ‰é‚£ä¹ˆä¸€ç±»è§’è‰²ï¼Œâ€œçŸ¿å·¥â€ï¼ï¼ï¼ï¼<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585404954445-f30a25a0-5939-4773-b5d9-8bb6a7c53b02.png#align=left&display=inline&height=892&name=1.png&originHeight=892&originWidth=1244&size=1778564&status=done&style=none&width=1244" alt="1.png"><br><br><br>æ›¾ç»ï¼Œæˆ‘ä¹Ÿä¸“æ³¨è¿‡åŒºå—é“¾ï¼Œæˆ‘ä¹ŸçŸ­æš‚çš„è¿·å¤±åœ¨æ•°å­—è´§å¸çš„æµªæ½®ä¸­ï¼Œä½†æ˜¯æ²¡æœ‰åƒåˆ°çº¢åˆ©ğŸ‘€ğŸ‘€ğŸ‘€ å°±æ˜¯è¿™äº›æ•°å­—ä¸–ç•Œçš„çŸ¿å·¥ï¼Œåˆ©ç”¨æˆ‘æœåŠ¡å™¨çš„æ¼æ´é»‘äº†æˆ‘çš„æœåŠ¡å™¨<br><a name="-4"></a></p><h1 id="å¦‚ä½•å‘ç°è¢«é»‘"><a href="#å¦‚ä½•å‘ç°è¢«é»‘" class="headerlink" title="å¦‚ä½•å‘ç°è¢«é»‘"></a>å¦‚ä½•å‘ç°è¢«é»‘</h1><p>å›åˆ°è¿™ç¯‡åšå®¢çš„æ­£é¢˜ï¼Œæˆ‘æ˜¯å¦‚ä½•å‘ç°ï¼Œæˆ‘çš„æœåŠ¡å™¨è¢«é»‘äº†å‘¢ï¼Ÿï¼Ÿ<br><br><br>æœ€è¿‘æˆ‘åœ¨åšscrapyåˆ†å¸ƒå¼çˆ¬è™«æ–¹é¢çš„å·¥ä½œï¼Œå‡†å¤‡äº†ä¸‰å°æœåŠ¡å™¨ï¼Œè€Œè¿™å°è¢«é»‘çš„æœåŠ¡å™¨æ˜¯æˆ‘ç”¨æ¥åšå­˜å‚¨çš„ï¼Œå…¶ä¸­ç”¨åˆ°äº†rediså’Œmysqlã€‚å…¶ä¸­å¼•å‘è¿™ä»¶äº‹æƒ…çš„å°±æ˜¯redisï¼Œæˆ‘åœ¨å®‰è£…redisçš„æ—¶å€™ï¼Œå¯ä»¥è¯´è´£ä»»å®Œå…¨åœ¨æˆ‘ï¼Œæˆ‘ä¸ºäº†å®‰è£…èŠ‚çº¦æ—¶é—´ï¼Œä»¥åä½¿ç”¨æ–¹ä¾¿ç­‰ï¼Œåšäº†å‡ ä¸ªå¾ˆé”™è¯¯çš„æ“ä½œ<br><br><br>1.å…³é—­äº†Linuxé˜²ç«å¢™<br><br><br>2.æ²¡æœ‰è®¾ç½®redisè®¿é—®å¯†ç <br><br><br>3.æ²¡æœ‰æ›´æ”¹redisé»˜è®¤ç«¯å£<br><br><br>4.å¼€æ”¾äº†ä»»æ„IPå¯ä»¥è¿œç¨‹è¿æ¥<br><br><br>ä»¥ä¸Šå››ä¸ªå¾ˆå‚»çš„æ“ä½œ,éƒ½æ˜¯å› ä¸ºä»¥å‰æ‰€ç”¨çš„rediséƒ½æ˜¯æœ‰å…¬å¸è¿ç»´åŒäº‹è¿›è¡Œå®‰è£…ä»¥åŠå®‰å…¨ç­–ç•¥æ–¹é¢çš„é…ç½®ï¼Œä»¥è‡³æˆ‘è¿™ä¸€æ¬¡æ²¡æœ‰æ³¨æ„åˆ°å®‰è£…æ–¹é¢ã€‚<br><br><br>å½“æˆ‘çš„çˆ¬è™«ç¨‹åºå·²ç»å¹³ç¨³çš„è¿è¡Œäº†ä¸¤å¤©äº†ï¼Œæˆ‘å°±å¼€å§‹æ”¾å¿ƒäº†ï¼Œé™é™åœ°çœ‹ç€spiderç–¯ç‹‚çš„spider,å¯æ˜¯å°±æ˜¯åœ¨éšåï¼ŒredisæœåŠ¡å‡ºç°å¼‚å¸¸ï¼Œé¦–å…ˆæ˜¯æˆ‘æœ¬åœ°å®¢æˆ·ç«¯è¿æ¥ä¸ä¸Šè¿œç¨‹redis-serverï¼Œæˆ‘æœ‰æƒ³è¿‡æ˜¯ä¸æ˜¯ç½‘ç»œä¸ç¨³å®šçš„é—®é¢˜ã€‚åœ¨æˆ‘é‡å¯redisåï¼Œæ¢å¤æ­£å¸¸ï¼Œåˆå¹³ç¨³çš„è¿è¡Œäº†ä¸€å¤©ã€‚<br><br><br>ä½†æ˜¯æ¥ä¸‹æ¥redisé¢‘ç¹å‡ºé—®é¢˜ï¼Œæˆ‘å°±æƒ³ï¼Œæ˜¯ä¸æ˜¯çˆ¬è™«çˆ¬å–äº†å¤§é‡çš„ç½‘é¡µé“¾æ¥ï¼Œå¯¹redisé€ æˆäº†é˜»å¡ã€‚äºæ˜¯ï¼Œæˆ‘å¼€å¯äº†å¯¹redis.confï¼Œè¿˜æœ‰ç¨‹åºç«¯çš„connectä¸¤æ–¹é¢360åº¦çš„ä¼˜åŒ–ï¼Œç„¶å¹¶åµã€‚ã€‚ã€‚<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i tcp:<span class="number">6379</span></span><br></pre></td></tr></table></figure><p><br>ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤åï¼Œå‘ç°redisæœåŠ¡æ­£å¸¸è¿è¡Œï¼Œ6379ç«¯å£ä¹Ÿæ˜¯å¼€å¯çš„ã€‚æˆ‘é™·å…¥äº†æ·±æ·±åœ°è¿·æƒ‘ã€‚ã€‚ã€‚ã€‚ã€‚<br><br><br>ä½†æ˜¯è¿™æ—¶å…¶å®å°±åº”è¯¥çœ‹å‡ºä¸€äº›ç«¯å€ªäº†ï¼Œå› ä¸ºæ­£å¸¸å ç”¨ 6379 ç«¯å£çš„è¿›ç¨‹åæ˜¯ ï¼š redis-ser ã€‚ä½†æ˜¯ç°åœ¨å ç”¨ 6379 ç«¯å£çš„è¿›ç¨‹åæ˜¯ ï¼šxmrig-no (å¿˜è®°æˆªå›¾äº†)ï¼Œä½†æ˜¯è¿™æ—¶æˆ‘ä¹Ÿæ²¡æœ‰å¤šæƒ³<br>ç›´åˆ°æˆ‘è¿è¡Œï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure><p><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585404912911-97736d80-2ee3-455d-a948-6d134f4e2663.png#align=left&display=inline&height=534&name=2.png&originHeight=534&originWidth=3338&size=980508&status=done&style=none&width=3338" alt="2.png"><br>å‘ç°äº†å ç”¨ 6379 ç«¯å£çš„è¿›ç¨‹å…¨åç§°xmrigâ€¦ï¼Œæˆ‘æ‰æç„¶å¤§æ‚Ÿï¼Œæˆ‘çš„ç«¯å£è¢«å ç”¨äº†ã€‚æˆ‘åœ¨googleä¸Šä¸€æŸ¥ï¼Œæ‰å‘ç°ã€‚ã€‚æˆ‘è¢«é»‘äº†<br><a name="-5"></a></p><h1 id="åšäº†å“ªäº›æ€¥æ•‘å·¥ä½œ"><a href="#åšäº†å“ªäº›æ€¥æ•‘å·¥ä½œ" class="headerlink" title="åšäº†å“ªäº›æ€¥æ•‘å·¥ä½œ"></a>åšäº†å“ªäº›æ€¥æ•‘å·¥ä½œ</h1><p>è¿™æ—¶ï¼Œæ„Ÿè§‰è‡ªå·±å¼€å§‹æŠ•å…¥äº†ä¸€åœºå¯¹æŠ—æˆ˜<br><br><br>1.é¦–å…ˆæŸ¥æ‰¾æ¤å…¥ç¨‹åºçš„ä½ç½®ã€‚<br>åœ¨/tmp/ç›®å½•ä¸‹ï¼Œä¸€èˆ¬æ¤å…¥ç¨‹åºéƒ½ä¼šæ”¾åœ¨ /tmp ä¸´æ—¶ç›®å½•ä¸‹ï¼Œå…¶å®å›è¿‡å¤´ä¸€æƒ³ï¼Œæ”¾åœ¨è¿™é‡Œï¼Œä¹Ÿæ˜¯æŒºå¦™çš„ã€‚<br><br><br>2.åˆ é™¤æ¸…ç†å¯ç–‘æ–‡ä»¶<br><br><br>æ€æ­»è¿›ç¨‹<br><br><br>åˆ é™¤äº†æ­£åœ¨è¿è¡Œçš„ç¨‹åºæ–‡ä»¶è¿˜æœ‰å®‰è£…åŒ…<br>3.æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd |cut -f <span class="number">1</span> -d:crontab -uXXX -l</span><br></pre></td></tr></table></figure><p><br>4.å¼€å¯é˜²ç«å¢™<br><br><br>ä»…å¼€æ”¾ä¼šä½¿ç”¨åˆ°çš„ç«¯å£<br>5.ä¿®æ”¹redisé»˜è®¤ç«¯å£<br><br><br>redis.confä¸­çš„port<br>6.æ·»åŠ redisæˆæƒå¯†ç <br><br><br>redis.confä¸­çš„requirepass<br>7.ä¿®æ”¹ç»‘å®šè¿œç¨‹ç»‘å®šip<br><br><br>redis.confä¸­çš„bind<br>æœ€åé‡å¯redisæœåŠ¡ï¼<br><a name="-6"></a></p><h1 id="ä»ä¸­å­¦åˆ°äº†ä»€ä¹ˆ"><a href="#ä»ä¸­å­¦åˆ°äº†ä»€ä¹ˆ" class="headerlink" title="ä»ä¸­å­¦åˆ°äº†ä»€ä¹ˆ"></a>ä»ä¸­å­¦åˆ°äº†ä»€ä¹ˆ</h1><p>æ˜æ˜æ˜¯è‡ªå·±è¢«é»‘äº†ï¼Œä½†æ˜¯åœ¨è¡¥æ•‘çš„è¿‡ç¨‹ä¸­ï¼Œå´å¾—åˆ°äº†å†™ç¨‹åºç»™ä¸äº†çš„æ»¡è¶³æ„Ÿã€‚æ„Ÿè§‰å› ä¸ºè¿™ä»¶äº‹æƒ…ï¼Œä¸Šå¸ç»™æˆ‘æ‰“å¼€äº†å¦ä¸€æ‰‡çª—æˆ·ï½ï½ï½<br>æœ€åè¯´ä¸‹ï¼Œè¿™ä¸ªæœ¨é©¬æ˜¯æ€ä¹ˆè¿›æ¥çš„å‘¢ï¼ŒæŸ¥äº†ä¸€ä¸‹åŸæ¥æ˜¯åˆ©ç”¨Redisç«¯å£æ¼æ´è¿›æ¥çš„ï¼Œå®ƒå¯ä»¥å¯¹æœªæˆæƒè®¿é—®redisçš„æœåŠ¡å™¨ç™»å½•ï¼Œå®šæ—¶ä¸‹è½½å¹¶æ‰§è¡Œè„šæœ¬ï¼Œè„šæœ¬è¿è¡Œï¼ŒæŒ–çŸ¿ï¼Œè¿œç¨‹è°ƒç”¨ç­‰ã€‚æ‰€ä»¥é™¤äº†æ‰§è¡Œä¸Šè¿°æ“ä½œï¼ŒlinuxæœåŠ¡å™¨ä¸­çš„ç”¨æˆ·æƒé™ï¼ŒæœåŠ¡æƒé™ç²¾ç»†åŒ–ï¼Œé˜²æ­¢å†æ¬¡è¢«å…¥ä¾µã€‚<br></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;-2&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h1 id=&quot;æœåŠ¡å™¨è‡ªè¿°&quot;&gt;&lt;a href=&quot;#æœåŠ¡å™¨è‡ªè¿°&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
    
      <category term="Linux" scheme="cpeixin.cn/categories/Linux/"/>
    
    
      <category term="æœåŠ¡å™¨å®‰å…¨" scheme="cpeixin.cn/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>pythonçˆ¬è™« - åŠ¨æ€çˆ¬å–</title>
    <link href="cpeixin.cn/2019/06/12/python%E7%88%AC%E8%99%AB%E4%B9%8B%E5%8A%A8%E6%80%81%E7%88%AC%E5%8F%96/"/>
    <id>cpeixin.cn/2019/06/12/python%E7%88%AC%E8%99%AB%E4%B9%8B%E5%8A%A8%E6%80%81%E7%88%AC%E5%8F%96/</id>
    <published>2019-06-12T15:26:15.000Z</published>
    <updated>2020-04-04T17:11:17.062Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯æŠ“å–æ‹‰å‹¾ç½‘Pythonåˆ†ç±»ä¸‹å…¨å›½åˆ°ç›®å‰ä¸ºæ­¢å±•ç¤ºå‡ºæ¥çš„æ‰€æœ‰æ‹›è˜ä¿¡æ¯ï¼Œé¦–å…ˆåœ¨æµè§ˆå™¨ç‚¹å‡»è¿›å»çœ‹çœ‹å§ã€‚å¦‚æœä½ è¶³å¤Ÿå°å¿ƒæˆ–è€…ç½‘é€Ÿæ¯”è¾ƒæ…¢ï¼Œé‚£ä¹ˆä½ ä¼šå‘ç°ï¼Œåœ¨ç‚¹å‡»Pythonåˆ†ç±»ä¹‹åè·³åˆ°çš„æ–°é¡µé¢ä¸Šï¼Œæ‹›è˜ä¿¡æ¯å‡ºç°æ—¶é—´æ˜¯æ™šäºé¡µé¢æ¡†æ¶å‡ºç°æ—¶é—´çš„ã€‚åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥è‚¯å®šï¼Œæ‹›è˜ä¿¡æ¯å¹¶ä¸åœ¨é¡µé¢HTMLæºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‰ä¸‹â€command+option+uâ€(åœ¨Windowså’ŒLinuxä¸Šçš„å¿«æ·é”®æ˜¯â€ctrl+uâ€)æ¥æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæœç„¶åœ¨æºç ä¸­æ²¡æœ‰å‡ºç°é¡µé¢å±•ç¤ºçš„æ‹›è˜ä¿¡æ¯ã€‚<br><br><br>åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘çœ‹åˆ°çš„å¤§å¤šæ•°æ•™ç¨‹éƒ½ä¼šæ•™ï¼Œä½¿ç”¨ä»€ä¹ˆä»€ä¹ˆåº“ï¼Œå¦‚ä½•å¦‚ä½•æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼Œé€šè¿‡æ€æ ·æ€æ ·çš„æ–¹å¼å®Œæˆç½‘é¡µçš„æ¸²æŸ“ï¼Œç„¶åå¾—åˆ°é‡Œé¢çš„ä¿¡æ¯â€¦æ°¸è¿œè®°ä½ï¼Œå¯¹äºçˆ¬è™«ç¨‹åºï¼Œæ¨¡æ‹Ÿæµè§ˆå™¨å¾€å¾€æ˜¯ä¸‹ä¸‹ç­–ï¼Œåªæœ‰å®åœ¨æ²¡æœ‰åŠæ³•äº†ï¼Œæ‰å»è€ƒè™‘æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼Œå› ä¸ºé‚£æ ·çš„å†…å­˜å¼€é”€å®åœ¨æ˜¯å¾ˆå¤§ï¼Œè€Œä¸”æ•ˆç‡éå¸¸ä½ã€‚<br><br><br>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿç»éªŒæ˜¯ï¼Œè¿™æ ·çš„æƒ…å†µï¼Œå¤§å¤šæ˜¯æ˜¯æµè§ˆå™¨ä¼šåœ¨è¯·æ±‚å’Œè§£æHTMLä¹‹åï¼Œæ ¹æ®jsçš„â€œæŒ‡ç¤ºâ€å†å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œå¾—åˆ°é¡µé¢å±•ç¤ºçš„å†…å®¹ï¼Œç„¶åé€šè¿‡jsæ¸²æŸ“ä¹‹åå±•ç¤ºåˆ°ç•Œé¢ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œè¿™æ ·çš„è¯·æ±‚å¾€å¾€å¾—åˆ°çš„å†…å®¹æ˜¯jsonæ ¼å¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éä½†ä¸ä¼šåŠ é‡çˆ¬è™«çš„ä»»åŠ¡ï¼Œåè€Œå¯èƒ½ä¼šçœå»è§£æHTMLçš„åŠŸå¤«ã€‚<br><br><br>é‚£ä¸ªï¼Œç»§ç»­æ‰“å¼€Chromeçš„å¼€å‘è€…å·¥å…·ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»â€œä¸‹ä¸€é¡µâ€ä¹‹åï¼Œæµè§ˆå™¨å‘é€äº†å¦‚ä¸‹è¯·æ±‚ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585401843101-98e57df8-c124-4923-aa9f-7c42ce2288b6.png#align=left&display=inline&height=1300&originHeight=1300&originWidth=3356&size=0&status=done&style=none&width=3356" alt><br><br><br>æ³¨æ„è§‚å¯Ÿâ€positionAjax.jsonâ€è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒçš„Typeæ˜¯â€xhrâ€ï¼Œå…¨ç§°å«åšâ€XMLHttpRequestâ€ï¼ŒXMLHttpRequestå¯¹è±¡å¯ä»¥åœ¨ä¸å‘æœåŠ¡å™¨æäº¤æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ï¼Œå®ç°å±€éƒ¨æ›´æ–°ç½‘é¡µã€‚é‚£ä¹ˆï¼Œç°åœ¨å®ƒçš„å¯èƒ½æ€§æœ€å¤§äº†ï¼Œæˆ‘ä»¬å•å‡»å®ƒä¹‹åå¥½å¥½è§‚å¯Ÿè§‚å¯Ÿå§ï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585401843056-e12f0f79-905f-4420-abfd-fb85625767ac.png#align=left&display=inline&height=1150&originHeight=1150&originWidth=2266&size=0&status=done&style=none&width=2266" alt><br><br><br>ç‚¹å‡»ä¹‹åæˆ‘ä»¬åœ¨å³ä¸‹è§’å‘ç°äº†å¦‚ä¸Šè¯¦æƒ…ï¼Œå…¶ä¸­å‡ ä¸ªtabçš„å†…å®¹è¡¨ç¤ºï¼š<br>Headersï¼šè¯·æ±‚å’Œå“åº”çš„è¯¦ç»†ä¿¡æ¯<br>Previewï¼šå“åº”ä½“æ ¼å¼åŒ–ä¹‹åçš„æ˜¾ç¤º<br>Responseï¼šå“åº”ä½“åŸå§‹å†…å®¹<br>Cookiesï¼šCookies<br>Timingï¼šæ—¶é—´å¼€é”€<br><br><br>é€šè¿‡å¯¹å†…å®¹çš„è§‚å¯Ÿï¼Œè¿”å›çš„ç¡®å®æ˜¯ä¸€ä¸ªjsonå­—ç¬¦ä¸²ï¼Œå†…å®¹åŒ…æ‹¬æœ¬é¡µæ¯ä¸€ä¸ªæ‹›è˜ä¿¡æ¯ï¼Œåˆ°è¿™é‡Œè‡³å°‘æˆ‘ä»¬å·²ç»æ¸…æ¥šäº†ï¼Œç¡®å®ä¸éœ€è¦è§£æHTMLå°±å¯ä»¥æ‹¿åˆ°æ‹‰é’©æ‹›è˜çš„ä¿¡æ¯äº†ã€‚é‚£ä¹ˆï¼Œè¯·æ±‚è¯¥å¦‚ä½•æ¨¡æ‹Ÿå‘¢ï¼Ÿæˆ‘ä»¬åˆ‡æ¢åˆ°Headersè¿™ä¸€æ ï¼Œç•™æ„ä¸‰ä¸ªåœ°æ–¹ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585401842263-072689cf-5dea-4f8b-b103-0758d9c5e52e.png#align=left&display=inline&height=262&originHeight=262&originWidth=1276&size=0&status=done&style=none&width=1276" alt><br><br><br>ä¸Šé¢çš„æˆªå›¾å±•ç¤ºäº†è¿™æ¬¡è¯·æ±‚çš„è¯·æ±‚æ–¹å¼ã€è¯·æ±‚åœ°å€ç­‰ä¿¡æ¯ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585401843887-cf8bff5f-4570-4ad4-8681-f0f3eae929b3.png#align=left&display=inline&height=884&originHeight=884&originWidth=2652&size=0&status=done&style=none&width=2652" alt><br><br><br>ä¸Šé¢çš„æˆªå›¾å±•ç¤ºäº†è¿™æ¬¡è¯·æ±‚çš„è¯·æ±‚å¤´ï¼Œä¸€èˆ¬æ¥è®²ï¼Œå…¶ä¸­æˆ‘ä»¬éœ€è¦å…³æ³¨çš„æ˜¯Cookie / Host / Origin / Referer / User-Agent / X-Requested-Withç­‰å‚æ•°ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585401843009-4797a28d-3070-421e-a45c-86781d7f580d.png#align=left&display=inline&height=188&originHeight=188&originWidth=848&size=0&status=done&style=none&width=848" alt><br><br><br>ä¸Šé¢è¿™å¼ æˆªå›¾å±•ç¤ºäº†è¿™æ¬¡è¯·æ±‚çš„æäº¤æ•°æ®ï¼Œæ ¹æ®è§‚å¯Ÿï¼Œkdè¡¨ç¤ºæˆ‘ä»¬æŸ¥è¯¢çš„å…³é”®å­—ï¼Œpnè¡¨ç¤ºå½“å‰é¡µç ã€‚<br><br><br>é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„çˆ¬è™«éœ€è¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯æŒ‰ç…§é¡µç ä¸æ–­å‘è¿™ä¸ªæ¥å£å‘é€è¯·æ±‚ï¼Œå¹¶è§£æå…¶ä¸­çš„jsonå†…å®¹ï¼Œå°†æˆ‘ä»¬éœ€è¦çš„å€¼å­˜å‚¨ä¸‹æ¥å°±å¥½äº†ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼šä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œä»¥åŠå¦‚ä½•çš„åˆ°jsonä¸­æœ‰ä»·å€¼çš„å†…å®¹ã€‚<br><br><br>æˆ‘ä»¬å›è¿‡å¤´é‡æ–°è§‚å¯Ÿä¸€ä¸‹è¿”å›çš„jsonï¼Œæ ¼å¼åŒ–ä¹‹åçš„å±‚çº§å…³ç³»å¦‚ä¸‹ï¼š<br><br><br>å¾ˆå®¹æ˜“å‘ç°ï¼Œcontentä¸‹çš„hasNextPageå³ä¸ºæ˜¯å¦å­˜åœ¨ä¸‹ä¸€é¡µï¼Œè€Œcontentä¸‹çš„resultæ˜¯ä¸€ä¸ªlistï¼Œå…¶ä¸­çš„æ¯é¡¹åˆ™æ˜¯ä¸€æ¡æ‹›è˜ä¿¡æ¯ã€‚åœ¨Pythonä¸­ï¼Œjsonå­—ç¬¦ä¸²åˆ°å¯¹è±¡çš„æ˜ å°„å¯ä»¥é€šè¿‡jsonè¿™ä¸ªåº“å®Œæˆï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">json_obj = json.loads(<span class="string">"&#123;'key': 'value'&#125;"</span>)  <span class="comment"># å­—ç¬¦ä¸²åˆ°å¯¹è±¡</span></span><br><span class="line">json_str = json.dumps(json_obj)            <span class="comment"># å¯¹è±¡åˆ°å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure><p><br>jsonå­—ç¬¦ä¸²çš„â€[ ]â€œæ˜ å°„åˆ°Pythonçš„ç±»å‹æ˜¯listï¼Œâ€{ }â€æ˜ å°„åˆ°Pythonåˆ™æ˜¯dictã€‚åˆ°è¿™é‡Œï¼Œåˆ†æè¿‡ç¨‹å·²ç»å®Œå…¨ç»“æŸï¼Œå¯ä»¥æ„‰å¿«çš„å†™ä»£ç å•¦ã€‚å…·ä½“ä»£ç è¿™é‡Œä¸å†ç»™å‡ºï¼Œå¸Œæœ›ä½ å¯ä»¥è‡ªå·±ç‹¬ç«‹å®Œæˆï¼Œå¦‚æœåœ¨ç¼–å†™è¿‡ç¨‹ä¸­å­˜åœ¨é—®é¢˜ï¼Œå¯ä»¥è”ç³»æˆ‘è·å–å¸®åŠ©ã€‚<br></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;æˆ‘ä»¬çš„ç›®çš„æ˜¯æŠ“å–æ‹‰å‹¾ç½‘Pythonåˆ†ç±»ä¸‹å…¨å›½åˆ°ç›®å‰ä¸ºæ­¢å±•ç¤ºå‡ºæ¥çš„æ‰€æœ‰æ‹›è˜ä¿¡æ¯ï¼Œé¦–å…ˆåœ¨æµè§ˆå™¨ç‚¹å‡»è¿›å»çœ‹çœ‹å§ã€‚å¦‚æœä½ è¶³å¤Ÿå°å¿ƒæˆ–è€…ç½‘é€Ÿæ¯”è¾ƒæ…¢ï¼Œé‚£ä¹ˆä½ ä¼š
      
    
    </summary>
    
    
      <category term="python" scheme="cpeixin.cn/categories/python/"/>
    
    
      <category term="çˆ¬è™«" scheme="cpeixin.cn/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>SHCï¼šä½¿ç”¨ Spark SQL é«˜æ•ˆåœ°è¯»å†™ HBase</title>
    <link href="cpeixin.cn/2019/05/16/SHC%EF%BC%9A%E4%BD%BF%E7%94%A8-Spark-SQL-%E9%AB%98%E6%95%88%E5%9C%B0%E8%AF%BB%E5%86%99-HBase/"/>
    <id>cpeixin.cn/2019/05/16/SHC%EF%BC%9A%E4%BD%BF%E7%94%A8-Spark-SQL-%E9%AB%98%E6%95%88%E5%9C%B0%E8%AF%BB%E5%86%99-HBase/</id>
    <published>2019-05-16T02:27:59.000Z</published>
    <updated>2020-05-16T02:31:46.066Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><br>Apache <a href="https://www.iteblog.com/archives/tag/spark/" target="_blank" rel="external nofollow noopener noreferrer">Spark</a> å’Œ Apache <a href="https://www.iteblog.com/archives/tag/hbase/" target="_blank" rel="external nofollow noopener noreferrer">HBase</a> æ˜¯ä¸¤ä¸ªä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„å¤§æ•°æ®ç»„ä»¶ã€‚å¾ˆå¤šåœºæ™¯éœ€è¦ä½¿ç”¨ <a href="https://www.iteblog.com/archives/tag/spark/" target="_blank" rel="external nofollow noopener noreferrer">Spark</a> åˆ†æ/æŸ¥è¯¢ <a href="https://www.iteblog.com/archives/tag/hbase/" target="_blank" rel="external nofollow noopener noreferrer">HBase</a> ä¸­çš„æ•°æ®ï¼Œè€Œç›®å‰ <a href="https://www.iteblog.com/archives/tag/spark/" target="_blank" rel="external nofollow noopener noreferrer">Spark</a> å†…ç½®æ˜¯æ”¯æŒå¾ˆå¤šæ•°æ®æºçš„ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº† HBaseï¼Œä½†æ˜¯å†…ç½®çš„è¯»å–æ•°æ®æºè¿˜æ˜¯ä½¿ç”¨äº† TableInputFormat æ¥è¯»å– HBase ä¸­çš„æ•°æ®ã€‚è¿™ä¸ª TableInputFormat æœ‰ä¸€äº›ç¼ºç‚¹ï¼š</p><ul><li>ä¸€ä¸ª Task é‡Œé¢åªèƒ½å¯åŠ¨ä¸€ä¸ª Scan å» HBase ä¸­è¯»å–æ•°æ®ï¼›</li><li>TableInputFormat ä¸­ä¸æ”¯æŒ BulkGetï¼›</li><li>ä¸èƒ½äº«å—åˆ° Spark SQL å†…ç½®çš„ catalyst å¼•æ“çš„ä¼˜åŒ–ã€‚</li></ul><p><br>ä»å¦ä¸€ä¸ªæ–¹é¢æ¥è®²ï¼Œå¦‚æœå…ˆä¸è°ˆå…³äºæ€§èƒ½çš„æ–¹é¢ï¼Œé‚£ä¹ˆä½ åœ¨å†™HBaseçš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯ä¸æ˜¯æ­¥éª¤æ„Ÿè§‰å¾ˆéº»çƒ¦å‘¢ï¼ŒForeachæ¯æ¡æ•°æ®Putåˆ°HBaseä¸­ï¼Œå¾€å¾€å†™å…¥é€»è¾‘éƒ¨åˆ†çš„ä»£ç å°±è¦å†™å¾ˆé•¿å¾ˆé•¿çš„ä¸€æ®µã€‚<br><br><br>åŸºäºè¿™äº›é—®é¢˜ï¼Œæ¥è‡ª Hortonworks çš„å·¥ç¨‹å¸ˆä»¬ä¸ºæˆ‘ä»¬å¸¦æ¥äº†å…¨æ–°çš„ Apache Sparkâ€”Apache HBase Connectorï¼Œä¸‹é¢ç®€ç§° SHCã€‚é€šè¿‡è¿™ä¸ªç±»åº“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ Spark SQL å°† DataFrame ä¸­çš„æ•°æ®å†™å…¥åˆ° HBase ä¸­ï¼›è€Œä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Spark SQL å»æŸ¥è¯¢ HBase ä¸­çš„æ•°æ®ï¼Œåœ¨æŸ¥è¯¢ HBase çš„æ—¶å€™å……åˆ†åˆ©ç”¨äº† catalyst å¼•æ“åšäº†è®¸å¤šä¼˜åŒ–ï¼Œæ¯”å¦‚åˆ†åŒºä¿®å‰ªï¼ˆpartition pruningï¼‰ï¼Œåˆ—ä¿®å‰ªï¼ˆcolumn pruningï¼‰ï¼Œè°“è¯ä¸‹æ¨ï¼ˆpredicate pushdownï¼‰å’Œæ•°æ®æœ¬åœ°æ€§ï¼ˆdata localityï¼‰ç­‰ç­‰ã€‚å› ä¸ºæœ‰äº†è¿™äº›ä¼˜åŒ–ï¼Œé€šè¿‡ Spark æŸ¥è¯¢ HBase çš„é€Ÿåº¦æœ‰äº†å¾ˆå¤§çš„æå‡ã€‚<br><br><br><a href="https://github.com/hortonworks-spark/shc" target="_blank" rel="external nofollow noopener noreferrer">é¡¹ç›®åœ°å€</a><br>å…·ä½“çš„å¼•å…¥æ–¹å¼ï¼Œåœ¨ä¹‹å‰çš„Spark SQLå…¥é—¨ä¸­æœ‰å†™åˆ°<br><a name="EjSTz"></a></p><h2 id="Catalog"><a href="#Catalog" class="headerlink" title="Catalog"></a>Catalog</h2><p>å¯¹äºæ¯ä¸ªè¡¨ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…æ‹¬è¡Œé”®å’Œå…·æœ‰é¢„å®šä¹‰åˆ—æ—çš„æ•°æ®ç±»å‹çš„åˆ—ï¼Œå¹¶å®šä¹‰hbaseåˆ—ä¸è¡¨æ¨¡å¼ä¹‹é—´çš„æ˜ å°„ã€‚ç›®å½•æ˜¯ç”¨æˆ·å®šä¹‰çš„jsonæ ¼å¼ã€‚<br></p><p><a name="eXdJt"></a></p><h2 id="æ•°æ®ç±»å‹è½¬æ¢"><a href="#æ•°æ®ç±»å‹è½¬æ¢" class="headerlink" title="æ•°æ®ç±»å‹è½¬æ¢"></a>æ•°æ®ç±»å‹è½¬æ¢</h2><p>æ”¯æŒJavaåŸºæœ¬ç±»å‹ã€‚å°†æ¥ï¼Œå°†æ”¯æŒå…¶ä»–æ•°æ®ç±»å‹ï¼Œè¿™äº›æ•°æ®ç±»å‹ä¾èµ–äºç”¨æˆ·æŒ‡å®šçš„Serdesã€‚SHCæ”¯æŒä¸‰ç§å†…éƒ¨Serdesï¼šAvroï¼ŒPhoenixå’ŒPrimitiveTypeã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡åœ¨ç›®å½•ä¸­å®šä¹‰â€œ tableCoderâ€æ¥æŒ‡å®šè¦ä½¿ç”¨çš„serdeã€‚ä¸ºæ­¤ï¼Œè¯·å‚è€ƒç¤ºä¾‹å’Œå•å…ƒæµ‹è¯•ã€‚ä»¥Avroä¸ºä¾‹ã€‚ç”¨æˆ·å®šä¹‰çš„Serdeså°†è´Ÿè´£å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºAvroå¯¹è±¡ï¼Œè€Œè¿æ¥å™¨å°†è´Ÿè´£å°†Avroå¯¹è±¡è½¬æ¢ä¸ºå‚¬åŒ–å‰‚æ”¯æŒçš„æ•°æ®ç±»å‹ã€‚ç”¨æˆ·å®šä¹‰æ–°Serdeæ—¶ï¼Œéœ€è¦ä½¿å…¶â€œå®ç°â€ç‰¹å¾â€™SHCDataTypeâ€™ã€‚<br><br><br>è¯·æ³¨æ„ï¼Œå¦‚æœç”¨æˆ·å¸Œæœ›DataFrameä»…å¤„ç†å­—èŠ‚æ•°ç»„ï¼Œåˆ™å¯ä»¥æŒ‡å®šäºŒè¿›åˆ¶ç±»å‹ã€‚ç„¶åï¼Œç”¨æˆ·å¯ä»¥è·å¾—æ¯ä¸ªåˆ—ä¸ºå­—èŠ‚æ•°ç»„çš„å‚¬åŒ–å‰‚è¡Œã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨å®šåˆ¶çš„è§£ä¸²å™¨è¿›ä¸€æ­¥å¯¹å®ƒè¿›è¡Œååºåˆ—åŒ–ï¼Œæˆ–è€…ç›´æ¥åœ¨DataFrameçš„RDDä¸Šè¿›è¡Œæ“ä½œã€‚<br></p><p><a name="j3Svo"></a></p><h2 id="æ•°æ®å±€éƒ¨æ€§"><a href="#æ•°æ®å±€éƒ¨æ€§" class="headerlink" title="æ•°æ®å±€éƒ¨æ€§"></a>æ•°æ®å±€éƒ¨æ€§</h2><p>å½“Spark WorkerèŠ‚ç‚¹ä¸hbaseåŒºåŸŸæœåŠ¡å™¨ä½äºåŒä¸€ä½ç½®æ—¶ï¼Œé€šè¿‡æ ‡è¯†åŒºåŸŸæœåŠ¡å™¨ä½ç½®å¹¶å°†æ‰§è¡Œç¨‹åºä¸åŒºåŸŸæœåŠ¡å™¨ä¸€èµ·å®šä½æ¥å®ç°æ•°æ®å±€éƒ¨æ€§ã€‚æ¯ä¸ªæ‰§è¡Œç¨‹åºå°†ä»…å¯¹ä½äºåŒä¸€ä¸»æœºä¸Šçš„åŒä¸€éƒ¨åˆ†æ•°æ®æ‰§è¡ŒScan / BulkGetã€‚<br></p><p><a name="TccVy"></a></p><h2 id="è°“è¯ä¸‹æ¨"><a href="#è°“è¯ä¸‹æ¨" class="headerlink" title="è°“è¯ä¸‹æ¨"></a>è°“è¯ä¸‹æ¨</h2><p>è¯¥åº“ä½¿ç”¨HBaseæä¾›çš„ç°æœ‰æ ‡å‡†HBaseè¿‡æ»¤å™¨ï¼Œå¹¶ä¸”ä¸èƒ½åœ¨åå¤„ç†å™¨ä¸Šè¿è¡Œã€‚<br></p><p><a name="eEPLD"></a></p><h2 id="åˆ†åŒºä¿®å‰ª"><a href="#åˆ†åŒºä¿®å‰ª" class="headerlink" title="åˆ†åŒºä¿®å‰ª"></a>åˆ†åŒºä¿®å‰ª</h2><p>é€šè¿‡ä»è°“è¯ä¸­æå–è¡Œé”®ï¼Œæˆ‘ä»¬å°†scan / BulkGetåˆ’åˆ†ä¸ºå¤šä¸ªéé‡å åŒºåŸŸï¼Œåªæœ‰å…·æœ‰è¯·æ±‚æ•°æ®çš„åŒºåŸŸæœåŠ¡å™¨æ‰ä¼šæ‰§è¡Œscan / BulkGetã€‚å½“å‰ï¼Œåˆ†åŒºä¿®å‰ªæ˜¯åœ¨è¡Œé”®çš„ç¬¬ä¸€ç»´ä¸Šæ‰§è¡Œçš„ã€‚è¯·æ³¨æ„ï¼Œéœ€è¦ä»”ç»†å®šä¹‰WHEREæ¡ä»¶ã€‚å¦åˆ™ï¼Œç»“æœæ‰«æå¯èƒ½ä¼šåŒ…å«ä¸€ä¸ªæ¯”ç”¨æˆ·é¢„æœŸå¤§çš„åŒºåŸŸã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹æ¡ä»¶å°†å¯¼è‡´å®Œå…¨æ‰«æï¼ˆrowkey1æ˜¯è¡Œé”®çš„ç¬¬ä¸€ç»´ï¼Œè€Œcolumnæ˜¯å¸¸è§„çš„hbaseåˆ—ï¼‰ã€‚å…¶ä¸­rowkey1&gt;â€œ abcâ€ ORåˆ—=â€œ xyzâ€<br></p><p><a name="lDJh4"></a></p><h2 id="æ‰«æå’Œæ‰¹é‡è·å–"><a href="#æ‰«æå’Œæ‰¹é‡è·å–" class="headerlink" title="æ‰«æå’Œæ‰¹é‡è·å–"></a>æ‰«æå’Œæ‰¹é‡è·å–</h2><p>éƒ½é€šè¿‡æŒ‡å®šWHEREå­å¥å‘ç”¨æˆ·å…¬å¼€ï¼Œä¾‹å¦‚ï¼Œå…¶ä¸­column&gt; xå’Œcolumn &lt;yç”¨äºæ‰«æï¼Œè€Œcolumn = xç”¨äºgetã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨æ‰§è¡Œç¨‹åºä¸­æ‰§è¡Œï¼Œè€Œé©±åŠ¨ç¨‹åºä»…æ„é€ è¿™äº›æ“ä½œã€‚åœ¨å†…éƒ¨ï¼Œæˆ‘ä»¬å°†å®ƒä»¬è½¬æ¢ä¸ºæ‰«ææˆ–è·å–æˆ–ä¸¤è€…ç»“åˆï¼Œä»è€Œå°†Iterator [Row]è¿”å›è‡³å‚¬åŒ–å‰‚å¼•æ“ã€‚<br></p><p><a name="P0Sof"></a></p><h2 id="å¯åˆ›å»ºçš„æ•°æ®æº"><a href="#å¯åˆ›å»ºçš„æ•°æ®æº" class="headerlink" title="å¯åˆ›å»ºçš„æ•°æ®æº"></a>å¯åˆ›å»ºçš„æ•°æ®æº</h2><p>è¯¥åº“æ”¯æŒä»HBaseè¯»å–/å‘HBaseå†™å…¥ã€‚<br><a name="qW63X"></a></p><h2 id="åº”ç”¨ç”¨é€”"><a href="#åº”ç”¨ç”¨é€”" class="headerlink" title="åº”ç”¨ç”¨é€”"></a>åº”ç”¨ç”¨é€”</h2><p>ä¸‹é¢è¯´æ˜äº†å¦‚ä½•ä½¿ç”¨è¿æ¥å™¨çš„åŸºæœ¬æ­¥éª¤ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œé«˜çº§ç”¨ä¾‹ï¼ˆä¾‹å¦‚Avroå’Œå¤åˆé”®æ”¯æŒï¼‰ï¼Œè¯·å‚è€ƒå­˜å‚¨åº“ä¸­çš„ç¤ºä¾‹ã€‚<br><a name="DjKzs"></a></p><h3 id="å®šä¹‰äº†HBaseç›®å½•"><a href="#å®šä¹‰äº†HBaseç›®å½•" class="headerlink" title="å®šä¹‰äº†HBaseç›®å½•"></a>å®šä¹‰äº†HBaseç›®å½•</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">catalog</span> </span>= <span class="string">s""</span><span class="string">"&#123;</span></span><br><span class="line"><span class="string">        |"</span><span class="string">table":&#123;"</span><span class="string">namespace":"</span><span class="string">default", "</span><span class="string">name":"</span>table1<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">        |"</span><span class="string">rowkey":"</span><span class="string">key",</span></span><br><span class="line"><span class="string">        |"</span><span class="string">columns":&#123;</span></span><br><span class="line"><span class="string">          |"</span>col0<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span><span class="string">key", "</span><span class="string">type":"</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col1<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col1<span class="string">", "</span><span class="string">type":"</span><span class="string">boolean"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col2<span class="string">":&#123;"</span><span class="string">cf":"</span>cf2<span class="string">", "</span><span class="string">col":"</span>col2<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col3<span class="string">":&#123;"</span><span class="string">cf":"</span>cf3<span class="string">", "</span><span class="string">col":"</span>col3<span class="string">", "</span><span class="string">type":"</span><span class="string">float"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col4<span class="string">":&#123;"</span><span class="string">cf":"</span>cf4<span class="string">", "</span><span class="string">col":"</span>col4<span class="string">", "</span><span class="string">type":"</span><span class="string">int"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col5<span class="string">":&#123;"</span><span class="string">cf":"</span>cf5<span class="string">", "</span><span class="string">col":"</span>col5<span class="string">", "</span><span class="string">type":"</span><span class="string">bigint"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col6<span class="string">":&#123;"</span><span class="string">cf":"</span>cf6<span class="string">", "</span><span class="string">col":"</span>col6<span class="string">", "</span><span class="string">type":"</span><span class="string">smallint"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col7<span class="string">":&#123;"</span><span class="string">cf":"</span>cf7<span class="string">", "</span><span class="string">col":"</span>col7<span class="string">", "</span><span class="string">type":"</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col8<span class="string">":&#123;"</span><span class="string">cf":"</span>cf8<span class="string">", "</span><span class="string">col":"</span>col8<span class="string">", "</span><span class="string">type":"</span><span class="string">tinyint"&#125;</span></span><br><span class="line"><span class="string">        |&#125;</span></span><br><span class="line"><span class="string">      |&#125;"</span><span class="string">""</span>.stripMargin</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªåç§°ä¸ºtable1ï¼Œè¡Œé”®ä¸ºé”®ï¼Œåˆ—æ•°ä¸ºï¼ˆcol1-col8ï¼‰çš„HBaseè¡¨çš„æ¶æ„ã€‚è¯·æ³¨æ„ï¼Œè¡Œé”®è¿˜å¿…é¡»è¯¦ç»†å®šä¹‰ä¸ºå…·æœ‰ç‰¹å®šcfï¼ˆè¡Œé”®ï¼‰çš„åˆ—ï¼ˆcol0ï¼‰ã€‚<br></p><p><a name="xic7k"></a></p><h3 id="å†™å…¥HBaseè¡¨ä»¥å¡«å……æ•°æ®"><a href="#å†™å…¥HBaseè¡¨ä»¥å¡«å……æ•°æ®" class="headerlink" title="å†™å…¥HBaseè¡¨ä»¥å¡«å……æ•°æ®"></a>å†™å…¥HBaseè¡¨ä»¥å¡«å……æ•°æ®</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize(data).toDF.write.options(</span><br><span class="line">  <span class="type">Map</span>(<span class="type">HBaseTableCatalog</span>.tableCatalog -&gt; catalog, <span class="type">HBaseTableCatalog</span>.newTable -&gt; <span class="string">"5"</span>))</span><br><span class="line">  .format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>)</span><br><span class="line">  .save()</span><br></pre></td></tr></table></figure><p>ç»™å®šå…·æœ‰æŒ‡å®šæ¶æ„çš„DataFrameï¼Œä¸Šé¢å°†åˆ›å»ºä¸€ä¸ªå…·æœ‰5ä¸ªåŒºåŸŸçš„HBaseè¡¨å¹¶å°†è¯¥DataFrameä¿å­˜åœ¨å…¶ä¸­ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæœªæŒ‡å®šHBaseTableCatalog.newTableï¼Œåˆ™å¿…é¡»é¢„å…ˆåˆ›å»ºè¡¨ã€‚<br></p><p><a name="wSV5W"></a></p><h3 id="åœ¨HBaseè¡¨çš„é¡¶éƒ¨æ‰§è¡ŒDataFrameæ“ä½œ"><a href="#åœ¨HBaseè¡¨çš„é¡¶éƒ¨æ‰§è¡ŒDataFrameæ“ä½œ" class="headerlink" title="åœ¨HBaseè¡¨çš„é¡¶éƒ¨æ‰§è¡ŒDataFrameæ“ä½œ"></a>åœ¨HBaseè¡¨çš„é¡¶éƒ¨æ‰§è¡ŒDataFrameæ“ä½œ</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">withCatalog</span></span>(cat: <span class="type">String</span>): <span class="type">DataFrame</span> = &#123;</span><br><span class="line">  sqlContext</span><br><span class="line">  .read</span><br><span class="line">  .options(<span class="type">Map</span>(<span class="type">HBaseTableCatalog</span>.tableCatalog-&gt;cat))</span><br><span class="line">  .format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>)</span><br><span class="line">  .load()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="yQeDt"></a></p><h3 id="å¤æ‚æŸ¥è¯¢"><a href="#å¤æ‚æŸ¥è¯¢" class="headerlink" title="å¤æ‚æŸ¥è¯¢"></a>å¤æ‚æŸ¥è¯¢</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> df = withCatalog(catalog)</span><br><span class="line"><span class="keyword">val</span> s = df.filter((($<span class="string">"col0"</span> &lt;= <span class="string">"row050"</span> &amp;&amp; $<span class="string">"col0"</span> &gt; <span class="string">"row040"</span>) ||</span><br><span class="line">  $<span class="string">"col0"</span> === <span class="string">"row005"</span> ||</span><br><span class="line">  $<span class="string">"col0"</span> === <span class="string">"row020"</span> ||</span><br><span class="line">  $<span class="string">"col0"</span> ===  <span class="string">"r20"</span> ||</span><br><span class="line">  $<span class="string">"col0"</span> &lt;= <span class="string">"row005"</span>) &amp;&amp;</span><br><span class="line">  ($<span class="string">"col4"</span> === <span class="number">1</span> ||</span><br><span class="line">  $<span class="string">"col4"</span> === <span class="number">42</span>))</span><br><span class="line">  .select(<span class="string">"col0"</span>, <span class="string">"col1"</span>, <span class="string">"col4"</span>)</span><br><span class="line">s.show</span><br></pre></td></tr></table></figure><p><a name="mKwKp"></a></p><h3><a href="#" class="headerlink"></a></h3><p><a name="szhEb"></a></p><h3 id="SQLæ”¯æŒ"><a href="#SQLæ”¯æŒ" class="headerlink" title="SQLæ”¯æŒ"></a>SQLæ”¯æŒ</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Load the dataframe</span></span><br><span class="line"><span class="keyword">val</span> df = withCatalog(catalog)</span><br><span class="line"><span class="comment">//SQL example</span></span><br><span class="line">df.createOrReplaceTempView(<span class="string">"table"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select count(col1) from table"</span>).show</span><br></pre></td></tr></table></figure><br><a name="raaVM"></a> ## æ”¯æŒAvroæ¨¡å¼ è¯¥è¿æ¥å™¨å®Œå…¨æ”¯æŒæ‰€æœ‰avroæ¨¡å¼ã€‚ç”¨æˆ·å¯ä»¥åœ¨å…¶ç›®å½•ä¸­ä½¿ç”¨å®Œæ•´è®°å½•æ¨¡å¼æˆ–éƒ¨åˆ†å­—æ®µæ¨¡å¼ä½œä¸ºæ•°æ®ç±»å‹ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[æ­¤å¤„](https://github.com/hortonworks-spark/shc/wiki/2.-Native-Avro-Support)ï¼‰ã€‚<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> schema_array = <span class="string">s""</span><span class="string">"&#123;"</span><span class="string">type": "</span><span class="string">array", "</span><span class="string">items": ["</span><span class="string">string","</span><span class="string">null"]&#125;"</span><span class="string">""</span>.stripMargin</span><br><span class="line"><span class="keyword">val</span> schema_record =</span><br><span class="line">  <span class="string">s""</span><span class="string">"&#123;"</span><span class="string">namespace": "</span>example.<span class="string">avro",</span></span><br><span class="line"><span class="string">     |   "</span><span class="string">type": "</span><span class="string">record",      "</span><span class="string">name": "</span><span class="type">User</span><span class="string">",</span></span><br><span class="line"><span class="string">     |    "</span><span class="string">fields": [      &#123;"</span><span class="string">name": "</span><span class="string">name", "</span><span class="string">type": "</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">     |      &#123;"</span><span class="string">name": "</span>favorite_<span class="string">number",  "</span><span class="string">type": ["</span><span class="string">int", "</span><span class="string">null"]&#125;,</span></span><br><span class="line"><span class="string">     |        &#123;"</span><span class="string">name": "</span>favorite_<span class="string">color", "</span><span class="string">type": ["</span><span class="string">string", "</span><span class="string">null"]&#125;      ]    &#125;"</span><span class="string">""</span>.stripMargin</span><br><span class="line"><span class="keyword">val</span> catalog = <span class="string">s""</span><span class="string">"&#123;</span></span><br><span class="line"><span class="string">        |"</span><span class="string">table":&#123;"</span><span class="string">namespace":"</span><span class="string">default", "</span><span class="string">name":"</span><span class="string">htable"&#125;,</span></span><br><span class="line"><span class="string">        |"</span><span class="string">rowkey":"</span>key1<span class="string">",</span></span><br><span class="line"><span class="string">        |"</span><span class="string">columns":&#123;</span></span><br><span class="line"><span class="string">          |"</span>col1<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span>key1<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col2<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col1<span class="string">", "</span><span class="string">avro":"</span>schema_<span class="string">array"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col3<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col2<span class="string">", "</span><span class="string">avro":"</span>schema_<span class="string">record"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col4<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col3<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col5<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col4<span class="string">", "</span><span class="string">type":"</span><span class="string">string"&#125;</span></span><br><span class="line"><span class="string">        |&#125;</span></span><br><span class="line"><span class="string">      |&#125;"</span><span class="string">""</span>.stripMargin</span><br><span class="line"> <span class="keyword">val</span> df = sqlContext.read.options(<span class="type">Map</span>(<span class="string">"schema_array"</span>-&gt;schema_array,<span class="string">"schema_record"</span>-&gt;schema_record, <span class="type">HBaseTableCatalog</span>.tableCatalog-&gt;catalog)).format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>).load()</span><br><span class="line">df.write.options(<span class="type">Map</span>(<span class="string">"schema_array"</span>-&gt;schema_array,<span class="string">"schema_record"</span>-&gt;schema_record, <span class="type">HBaseTableCatalog</span>.tableCatalog-&gt;catalog)).format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>).save()</span><br></pre></td></tr></table></figure><a name="LqW7H"></a> ####<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> complex = <span class="string">s""</span><span class="string">"MAP&lt;int, struct&lt;varchar:string&gt;&gt;"</span><span class="string">""</span></span><br><span class="line"><span class="keyword">val</span> schema =</span><br><span class="line">  <span class="string">s""</span><span class="string">"&#123;"</span><span class="string">namespace": "</span>example.<span class="string">avro",</span></span><br><span class="line"><span class="string">     |   "</span><span class="string">type": "</span><span class="string">record",      "</span><span class="string">name": "</span><span class="type">User</span><span class="string">",</span></span><br><span class="line"><span class="string">     |    "</span><span class="string">fields": [      &#123;"</span><span class="string">name": "</span><span class="string">name", "</span><span class="string">type": "</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">     |      &#123;"</span><span class="string">name": "</span>favorite_<span class="string">number",  "</span><span class="string">type": ["</span><span class="string">int", "</span><span class="string">null"]&#125;,</span></span><br><span class="line"><span class="string">     |        &#123;"</span><span class="string">name": "</span>favorite_<span class="string">color", "</span><span class="string">type": ["</span><span class="string">string", "</span><span class="string">null"]&#125;      ]    &#125;"</span><span class="string">""</span>.stripMargin</span><br><span class="line"><span class="keyword">val</span> catalog = <span class="string">s""</span><span class="string">"&#123;</span></span><br><span class="line"><span class="string">        |"</span><span class="string">table":&#123;"</span><span class="string">namespace":"</span><span class="string">default", "</span><span class="string">name":"</span><span class="string">htable"&#125;,</span></span><br><span class="line"><span class="string">        |"</span><span class="string">rowkey":"</span>key1:key2<span class="string">",</span></span><br><span class="line"><span class="string">        |"</span><span class="string">columns":&#123;</span></span><br><span class="line"><span class="string">          |"</span>col1<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span>key1<span class="string">", "</span><span class="string">type":"</span><span class="string">binary"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col2<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span>key2<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col3<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col1<span class="string">", "</span><span class="string">avro":"</span>schema1<span class="string">"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col4<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col2<span class="string">", "</span><span class="string">type":"</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col5<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col3<span class="string">", "</span><span class="string">type":"</span><span class="string">double",        "</span><span class="string">sedes":"</span>org.apache.spark.sql.execution.datasources.hbase.<span class="type">DoubleSedes</span><span class="string">"&#125;,</span></span><br><span class="line"><span class="string">          |"</span>col6<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col4<span class="string">", "</span><span class="string">type":"</span>$<span class="string">complex"&#125;</span></span><br><span class="line"><span class="string">        |&#125;</span></span><br><span class="line"><span class="string">      |&#125;"</span><span class="string">""</span>.stripMargin</span><br><span class="line">   </span><br><span class="line"><span class="keyword">val</span> df = sqlContext.read.options(<span class="type">Map</span>(<span class="string">"schema1"</span>-&gt;schema, <span class="type">HBaseTableCatalog</span>.tableCatalog-&gt;catalog)).format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>).load()</span><br><span class="line">df.write.options(<span class="type">Map</span>(<span class="string">"schema1"</span>-&gt;schema, <span class="type">HBaseTableCatalog</span>.tableCatalog-&gt;catalog)).format(<span class="string">"org.apache.spark.sql.execution.datasources.hbase"</span>).save()</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè¯´æ˜äº†æˆ‘ä»¬çš„ä¸‹ä¸€æ­¥ï¼Œå…¶ä¸­åŒ…æ‹¬å¤åˆé”®æ”¯æŒï¼Œå¤æ‚æ•°æ®ç±»å‹ï¼Œå®¢æˆ·åŒ–Serdeå’ŒAvroçš„æ”¯æŒã€‚è¯·æ³¨æ„ï¼Œå°½ç®¡æ‰€æœ‰ä¸»è¦éƒ¨åˆ†éƒ½åŒ…å«åœ¨å½“å‰ä»£ç åº“ä¸­ï¼Œä½†ç°åœ¨å¯èƒ½æ— æ³•è¿è¡Œã€‚<br><br><br></p><p><a name="XtWKn"></a></p><h2 id="SHCæŸ¥è¯¢ä¼˜åŒ–"><a href="#SHCæŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="SHCæŸ¥è¯¢ä¼˜åŒ–"></a>SHCæŸ¥è¯¢ä¼˜åŒ–</h2><p><br>SHC ä¸»è¦ä½¿ç”¨ä¸‹é¢çš„å‡ ç§ä¼˜åŒ–ï¼Œä½¿å¾— Spark è·å– HBase çš„æ•°æ®æ‰«æèŒƒå›´å¾—åˆ°å‡å°‘ï¼Œæé«˜äº†æ•°æ®è¯»å–çš„æ•ˆç‡ã€‚<br><strong><br></strong>å°†ä½¿ç”¨ Rowkey çš„æŸ¥è¯¢è½¬æ¢æˆ get æŸ¥è¯¢**<br>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒHBase ä¸­ä½¿ç”¨ Get æŸ¥è¯¢çš„æ•ˆç‡æ˜¯éå¸¸é«˜çš„ï¼Œæ‰€ä»¥å¦‚æœæŸ¥è¯¢çš„è¿‡æ»¤æ¡ä»¶æ˜¯é’ˆå¯¹ RowKey è¿›è¡Œçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å®ƒè½¬æ¢æˆ Get æŸ¥è¯¢ã€‚ä¸ºäº†è¯´æ˜è¿™ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä¾‹å­è¿›è¡Œè¯´æ˜ã€‚å‡è®¾æˆ‘ä»¬å®šä¹‰å¥½çš„ HBase catalog å¦‚ä¸‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> catalog = <span class="string">s""</span><span class="string">"&#123;</span></span><br><span class="line"><span class="string">  |"</span><span class="string">table":&#123;"</span><span class="string">namespace":"</span><span class="string">default", "</span><span class="string">name":"</span><span class="string">iteblog", "</span>tableC<span class="string">oder":"</span><span class="type">PrimitiveType</span><span class="string">"&#125;,</span></span><br><span class="line"><span class="string">  |"</span><span class="string">rowkey":"</span><span class="string">key",</span></span><br><span class="line"><span class="string">  |"</span><span class="string">columns":&#123;</span></span><br><span class="line"><span class="string">    |"</span>col0<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span><span class="string">id", "</span><span class="string">type":"</span><span class="string">int"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col1<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col1<span class="string">", "</span><span class="string">type":"</span><span class="string">boolean"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col2<span class="string">":&#123;"</span><span class="string">cf":"</span>cf2<span class="string">", "</span><span class="string">col":"</span>col2<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col3<span class="string">":&#123;"</span><span class="string">cf":"</span>cf3<span class="string">", "</span><span class="string">col":"</span>col3<span class="string">", "</span><span class="string">type":"</span><span class="string">float"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col4<span class="string">":&#123;"</span><span class="string">cf":"</span>cf4<span class="string">", "</span><span class="string">col":"</span>col4<span class="string">", "</span><span class="string">type":"</span><span class="string">int"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col5<span class="string">":&#123;"</span><span class="string">cf":"</span>cf5<span class="string">", "</span><span class="string">col":"</span>col5<span class="string">", "</span><span class="string">type":"</span><span class="string">bigint"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col6<span class="string">":&#123;"</span><span class="string">cf":"</span>cf6<span class="string">", "</span><span class="string">col":"</span>col6<span class="string">", "</span><span class="string">type":"</span><span class="string">smallint"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col7<span class="string">":&#123;"</span><span class="string">cf":"</span>cf7<span class="string">", "</span><span class="string">col":"</span>col7<span class="string">", "</span><span class="string">type":"</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">    |"</span>col8<span class="string">":&#123;"</span><span class="string">cf":"</span>cf8<span class="string">", "</span><span class="string">col":"</span>col8<span class="string">", "</span><span class="string">type":"</span><span class="string">tinyint"&#125;</span></span><br><span class="line"><span class="string">  |&#125;</span></span><br><span class="line"><span class="string">|&#125;"</span><span class="string">""</span>.stripMargin</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚æœæœ‰ç±»ä¼¼ä¸‹é¢çš„æŸ¥è¯¢</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> df = withCatalog(catalog)</span><br><span class="line">df.createOrReplaceTempView(<span class="string">"iteblog_table"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select * from iteblog_table where id = 1"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select * from iteblog_table where id = 1 or id = 2"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select * from iteblog_table where id in (1, 2)"</span>)</span><br></pre></td></tr></table></figure><p>å› ä¸ºæŸ¥è¯¢æ¡ä»¶ç›´æ¥æ˜¯é’ˆå¯¹ RowKey è¿›è¡Œçš„ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µç›´æ¥å¯ä»¥è½¬æ¢æˆ Get æˆ–è€… BulkGet è¯·æ±‚çš„ã€‚ç¬¬ä¸€ä¸ª SQL æŸ¥è¯¢è¿‡ç¨‹ç±»ä¼¼äºä¸‹é¢è¿‡ç¨‹<br><a href="https://www.iteblog.com/pic/hbase/shc_get-iteblog.png" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1589595330346-3b5f02d0-85b1-4e32-98d8-7d65433517d4.png#align=left&display=inline&height=409&margin=%5Bobject%20Object%5D&originHeight=409&originWidth=1032&size=0&status=done&style=none&width=1032" alt></a><br><br><br>ä½†æ˜¯ï¼Œå¦‚æœç¢°åˆ°é RowKey çš„è¿‡æ»¤ï¼Œé‚£ä¹ˆè¿™ç§æŸ¥è¯¢æ˜¯éœ€è¦æ‰«æ HBase çš„å…¨è¡¨çš„ã€‚ä¸Šé¢çš„æŸ¥è¯¢åœ¨ shc é‡Œé¢å°±æ˜¯å°† HBase é‡Œé¢çš„æ‰€æœ‰æ•°æ®æ‹¿åˆ°ï¼Œç„¶å<strong>ä¼ è¾“åˆ° Spark ï¼Œå†é€šè¿‡ Spark é‡Œé¢è¿›è¡Œè¿‡æ»¤</strong>ï¼Œå¯è§ shc åœ¨è¿™ç§æƒ…å†µä¸‹æ•ˆç‡æ˜¯å¾ˆä½ä¸‹çš„ã€‚<br><br><br>æ³¨æ„ï¼Œä¸Šé¢çš„æŸ¥è¯¢åœ¨ shc è¿”å›çš„ç»“æœæ˜¯é”™è¯¯çš„ã€‚å…·ä½“åŸå› æ˜¯åœ¨å°† id = 1 or col7 = â€˜xxxâ€™ æŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆå¹¶æ—¶ï¼Œä¸¢å¼ƒäº†æ‰€æœ‰çš„æŸ¥æ‰¾æ¡ä»¶ï¼Œç›¸å½“äºè¿”å›è¡¨çš„æ‰€æœ‰æ•°æ®ã€‚å®šä½åˆ°ä»£ç å¯ä»¥å‚è§ä¸‹é¢çš„</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or</span></span>[<span class="type">T</span>](left: <span class="type">HRF</span>[<span class="type">T</span>],</span><br><span class="line">            right: <span class="type">HRF</span>[<span class="type">T</span>])(<span class="keyword">implicit</span> ordering: <span class="type">Ordering</span>[<span class="type">T</span>]): <span class="type">HRF</span>[<span class="type">T</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> ranges = <span class="type">ScanRange</span>.or(left.ranges, right.ranges)</span><br><span class="line">    <span class="keyword">val</span> typeFilter = <span class="type">TypedFilter</span>.or(left.tf, right.tf)</span><br><span class="line">    <span class="type">HRF</span>(ranges, typeFilter, left.handled &amp;&amp; right.handled)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒç†ï¼Œç±»ä¼¼äºä¸‹é¢çš„æŸ¥è¯¢åœ¨ shc é‡Œé¢å…¶å®éƒ½æ˜¯å…¨è¡¨æ‰«æï¼Œå¹¶ä¸”å°†æ‰€æœ‰çš„æ•°æ®è¿”å›åˆ° Spark å±‚é¢ä¸Šå†è¿›è¡Œä¸€æ¬¡è¿‡æ»¤ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlContext.sql(<span class="string">"select id, col6, col8 from iteblog_table where id = 1 or col7 &lt;= 'xxx'"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select id, col6, col8 from iteblog_table where id = 1 or col7 &gt;= 'xxx'"</span>)</span><br><span class="line">sqlContext.sql(<span class="string">"select id, col6, col8 from iteblog_table where col7 = 'xxx'"</span>)</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ç§æ–¹å¼æŸ¥è¯¢æ•ˆç‡å¹¶ä¸é«˜ï¼Œä¸€ç§å¯è¡Œçš„æ–¹æ¡ˆæ˜¯å°†ç®—å­ä¸‹æ¨åˆ° HBase å±‚é¢ï¼Œåœ¨ HBase å±‚é¢é€šè¿‡ SingleColumnValueFilter è¿‡æ»¤ä¸€éƒ¨åˆ†æ•°æ®ï¼Œç„¶åå†è¿”å›åˆ° Sparkï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå¾ˆå¤šæ•°æ®çš„ä¼ è¾“ã€‚<br></p><p><a name="RHA0U"></a></p><h2 id="ç»„åˆ-RowKey-çš„æŸ¥è¯¢ä¼˜åŒ–"><a href="#ç»„åˆ-RowKey-çš„æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="ç»„åˆ RowKey çš„æŸ¥è¯¢ä¼˜åŒ–"></a>ç»„åˆ RowKey çš„æŸ¥è¯¢ä¼˜åŒ–</h2><p><br>shc è¿˜æ”¯æŒç»„åˆ RowKey çš„æ–¹å¼æ¥å»ºè¡¨ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cat</span> </span>=</span><br><span class="line">  <span class="string">s""</span><span class="string">"&#123;</span></span><br><span class="line"><span class="string">     |"</span><span class="string">table":&#123;"</span><span class="string">namespace":"</span><span class="string">default", "</span><span class="string">name":"</span><span class="string">iteblog", "</span>tableC<span class="string">oder":"</span><span class="type">PrimitiveType</span><span class="string">"&#125;,</span></span><br><span class="line"><span class="string">     |"</span><span class="string">rowkey":"</span>key1:key2<span class="string">",</span></span><br><span class="line"><span class="string">     |"</span><span class="string">columns":&#123;</span></span><br><span class="line"><span class="string">     |"</span>col00<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span>key1<span class="string">", "</span><span class="string">type":"</span><span class="string">string", "</span><span class="string">length":"</span><span class="number">6</span><span class="string">"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col01<span class="string">":&#123;"</span><span class="string">cf":"</span><span class="string">rowkey", "</span><span class="string">col":"</span>key2<span class="string">", "</span><span class="string">type":"</span><span class="string">int"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col1<span class="string">":&#123;"</span><span class="string">cf":"</span>cf1<span class="string">", "</span><span class="string">col":"</span>col1<span class="string">", "</span><span class="string">type":"</span><span class="string">boolean"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col2<span class="string">":&#123;"</span><span class="string">cf":"</span>cf2<span class="string">", "</span><span class="string">col":"</span>col2<span class="string">", "</span><span class="string">type":"</span><span class="string">double"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col3<span class="string">":&#123;"</span><span class="string">cf":"</span>cf3<span class="string">", "</span><span class="string">col":"</span>col3<span class="string">", "</span><span class="string">type":"</span><span class="string">float"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col4<span class="string">":&#123;"</span><span class="string">cf":"</span>cf4<span class="string">", "</span><span class="string">col":"</span>col4<span class="string">", "</span><span class="string">type":"</span><span class="string">int"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col5<span class="string">":&#123;"</span><span class="string">cf":"</span>cf5<span class="string">", "</span><span class="string">col":"</span>col5<span class="string">", "</span><span class="string">type":"</span><span class="string">bigint"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col6<span class="string">":&#123;"</span><span class="string">cf":"</span>cf6<span class="string">", "</span><span class="string">col":"</span>col6<span class="string">", "</span><span class="string">type":"</span><span class="string">smallint"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col7<span class="string">":&#123;"</span><span class="string">cf":"</span>cf7<span class="string">", "</span><span class="string">col":"</span>col7<span class="string">", "</span><span class="string">type":"</span><span class="string">string"&#125;,</span></span><br><span class="line"><span class="string">     |"</span>col8<span class="string">":&#123;"</span><span class="string">cf":"</span>cf8<span class="string">", "</span><span class="string">col":"</span>col8<span class="string">", "</span><span class="string">type":"</span><span class="string">tinyint"&#125;</span></span><br><span class="line"><span class="string">     |&#125;</span></span><br><span class="line"><span class="string">     |&#125;"</span><span class="string">""</span>.stripMargin</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ col00 å’Œ col01 ä¸¤åˆ—ç»„åˆæˆä¸€ä¸ª rowkeyï¼Œå¹¶ä¸” col00 æ’åœ¨å‰é¢ï¼Œcol01 æ’åœ¨åé¢ã€‚æ¯”å¦‚ col00 =â€™row002â€™ï¼Œcol01 = 2ï¼Œé‚£ä¹ˆç»„åˆçš„ rowkey ä¸º row002\x00\x00\x00\x02ã€‚é‚£ä¹ˆåœ¨ç»„åˆ Rowkey çš„æŸ¥è¯¢ shc éƒ½æœ‰å“ªäº›ä¼˜åŒ–å‘¢ï¼Ÿç°åœ¨æˆ‘ä»¬æœ‰å¦‚ä¸‹æŸ¥è¯¢</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sqlContext.sql(<span class="string">"select col00, col01, col1 from iteblog where col00 = 'row000' and col01 = 0"</span>).show()</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„ä¿¡æ¯ï¼ŒRowKey å…¶å®æ˜¯ç”± col00 å’Œ col01 ç»„åˆè€Œæˆçš„ï¼Œé‚£ä¹ˆä¸Šé¢çš„æŸ¥è¯¢å…¶å®å¯ä»¥å°† col00 å’Œ col01 è¿›è¡Œæ‹¼æ¥ï¼Œç„¶åç»„åˆæˆä¸€ä¸ª RowKeyï¼Œç„¶åä¸Šé¢çš„æŸ¥è¯¢å…¶å®å¯ä»¥è½¬æ¢æˆä¸€ä¸ª Get æŸ¥è¯¢ã€‚ä½†æ˜¯åœ¨ shc é‡Œé¢ï¼Œä¸Šé¢çš„æŸ¥è¯¢æ˜¯è½¬æ¢æˆä¸€ä¸ª scan å’Œä¸€ä¸ª get æŸ¥è¯¢çš„ã€‚scan çš„ startRow ä¸º row000ï¼ŒendRow ä¸º row000\xff\xff\xff\xffï¼›get çš„ rowkey ä¸º row000\xff\xff\xff\xffï¼Œç„¶åå†å°†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¿”å›ï¼Œæœ€åå†åœ¨ Spark å±‚é¢ä¸Šåšä¸€æ¬¡è¿‡æ»¤ï¼Œå¾—åˆ°æœ€åæŸ¥è¯¢çš„ç»“æœã€‚å› ä¸º shc é‡Œé¢ç»„åˆé”®æŸ¥è¯¢çš„ä»£ç è¿˜æ²¡å®Œå–„ï¼Œæ‰€ä»¥å½“å‰å®ç°åº”è¯¥ä¸æ˜¯æœ€ç»ˆçš„ã€‚<br>åœ¨ shc é‡Œé¢ä¸‹é¢ä¸¤æ¡ SQL æŸ¥è¯¢ä¸‹æ²‰åˆ° HBase çš„é€»è¾‘ä¸€è‡´</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sqlContext.sql(<span class="string">"select col00, col01, col1 from iteblog where col00 = 'row000'"</span>).show()df.sqlContext.sql(<span class="string">"select col00, col01, col1 from iteblog where col00 = 'row000' and col01 = 0"</span>).show()</span><br></pre></td></tr></table></figure><p>å”¯ä¸€åŒºåˆ«æ˜¯åœ¨ Spark å±‚é¢ä¸Šçš„è¿‡æ»¤ã€‚<br><a name="aR7vS"></a></p><h2 id="scan-æŸ¥è¯¢ä¼˜åŒ–"><a href="#scan-æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="scan æŸ¥è¯¢ä¼˜åŒ–"></a>scan æŸ¥è¯¢ä¼˜åŒ–</h2><p>å¦‚æœæˆ‘ä»¬çš„æŸ¥è¯¢æœ‰ &lt; æˆ– &gt; ç­‰æŸ¥è¯¢è¿‡æ»¤æ¡ä»¶ï¼Œæ¯”å¦‚ä¸‹é¢çš„æŸ¥è¯¢æ¡ä»¶ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sqlContext.sql(<span class="string">"select col00, col01, col1 from iteblog where col00 &gt; 'row000' and col00 &lt; 'row005'"</span>).show()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåœ¨ shc é‡Œé¢è½¬æ¢æˆ HBase çš„è¿‡æ»¤ä¸ºä¸€æ¡ get å’Œ ä¸€ä¸ª scanï¼Œå…·ä½“ä¸º get çš„ Rowkey ä¸º row0005\xff\xff\xff\xffï¼›scan çš„ startRow ä¸º row000ï¼ŒendRow ä¸º row005\xff\xff\xff\xffï¼Œç„¶åå°†æŸ¥è¯¢çš„ç»“æœè¿”å›åˆ° spark å±‚é¢ä¸Šè¿›è¡Œè¿‡æ»¤ã€‚<br>æ€»ä½“æ¥è¯´ï¼Œshc èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯¹æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ï¼Œé¿å…äº†å…¨è¡¨æ‰«æã€‚ä½†æ˜¯ç»è¿‡è¯„æµ‹ï¼Œshc å…¶å®è¿˜æœ‰å¾ˆå¤šåœ°æ–¹ä¸å¤Ÿå®Œå–„ï¼Œç®—å­ä¸‹æ²‰å¹¶æ²¡æœ‰ä¸‹æ²‰åˆ° HBase å±‚é¢ä¸Šè¿›è¡Œã€‚</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;br&gt;Apache &lt;a href=&quot;https://www.iteblog.com/archives/tag/spark/&quot; target=
      
    
    </summary>
    
    
      <category term="å¤§æ•°æ®" scheme="cpeixin.cn/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    
      <category term="spark" scheme="cpeixin.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>shadowsock-vpsæ­å»ºVPN</title>
    <link href="cpeixin.cn/2019/04/19/shadowsock-vps%E6%90%AD%E5%BB%BAVPN/"/>
    <id>cpeixin.cn/2019/04/19/shadowsock-vps%E6%90%AD%E5%BB%BAVPN/</id>
    <published>2019-04-19T15:26:15.000Z</published>
    <updated>2020-04-04T17:11:07.011Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="-1"></a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿˜æœ‰10å¤©å·¦å³å°±è¦å›å›½äº†ï¼Œç”±äºèŒä¸šçš„éœ€è¦ï¼Œå¯¹Googleçš„ä¾èµ–çš„è¶Šæ¥è¶Šå¤§çš„ï¼Œé‚£ä¹ˆå›å›½åæ€ä¹ˆæ‰èƒ½â€˜ç§‘å­¦ä¸Šç½‘â€™å‘¢ï¼Ÿä¹‹å‰åœ¨å›½å†…çš„æ—¶å€™ï¼Œæœ‰ä½¿ç”¨è¿‡Lanternï¼Œç¨³å®šæ€§å’Œé€Ÿåº¦éƒ½è¿˜æ˜¯ä¸é”™äº†ï¼Œå¯æƒœåæ¥è¢«å’Œè°äº†ã€‚æ‰€ä»¥ä»Šå¤©å‡†å¤‡å°è¯•æ­å»ºVPNï¼Œè‡ªå·±ç‹¬ç«‹ä½¿ç”¨ï¼Œä¸€è¾¹æ­å»ºä¸€è¾¹å°†è¿‡ç¨‹è®°å½•ä¸‹æ¥ã€‚<br><a name="-2"></a></p><h1 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h1><p>VPS: VPSï¼ˆVirtual Private Server è™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨ï¼‰æŠ€æœ¯ï¼Œå°†ä¸€å°æœåŠ¡å™¨åˆ†å‰²æˆå¤šä¸ªè™šæ‹Ÿä¸“äº«æœåŠ¡å™¨çš„ä¼˜è´¨æœåŠ¡ã€‚å®ç°VPSçš„æŠ€æœ¯åˆ†ä¸ºå®¹å™¨ [1] æŠ€æœ¯ï¼Œå’Œè™šæ‹ŸåŒ–æŠ€æœ¯ [2] ã€‚åœ¨å®¹å™¨æˆ–è™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªVPSéƒ½å¯åˆ†é…ç‹¬ç«‹å…¬ç½‘IPåœ°å€ã€ç‹¬ç«‹æ“ä½œç³»ç»Ÿã€å®ç°ä¸åŒVPSé—´ç£ç›˜ç©ºé—´ã€å†…å­˜ã€CPUèµ„æºã€è¿›ç¨‹å’Œç³»ç»Ÿé…ç½®çš„éš”ç¦»ï¼Œä¸ºç”¨æˆ·å’Œåº”ç”¨ç¨‹åºæ¨¡æ‹Ÿå‡ºâ€œç‹¬å â€ä½¿ç”¨è®¡ç®—èµ„æºçš„ä½“éªŒã€‚VPSå¯ä»¥åƒç‹¬ç«‹æœåŠ¡å™¨ä¸€æ ·ï¼Œé‡è£…æ“ä½œç³»ç»Ÿï¼Œå®‰è£…ç¨‹åºï¼Œå•ç‹¬é‡å¯æœåŠ¡å™¨ã€‚<br><br><br>VPSä¸ºä½¿ç”¨è€…æä¾›äº†ç®¡ç†é…ç½®çš„è‡ªç”±ï¼Œå¯ç”¨äºä¼ä¸šè™šæ‹ŸåŒ–ï¼Œä¹Ÿå¯ä»¥ç”¨äºIDCèµ„æºç§Ÿç”¨ã€‚<br><br><br>VPN: VPNçš„å­¦åå«è™šæ‹Ÿä¸“ç”¨ç½‘ï¼Œæ´‹æ–‡å«â€œVirtual Private Networkâ€ã€‚ç»´åŸºç™¾ç§‘çš„ä»‹ç»åœ¨â€œè¿™é‡Œâ€ã€‚æœ¬æ¥è¿™ç©æ„å„¿ä¸»è¦æ˜¯ç”¨äºå•†ä¸šå…¬å¸ï¼Œä¸ºäº†è®©é‚£äº›ä¸åœ¨å…¬å¸é‡Œçš„å‘˜å·¥ï¼ˆæ¯”å¦‚å‡ºå·®åœ¨å¤–çš„ï¼‰èƒ½å¤Ÿæ–¹ä¾¿åœ°è®¿é—®å…¬å¸çš„å†…éƒ¨ç½‘ç»œã€‚ä¸ºäº†é˜²æ­¢é»‘å®¢å†’å……å…¬å¸çš„å‘˜å·¥ï¼Œä»å¤–éƒ¨è®¿é—®å…¬å¸çš„å†…éƒ¨ç½‘ç»œï¼ŒVPN è½¯ä»¶éƒ½ä¼šæä¾›å¼ºå¤§çš„åŠ å¯†åŠŸèƒ½ã€‚è€Œè¿™ä¸ªåŠ å¯†åŠŸèƒ½ï¼Œä¹Ÿå°±è®©å®ƒé¡ºä¾¿æˆä¸ºç¿»å¢™çš„åˆ©å™¨ã€‚<br><a name="-3"></a></p><h1 id="ç§‘å­¦ä¸Šç½‘åŸç†"><a href="#ç§‘å­¦ä¸Šç½‘åŸç†" class="headerlink" title="ç§‘å­¦ä¸Šç½‘åŸç†"></a>ç§‘å­¦ä¸Šç½‘åŸç†</h1><p>VPNæµè§ˆå¤–ç½‘çš„åŸç†<br><br><br>ä½¿ç”¨ VPN é€šå¸¸éœ€è¦å…ˆå®‰è£…å®¢æˆ·ç«¯è½¯ä»¶ã€‚å½“ä½ è¿è¡Œ VPN å®¢æˆ·ç«¯ï¼Œå®ƒä¼šå°è¯•è”åˆ° VPN æœåŠ¡å™¨ï¼ˆè¿™ç‚¹è·ŸåŠ å¯†ä»£ç†ç±»ä¼¼ï¼‰ã€‚ä¸€æ—¦å’Œ VPN æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼ŒVPN å®¢æˆ·ç«¯å°±ä¼šåœ¨ä½ çš„ç³»ç»Ÿä¸­å»ºç«‹äº†ä¸€ä¸ªè™šæ‹Ÿå±€åŸŸç½‘ã€‚è€Œä¸”ï¼Œä½ çš„ç³»ç»Ÿä¸­ä¹Ÿä¼šå¤šå‡ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼ˆåœ¨ Windows ä¸‹ï¼Œå¯ä»¥ç”¨ ipconfig /all å‘½ä»¤ï¼Œçœ‹åˆ°è¿™å¤šå‡ºæ¥çš„ç½‘å¡ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œä½ çš„ç³»ç»Ÿä¸­å°±æœ‰ä¸æ­¢ä¸€å—ç½‘å¡ã€‚è¿™å°±å¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼šé‚£äº›è®¿é—®ç½‘ç»œçš„ç¨‹åºï¼Œå®ƒçš„æ•°æ®æµåº”è¯¥é€šè¿‡å“ªä¸ªç½‘å¡è¿›å‡ºï¼Ÿ<br>ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼ŒVPN å®¢æˆ·ç«¯é€šå¸¸ä¼šä¿®æ”¹ä½ ç³»ç»Ÿçš„è·¯ç”±è¡¨ï¼Œè®©é‚£äº›æ•°æ®æµï¼Œä¼˜å…ˆä»è™šæ‹Ÿçš„ç½‘å¡è¿›å‡ºã€‚ç”±äºè™šæ‹Ÿçš„ç½‘å¡æ˜¯é€šå¾€ VPN æœåŠ¡å™¨çš„ï¼Œå½“æ•°æ®æµåˆ°è¾¾ VPN æœåŠ¡å™¨ä¹‹åï¼ŒVPN æœåŠ¡å™¨å†å¸®ä½ æŠŠæ•°æ®æµè½¬å‘åˆ°çœŸæ­£çš„ç›®çš„åœ°ã€‚<br><br><br>å‰é¢è¯´äº†ï¼ŒVPN ä¸ºäº†ä¿è¯å®‰å…¨ï¼Œéƒ½é‡‡ç”¨å¼ºåŠ å¯†çš„æ–¹å¼ä¼ è¾“æ•°æ®ã€‚è¿™æ ·ä¸€æ¥ï¼ŒGFW å°±æ— æ³•åˆ†æä½ çš„ç½‘ç»œæ•°æ®æµï¼Œè¿›è¡Œæ•æ„Ÿè¯è¿‡æ»¤ã€‚æ‰€ä»¥ï¼Œä½¿ç”¨å¢™å¤–çš„VPNæœåŠ¡å™¨ï¼Œæ— å½¢ä¸­å°±èƒ½è¾¾åˆ°ç¿»å¢™çš„æ•ˆæœã€‚<br><a name="-4"></a></p><h1 id="æ–¹æ¡ˆé€‰æ‹©"><a href="#æ–¹æ¡ˆé€‰æ‹©" class="headerlink" title="æ–¹æ¡ˆé€‰æ‹©"></a>æ–¹æ¡ˆé€‰æ‹©</h1><p>VPNæ˜¯ä¸€ä¸ªå¤§ç±»ï¼Œå…¶ä¸­æœ‰å¾ˆå¤šå®ç°çš„æ–¹æ³•ï¼Œé˜²ç«é•¿åŸç°åœ¨å°† VPN å±è”½çš„å·²ç»æ‰€å‰©æ— å‡ ï¼Œåæ¥å¤§å®¶çœ‹åˆ°äº†SSHï¼Œä½¿ç”¨SSHçš„sock5å¾ˆç¨³å®šï¼Œä½†æ˜¯ç‰¹å¾ä¹Ÿååˆ†æ˜æ˜¾ï¼Œé˜²ç«é•¿åŸå¯ä»¥å¯¹å…¶ç›´æ¥è¿›è¡Œå®šå‘å¹²æ‰°ã€‚<br><br><br>è€Œé™¤äº†VPNï¼Œå¯¹äºç¿»å¢™å¤§å®¶ä»ç„¶æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚Shadowsocks ã€Lanternã€VPNGate ç­‰ç­‰ï¼Œè€Œå®é™…ä¸Šæ— è®ºå“ªç§æ–¹å¼ï¼Œä»–ä»¬æœ¬èº«éƒ½éœ€è¦ä¸€å°æœåŠ¡å™¨ä½œä¸ºä¸­é—´äººè¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚è€ŒVPSè™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨å°±ååˆ†é€‚åˆæ‹…å½“è¿™ä¸ªè§’è‰²ï¼Œå¹¶ä¸”ç”±äºVPSå¹³æ—¶å°±ä½œä¸ºå•†å“åœ¨å„ç±»äº‘æœåŠ¡å™¨å¹³å°ä¸Šå”®å–ï¼Œè‡ªè¡Œè´­ä¹°å¹¶æ­å»ºç›¸å½“æ–¹ä¾¿ï¼Œå”¯ä¸€éœ€è¦çš„å°±æ˜¯äººä»¬å¯¹äºæœåŠ¡å™¨çš„æ“ä½œæŠ€æœ¯ã€‚<br><br><br><strong>è€Œè¿™æ¬¡é€‰æ‹©çš„æ–¹æ¡ˆæ˜¯ï¼šVPS+Shadowsocks</strong><br>**<br>Shadowsocksç‰¹ç‚¹ï¼š<br><br><br>çœç”µï¼Œåœ¨ç”µé‡æŸ¥çœ‹é‡Œå‡ ä¹çœ‹ä¸åˆ°å®ƒçš„èº«å½±ï¼›<br><br><br>æ”¯æŒå¼€æœºè‡ªå¯åŠ¨ï¼Œä¸”æ–­ç½‘æ— å½±å“ï¼Œæ— éœ€æ‰‹åŠ¨é‡è¿ï¼Œæ–¹ä¾¿ç½‘ç»œä¸ç¨³å®šæˆ–è€…3G&amp;Wi-Fié¢‘ç¹åˆ‡æ¢çš„å°ä¼™ä¼´ï¼›<br><br><br>å¯ä½¿ç”¨è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå®‰å…¨å’Œé€Ÿåº¦çš„ä¿è¯ï¼›<br><br><br>æ”¯æŒåŒºåˆ†å›½å†…å¤–æµé‡ï¼Œä¼ ç»ŸVPNåœ¨ç¿»å‡ºå¢™å¤–åè®¿é—®å›½å†…ç«™ç‚¹ä¼šå˜æ…¢ï¼›<br><br><br>å¯å¯¹åº”ç”¨è®¾ç½®å•ç‹¬ä»£ç†ï¼Œ5.0ä¹‹åçš„ç³»ç»Ÿæ— éœ€rootã€‚<br><br><br>Shadowsocks ç›®å‰ä¸å®¹æ˜“è¢«å°æ€ä¸»è¦æ˜¯å› ä¸ºï¼š<br>å»ºç«‹åœ¨socks5åè®®ä¹‹ä¸Šï¼Œsocks5æ˜¯è¿ç”¨å¾ˆå¹¿æ³›çš„åè®®ï¼Œæ‰€ä»¥æ²¡åŠæ³•ç›´æ¥å°æ€socks5åè®®<br>ä½¿ç”¨socks5åè®®å»ºç«‹è¿æ¥ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨VPNä¸­çš„æœåŠ¡ç«¯èº«ä»½éªŒè¯å’Œå¯†é’¥åå•†è¿‡ç¨‹ã€‚è€Œæ˜¯åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç›´æ¥å†™æ­»å¯†é’¥å’ŒåŠ å¯†ç®—æ³•ã€‚æ‰€ä»¥é˜²ç«å¢™å¾ˆéš¾æ‰¾åˆ°æ˜æ˜¾çš„ç‰¹å¾ï¼Œå› ä¸ºè¿™å°±æ˜¯ä¸ªæ™®é€šçš„socks5åè®®ã€‚<br><br><br>Shadowsockæ­å»ºä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å¾ˆå¤šäººè‡ªå·±æ¶è®¾VPSæ­å»ºï¼Œä¸ªäººä½¿ç”¨æµé‡ä¹Ÿå¾ˆå°ï¼Œæ²¡æ³•é€šè¿‡æµé‡ç›‘æ§æ–¹å¼å°æ€ã€‚<br>è‡ªå®šä¹‰åŠ å¯†æ–¹å¼å’Œå¯†é’¥ã€‚å› ä¸ºåŠ å¯†ä¸»è¦ä¸»è¦æ˜¯é˜²æ­¢è¢«æ£€æµ‹ï¼Œæ‰€ä»¥è¦é€‰æ‹©å®‰å…¨ç³»æ•°é«˜çš„åŠ å¯†æ–¹å¼ã€‚ä¹‹å‰RC4ä¼šå¾ˆå®¹æ˜“è¢«ç ´è§£ï¼Œè€Œå¯¼è‡´è¢«å°æ€ã€‚æ‰€ä»¥ç°åœ¨æ¨èä½¿ç”¨AESåŠ å¯†ã€‚è€Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è‡ªå®šä¹‰å¯†é’¥ï¼Œæ³„éœ²çš„é£é™©ç›¸å¯¹è¾ƒå°ã€‚<br>æ‰€ä»¥å¦‚æœæ˜¯è‡ªå·±æ­å»ºçš„Shadosocksè¢«å°çš„æ¦‚ç‡å¾ˆå°ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹çš„Shadeowsocksï¼Œå¯†ç æ˜¯serverå®šçš„ï¼Œä½ çš„æ•°æ®å¾ˆå¯èƒ½é­å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚<br><a name="-5"></a></p><h1 id="å¼€å·¥"><a href="#å¼€å·¥" class="headerlink" title="å¼€å·¥"></a>å¼€å·¥</h1><p><a name="vps"></a></p><h2 id="è´­ä¹°vps"><a href="#è´­ä¹°vps" class="headerlink" title="è´­ä¹°vps"></a>è´­ä¹°vps</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è´­ä¹°ä¸€å°å¢ƒå¤–çš„æœåŠ¡å™¨ï¼Œæ¥ç€æˆ‘ä»¬åœ¨è¿™å°äº‘æœåŠ¡å™¨é‡Œé¢å®‰è£…ä»£ç†æœåŠ¡ï¼Œé‚£ä¹ˆä»¥åæˆ‘ä»¬ä¸Šç½‘çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡å®ƒæ¥ä¸­è½¬ï¼Œè½»æ¾ç•…å¿«çš„ç•…æ¸¸å…¨ç½‘äº†ã€‚<br>è´­ä¹°VPS,æˆ‘é€‰æ‹©äº†<a href="https://www.vultr.com/" target="_blank" rel="external nofollow noopener noreferrer">vultr</a>ï¼Œå¤§å®¶ç”¨è¿‡éƒ½è¯´å¥½ï¼Œè´­ä¹°çš„è¿‡ç¨‹ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚<br><br><br>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç¦»ä¸­å›½è¾ƒè¿‘å›½å®¶çš„æœåŠ¡å™¨ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400540784-be727007-a613-4b5b-a3d5-9b5fbf9734a7.png#align=left&display=inline&height=1468&name=step1.png&originHeight=1468&originWidth=3066&size=659813&status=done&style=none&width=3066" alt="step1.png"><br><br><br><br><br>ç¬¬äºŒæ­¥ï¼šé€‰æ‹©æœåŠ¡å™¨é…ç½®å’Œç³»ç»Ÿ<br><br><br>è¿™é‡Œï¼Œç³»ç»Ÿé€‰æ‹©çš„æ˜¯CentOS 7,é…ç½®çš„è¯ï¼Œå¦‚æœåªæ˜¯è‡ªå·±æµè§ˆç½‘é¡µçš„è¯ï¼Œé€‰æ‹©æœ€ä½é…ç½®å°±å¥½ã€‚å…¶ä»–çš„é€‰é¡¹å¯ä»¥ç•¥è¿‡ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400556831-e2446e46-8c7e-4292-97a8-b89e6d983c9c.png#align=left&display=inline&height=1594&name=step2.png&originHeight=1594&originWidth=2792&size=669959&status=done&style=none&width=2792" alt="step2.png"><br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235703-e6afdea2-828f-42a0-a955-67960c8710bc.png#align=left&display=inline&height=1812&originHeight=1812&originWidth=2600&size=0&status=done&style=none&width=2600" alt><br><br><br>ç¬¬ä¸‰æ­¥ï¼šæ”¯ä»˜å’Œéƒ¨ç½²<br><br><br>æ”¯ä»˜å¯ä»¥é€‰æ‹©æ”¯ä»˜å®æ”¯ä»˜ï¼Œéå¸¸æ–¹ä¾¿ã€‚è´­ä¹°æˆåŠŸåï¼Œç‚¹å‡»Serverä¸­çš„â€œ+â€å·ï¼Œæ¥éƒ¨ç½²ä½ åˆšåˆšé€‰æ‹©çš„æœåŠ¡å™¨ã€‚<br>ç¬¬å››æ­¥ï¼šç™»é™†æœåŠ¡å™¨<br><br><br>æŸ¥çœ‹æœåŠ¡å™¨è¯¦æƒ… Server Details,æ ¹æ®æä¾›çš„æœåŠ¡å™¨ä¿¡æ¯ï¼Œç™»é™†æœåŠ¡å™¨ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235150-95a87ca7-8392-404e-a5d9-c4a606b8ae7e.png#align=left&display=inline&height=1166&originHeight=1166&originWidth=2728&size=0&status=done&style=none&width=2728" alt><br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235639-e36e0afa-200d-49ad-a324-350004d08d09.png#align=left&display=inline&height=1232&originHeight=1232&originWidth=2612&size=0&status=done&style=none&width=2612" alt><br><br><br>æˆ‘æ˜¯ä½¿ç”¨Macæœ¬èº«ç»ˆç«¯sshåˆ°æœåŠ¡å™¨ä¸Šçš„ï¼Œå› ä¸ºMacä¸Šå¤šæ•°çš„SSHå®¢æˆ·ç«¯è¦ä¹ˆæ”¶è´¹ï¼Œè¦ä¹ˆä¸å¥½ç”¨ï¼Œè¦ä¹ˆå®‰è£…è¿‡ç¨‹éå¸¸ç¹çã€‚<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p <span class="number">22</span> root@ip</span><br></pre></td></tr></table></figure><p><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235316-408c45f7-df95-4c8c-9428-9f476c6c7190.png#align=left&display=inline&height=244&originHeight=244&originWidth=1304&size=0&status=done&style=none&width=1304" alt><br><a name="shadowsocks"></a></p><h2 id="æ­å»ºshadowsocksæœåŠ¡å™¨"><a href="#æ­å»ºshadowsocksæœåŠ¡å™¨" class="headerlink" title="æ­å»ºshadowsocksæœåŠ¡å™¨"></a>æ­å»ºshadowsocksæœåŠ¡å™¨</h2><p>è¿æ¥åˆ°ä½ çš„ vultr æœåŠ¡å™¨ä¹‹åï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨å‡ ä¸ªå‘½ä»¤è®©ä½ å¿«é€Ÿæ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„ ss æœåŠ¡å™¨ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget</span><br></pre></td></tr></table></figure><p><br>æ¥ç€æ‰§è¡Œå®‰è£…shadowsocksï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget â€“no-check-certificate -O shadowsocks.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span><br></pre></td></tr></table></figure><p><br>è·å– <a href="http://shadowsocks.sh/" target="_blank" rel="external nofollow noopener noreferrer">shadowsocks.sh</a> è¯»å–æƒé™ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x shadowsocks.sh</span><br></pre></td></tr></table></figure><p><br>è®¾ç½®ä½ çš„ ss å¯†ç å’Œç«¯å£å·ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks.sh <span class="number">2</span>&gt;&amp;<span class="number">1</span> | tee shadowsocks.log</span><br></pre></td></tr></table></figure><p><br>æ¥ä¸‹æ¥åå°±å¯ä»¥è®¾ç½®å¯†ç å’Œç«¯å£å·äº†<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400236071-267db22c-ea03-4f8b-969d-86ae5efc4d68.png#align=left&display=inline&height=306&originHeight=306&originWidth=1086&size=0&status=done&style=none&width=1086" alt><br><br><br>å¯†ç å’Œç«¯å£å·å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é‡æ–°è¾“å…¥æ–°çš„ã€‚<br>é€‰æ‹©åŠ å¯†æ–¹å¼<br><br><br>è®¾ç½®å®Œå¯†ç å’Œç«¯å£å·ä¹‹åï¼Œæˆ‘ä»¬é€‰æ‹©åŠ å¯†æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹© 7 ï¼Œä½¿ç”¨aes-256-cfbçš„åŠ å¯†æ¨¡å¼<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235435-525e1564-eb61-47e0-b9b1-a28683979702.png#align=left&display=inline&height=684&originHeight=684&originWidth=914&size=0&status=done&style=none&width=914" alt><br><br><br>æ¥ç€æŒ‰ä»»æ„é”®è¿›è¡Œå®‰è£…ã€‚<br>å®‰è£…sså®Œæˆå<br><br><br>ä¼šç»™ä½ æ˜¾ç¤ºä½ éœ€è¦è¿æ¥ vpn çš„ä¿¡æ¯ï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400239145-4d70810e-bc73-4cfa-bc8c-4da35e3e0dcf.png#align=left&display=inline&height=464&originHeight=464&originWidth=1186&size=0&status=done&style=none&width=1186" alt><br>æå®šï¼Œå°†è¿™äº›ä¿¡æ¯ä¿å­˜èµ·æ¥ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ä½ å°±å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥ç§‘å­¦ä¸Šç½‘å•¦ã€‚<br><a name="bbr"></a></p><h2 id="ä½¿ç”¨BBRåŠ é€Ÿä¸Šç½‘"><a href="#ä½¿ç”¨BBRåŠ é€Ÿä¸Šç½‘" class="headerlink" title="ä½¿ç”¨BBRåŠ é€Ÿä¸Šç½‘"></a>ä½¿ç”¨BBRåŠ é€Ÿä¸Šç½‘</h2><p>å®‰è£… BBR<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh</span><br></pre></td></tr></table></figure><p><br>è·å–è¯»å†™æƒé™<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x bbr.sh</span><br></pre></td></tr></table></figure><p><br>å¯åŠ¨BBRå®‰è£…<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bbr.sh</span><br></pre></td></tr></table></figure><p><br>æ¥ç€æŒ‰ä»»æ„é”®ï¼Œå¼€å§‹å®‰è£…ï¼Œåç­‰ä¸€ä¼šã€‚å®‰è£…å®Œæˆä¸€ä¼šä¹‹åå®ƒä¼šæç¤ºæˆ‘ä»¬æ˜¯å¦é‡æ–°å¯åŠ¨vpsï¼Œæˆ‘ä»¬è¾“å…¥ y ç¡®å®šé‡å¯æœåŠ¡å™¨ã€‚<br>é‡æ–°å¯åŠ¨ä¹‹åï¼Œè¾“å…¥ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep bbr</span><br></pre></td></tr></table></figure><p><br>å¦‚æœçœ‹åˆ° tcp_bbr å°±è¯´æ˜ BBR å·²ç»å¯åŠ¨äº†ã€‚<br><a name="-6"></a></p><h2 id="å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥"><a href="#å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥" class="headerlink" title="å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥"></a>å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥</h2><p><a name="windowsshadowsocks"></a></p><h3 id="windowsä½¿ç”¨Shadowsocks"><a href="#windowsä½¿ç”¨Shadowsocks" class="headerlink" title="windowsä½¿ç”¨Shadowsocks"></a>windowsä½¿ç”¨Shadowsocks</h3><p>windowsç‚¹å‡»ä¸‹è½½ï¼š<a href="https://pan.baidu.com/s/19m0AfTkPDSRj0bfYrGpbIg" target="_blank" rel="external nofollow noopener noreferrer">Shadowsocks windowså®¢æˆ·ç«¯</a><br>æ‰“å¼€ Shadowsocks å®¢æˆ·ç«¯ï¼Œè¾“å…¥ipåœ°å€ï¼Œå¯†ç ï¼Œç«¯å£ï¼Œå’ŒåŠ å¯†æ–¹å¼ã€‚æ¥ç€ç‚¹å‡»ç¡®å®šï¼Œå³ä¸‹è§’ä¼šæœ‰ä¸ªå°é£æœºæŒ‰é’®ï¼Œå³é”®â€“&gt;å¯åŠ¨ä»£ç†ã€‚<br><a name="androidshadowsocks"></a></p><h3 id="Androidä½¿ç”¨Shadowsocks"><a href="#Androidä½¿ç”¨Shadowsocks" class="headerlink" title="Androidä½¿ç”¨Shadowsocks"></a>Androidä½¿ç”¨Shadowsocks</h3><p>Androidç‚¹å‡»ä¸‹è½½ï¼š<a href="https://pan.baidu.com/s/1coAkZn-GuYHu5eIKaHECxA" target="_blank" rel="external nofollow noopener noreferrer">Shadowsocks Androidå®¢æˆ·ç«¯</a><br>æ‰“å¼€apkå®‰è£…ï¼Œæ¥ç€æ‰“å¼€APPï¼Œè¾“å…¥ipåœ°å€ï¼Œå¯†ç ï¼Œç«¯å£ï¼Œå’ŒåŠ å¯†æ–¹å¼ã€‚å³å¯ç§‘å­¦ä¸Šç½‘ã€‚<br><a name="iphoneshadowsocks"></a></p><h3 id="iPhoneä½¿ç”¨Shadowsocks"><a href="#iPhoneä½¿ç”¨Shadowsocks" class="headerlink" title="iPhoneä½¿ç”¨Shadowsocks"></a>iPhoneä½¿ç”¨Shadowsocks</h3><p>iPhoneè¦ä¸‹è½½çš„appéœ€è¦åœ¨appstoreä¸‹è½½ï¼Œä½†æ˜¯éœ€è¦ç”¨ç¾åŒºè´¦å·æ‰èƒ½ä¸‹è½½ï¼Œè€Œä¸”è¿™ä¸ªAPPéœ€è¦é’±ã€‚åœ¨è¿™é‡Œæä¾›ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯å¯ä»¥å†æ­å»ºä¸€ä¸ª<a href="https://wistbean.github.io/ipsec,l2tp_vpn.html#%E4%BD%BF%E7%94%A8-IPsec-L2TP-%E8%84%9A%E6%9C%AC%E6%90%AD%E5%BB%BA" target="_blank" rel="external nofollow noopener noreferrer">IPsec/L2TP</a> VPN,ä¸“é—¨ç»™ä½ çš„iPhoneä½¿ç”¨ã€‚<br><a name="mac"></a></p><h3 id="Macé…ç½®"><a href="#Macé…ç½®" class="headerlink" title="Macé…ç½®"></a>Macé…ç½®</h3><p>ç”¨çš„æ˜¯Macç”µè„‘ï¼Œæ‰€ä»¥ç‚¹å‡»ç›¸å…³é“¾æ¥ã€‚ä¸œè¥¿éƒ½æŒ‚åœ¨githubä¸Šï¼Œä¸‹è½½å¯¹åº”çš„zipæ–‡ä»¶ï¼Œä¸‹è½½å®Œæˆåå®‰è£…å¹¶è¿è¡Œèµ·æ¥ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235178-7ccd25cd-8b34-4103-8cc8-204e84672cfe.png#align=left&display=inline&height=748&originHeight=748&originWidth=1302&size=0&status=done&style=none&width=1302" alt><br><br><br>ç‚¹å‡»å›¾æ ‡ï¼Œè¿›å…¥ æœåŠ¡å™¨è®¾ç½®<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400239120-45698c54-ac3b-48b9-9c4d-9f3537938f87.png#align=left&display=inline&height=926&originHeight=926&originWidth=1302&size=0&status=done&style=none&width=1302" alt><br><br><br>ä¸»è¦æœ‰å››ä¸ªåœ°æ–¹è¦å¡«ï¼ŒæœåŠ¡å™¨çš„åœ°å€ï¼Œç«¯å£å·ï¼ŒåŠ å¯†æ–¹æ³•ï¼Œå¯†ç ã€‚æœåŠ¡å™¨åœ°å€å³ä¸ºä¹‹å‰ Main controlsé€‰é¡¹ä¸­çš„IPåœ°å€ã€‚ç«¯å£å·ã€åŠ å¯†æ–¹æ³•ã€å¯†ç å¿…é¡»ä¸ä¹‹å‰ Shadowsocks Server ä¸­çš„ä¿¡æ¯ä¸€ä¸€åŒ¹é…ï¼Œå¦åˆ™ä¼šè¿æ¥å¤±è´¥ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1585400235629-2861fc8f-5bfc-4610-993f-49064774e693.png#align=left&display=inline&height=1156&originHeight=1156&originWidth=1292&size=0&status=done&style=none&width=1292" alt><br><br><br>è®¾ç½®å®Œæˆåç‚¹å‡»ç¡®å®šï¼Œç„¶åæœåŠ¡å™¨é€‰æ‹©è¿™ä¸ªé…ç½®ï¼Œé»˜è®¤é€‰ä¸­PACè‡ªåŠ¨æ¨¡å¼ï¼Œç¡®ä¿ShadowsocksçŠ¶æ€ä¸ºOnï¼Œè¿™æ—¶å€™æ‰“å¼€è°·æ­Œè¯•è¯•~<br>æ¥ç€å°±å¯ä»¥ä¸Šå¤–ç½‘äº† ğŸ˜‚</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="cpeixin.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="shadowsock" scheme="cpeixin.cn/tags/shadowsock/"/>
    
  </entry>
  
  <entry>
    <title>Structured Streaming é‡æ¸©</title>
    <link href="cpeixin.cn/2019/02/10/Structured-Streaming-%E9%87%8D%E6%B8%A9/"/>
    <id>cpeixin.cn/2019/02/10/Structured-Streaming-%E9%87%8D%E6%B8%A9/</id>
    <published>2019-02-10T08:03:44.000Z</published>
    <updated>2020-05-09T04:09:47.215Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p><a name="N4GjR"></a></p><h2 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="headerlink" title="æ€»è§ˆ"></a>æ€»è§ˆ</h2><p>_<br>Structured Streaming åˆ™æ˜¯åœ¨ Spark 2.0 åŠ å…¥çš„ç»è¿‡é‡æ–°è®¾è®¡çš„å…¨æ–°æµå¼å¼•æ“ã€‚å®ƒçš„æ¨¡å‹ååˆ†ç®€æ´ï¼Œæ˜“äºç†è§£ã€‚ä¸€ä¸ªæµçš„æ•°æ®æºä»é€»è¾‘ä¸Šæ¥è¯´å°±æ˜¯ä¸€ä¸ªä¸æ–­å¢é•¿çš„åŠ¨æ€è¡¨æ ¼ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ–°æ•°æ®è¢«æŒç»­ä¸æ–­åœ°æ·»åŠ åˆ°è¡¨æ ¼çš„æœ«å°¾ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Dataset/DataFrame æˆ–è€… SQL æ¥å¯¹è¿™ä¸ªåŠ¨æ€æ•°æ®æºè¿›è¡Œå®æ—¶æŸ¥è¯¢ã€‚æ¯æ¬¡æŸ¥è¯¢åœ¨é€»è¾‘ä¸Šå°±æ˜¯å¯¹å½“å‰çš„è¡¨æ ¼å†…å®¹æ‰§è¡Œä¸€æ¬¡ SQL æŸ¥è¯¢ã€‚å¦‚ä½•æ‰§è¡ŒæŸ¥è¯¢åˆ™æ˜¯ç”±ç”¨æˆ·é€šè¿‡è§¦å‘å™¨ï¼ˆTriggerï¼‰æ¥è®¾å®šã€‚ç”¨æˆ·æ—¢å¯ä»¥è®¾å®šå®šæœŸæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è®©æŸ¥è¯¢å°½å¯èƒ½å¿«åœ°æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°å®æ—¶çš„æ•ˆæœã€‚æœ€åï¼Œç³»ç»Ÿé€šè¿‡ checkpointing å’Œ Write-Ahead Logsæ¥ç¡®ä¿ç«¯åˆ°ç«¯çš„ä¸€æ¬¡å®¹é”™ä¿è¯ã€‚ä¸€ä¸ªæµçš„è¾“å‡ºæœ‰å¤šç§æ¨¡å¼ï¼Œæ—¢å¯ä»¥æ˜¯åŸºäºæ•´ä¸ªè¾“å…¥æ‰§è¡ŒæŸ¥è¯¢åçš„å®Œæ•´ç»“æœï¼Œä¹Ÿå¯ä»¥é€‰æ‹©åªè¾“å‡ºä¸ä¸Šæ¬¡æŸ¥è¯¢ç›¸æ¯”çš„å·®å¼‚ï¼Œæˆ–è€…å°±æ˜¯ç®€å•åœ°è¿½åŠ æœ€æ–°çš„ç»“æœã€‚è¿™ä¸ªæ¨¡å‹å¯¹äºç†Ÿæ‚‰ SQL çš„ç”¨æˆ·æ¥è¯´å¾ˆå®¹æ˜“æŒæ¡ï¼Œå¯¹æµçš„æŸ¥è¯¢è·ŸæŸ¥è¯¢ä¸€ä¸ªè¡¨æ ¼å‡ ä¹å®Œå…¨ä¸€æ ·ã€‚<br><br><br>åœ¨å†…éƒ¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç»“æ„åŒ–æµæŸ¥è¯¢æ˜¯ä½¿ç”¨_å¾®æ‰¹é‡å¤„ç†_å¼•æ“_å¤„ç†çš„_ï¼Œè¯¥å¼•æ“å°†æ•°æ®æµä½œä¸ºä¸€ç³»åˆ—å°æ‰¹é‡ä½œä¸šè¿›è¡Œå¤„ç†ï¼Œä»è€Œå®ç°äº†ä½è‡³100æ¯«ç§’çš„ç«¯åˆ°ç«¯å»¶è¿Ÿä»¥åŠ exactly-onceçš„å®¹é”™ä¿è¯ã€‚ä½†æ˜¯ï¼Œè‡ªSpark 2.3èµ·ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§ç§°ä¸ºâ€œ <strong>è¿ç»­å¤„ç†â€</strong>çš„æ–°ä½å»¶è¿Ÿå¤„ç†æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å¯ä»¥å®ç°ä¸€æ¬¡æœ€å°‘ä¿è¯çš„ä½è‡³1æ¯«ç§’çš„ç«¯åˆ°ç«¯å»¶è¿Ÿã€‚åœ¨ä¸æ›´æ”¹æŸ¥è¯¢ä¸­çš„Dataset / DataFrameæ“ä½œçš„æƒ…å†µä¸‹ï¼Œæ‚¨å°†èƒ½å¤Ÿæ ¹æ®åº”ç”¨ç¨‹åºéœ€æ±‚é€‰æ‹©æ¨¡å¼<br><br><br></p><p><a name="YF5tx"></a></p><h2 id="Structured-Streaming-æ˜¯å¯¹-Spark-Streaming-çš„æ”¹è¿›ä¹ˆï¼Ÿ"><a href="#Structured-Streaming-æ˜¯å¯¹-Spark-Streaming-çš„æ”¹è¿›ä¹ˆï¼Ÿ" class="headerlink" title="Structured Streaming æ˜¯å¯¹ Spark Streaming çš„æ”¹è¿›ä¹ˆï¼Ÿ"></a>Structured Streaming æ˜¯å¯¹ Spark Streaming çš„æ”¹è¿›ä¹ˆï¼Ÿ</h2><p><br>Structured Streaming å¹¶ä¸æ˜¯å¯¹ Spark Streaming çš„ç®€å•æ”¹è¿›ï¼Œè€Œæ˜¯æˆ‘ä»¬å¸å–äº†è¿‡å»å‡ å¹´åœ¨å¼€å‘ Spark SQL å’Œ Spark Streaming è¿‡ç¨‹ä¸­çš„ç»éªŒæ•™è®­ï¼Œä»¥åŠ Spark ç¤¾åŒºå’Œ Databricks ä¼—å¤šå®¢æˆ·çš„åé¦ˆï¼Œé‡æ–°å¼€å‘çš„å…¨æ–°æµå¼å¼•æ“ï¼Œè‡´åŠ›äºä¸ºæ‰¹å¤„ç†å’Œæµå¤„ç†æä¾›ç»Ÿä¸€çš„é«˜æ€§èƒ½ APIã€‚åŒæ—¶ï¼Œåœ¨è¿™ä¸ªæ–°çš„å¼•æ“ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å®ç°ä¹‹å‰åœ¨ Spark Streaming ä¸­å¾ˆéš¾å®ç°çš„ä¸€äº›åŠŸèƒ½ï¼Œ<strong>æ¯”å¦‚ Event Time çš„æ”¯æŒ</strong>ï¼ŒStream-Stream Joinï¼Œæ¯«ç§’çº§å»¶è¿Ÿ<br><br><br>ç±»ä¼¼äº Dataset/DataFrame ä»£æ›¿ Spark Core çš„ RDD æˆä¸ºä¸º Spark ç”¨æˆ·ç¼–å†™æ‰¹å¤„ç†ç¨‹åºçš„é¦–é€‰ï¼ŒDataset/DataFrame ä¹Ÿå°†æ›¿ä»£ Spark Streaming çš„ DStreamï¼Œæˆä¸ºç¼–å†™æµå¤„ç†ç¨‹åºçš„é¦–é€‰ã€‚<br></p><p><a name="HuvDe"></a></p><h2 id="Structured-Streaming-çš„-Spark-æœ‰ä»€ä¹ˆä¼˜åŠ£åŠ¿å—ï¼Ÿ"><a href="#Structured-Streaming-çš„-Spark-æœ‰ä»€ä¹ˆä¼˜åŠ£åŠ¿å—ï¼Ÿ" class="headerlink" title="Structured Streaming çš„ Spark æœ‰ä»€ä¹ˆä¼˜åŠ£åŠ¿å—ï¼Ÿ"></a>Structured Streaming çš„ Spark æœ‰ä»€ä¹ˆä¼˜åŠ£åŠ¿å—ï¼Ÿ</h2><ul><li>ç®€æ´çš„æ¨¡å‹ã€‚Structured Streaming çš„æ¨¡å‹å¾ˆç®€æ´ï¼Œæ˜“äºç†è§£ã€‚ç”¨æˆ·å¯ä»¥ç›´æ¥æŠŠä¸€ä¸ªæµæƒ³è±¡æˆæ˜¯æ— é™å¢é•¿çš„è¡¨æ ¼ã€‚</li><li>ä¸€è‡´çš„ APIã€‚ç”±äºå’Œ Spark SQL å…±ç”¨å¤§éƒ¨åˆ† APIï¼Œå¯¹ Spaprk SQL ç†Ÿæ‚‰çš„ç”¨æˆ·å¾ˆå®¹æ˜“ä¸Šæ‰‹ï¼Œä»£ç ä¹Ÿååˆ†ç®€æ´ã€‚åŒæ—¶æ‰¹å¤„ç†å’Œæµå¤„ç†ç¨‹åºè¿˜å¯ä»¥å…±ç”¨ä»£ç ï¼Œä¸éœ€è¦å¼€å‘ä¸¤å¥—ä¸åŒçš„ä»£ç ï¼Œæ˜¾è‘—æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</li><li>å“è¶Šçš„æ€§èƒ½ã€‚Structured Streaming åœ¨ä¸ Spark SQL å…±ç”¨ API çš„åŒæ—¶ï¼Œä¹Ÿç›´æ¥ä½¿ç”¨äº† Spark SQL çš„ Catalyst ä¼˜åŒ–å™¨å’Œ Tungstenï¼Œæ•°æ®å¤„ç†æ€§èƒ½ååˆ†å‡ºè‰²ã€‚æ­¤å¤–ï¼ŒStructured Streaming è¿˜å¯ä»¥ç›´æ¥ä»æœªæ¥ Spark SQL çš„å„ç§æ€§èƒ½ä¼˜åŒ–ä¸­å—ç›Šã€‚</li><li>å¤šè¯­è¨€æ”¯æŒã€‚Structured Streaming ç›´æ¥æ”¯æŒç›®å‰ Spark SQL æ”¯æŒçš„è¯­è¨€ï¼ŒåŒ…æ‹¬ Scalaï¼ŒJavaï¼ŒPythonï¼ŒR å’Œ SQLã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„è¯­è¨€è¿›è¡Œå¼€å‘ã€‚</li></ul><br><br>å‘ƒï½ï½ å…³äºStructured Streamingçš„ä»‹ç»å°±è¯´åˆ°è¿™é‡Œï¼Œå¦‚æœæƒ³çœ‹æ›´è¯¦ç»†æ›´å‡†ç¡®çš„ä»‹ç»å‘¢ï¼Œè¿˜æ˜¯ä¹–ä¹–çš„å»å®˜ç½‘å§ã€‚åœ¨2017å¹´10æœˆä»½çš„æ—¶å€™ï¼Œæ–°ç«‹é¡¹çš„ä¸€ä¸ªappç”¨æˆ·è¡Œä¸ºå®æ—¶é¡¹ç›®ï¼Œæˆ‘æœ‰æ„ä½¿ç”¨Structured Streamingï¼Œæ‰€ä»¥å°±è°ƒç ”äº†ä¸€ä¸‹ï¼Œè‡ªå·±å†™äº†ä¸€ä¸ªdemoï¼Œæˆ‘è®°å¿†é‡Œé‚£æ—¶å†™Structuredå¾ˆåˆ«æ‰­ï¼Œå°±åƒä¸€ä¸ªæ¨¡ç‰ˆä¸€æ ·ï¼Œè¾“å…¥æºå’Œè¾“å‡ºæºéƒ½è¢«è§„å®šå¥½äº†å‡½æ•°å’Œå‚æ•°ï¼Œå¹¶ä¸”åœ¨é‚£æ—¶å€™æµ‹è¯•åçš„æ—¶å€™ï¼Œä¸æ€ä¹ˆç¨³å®šï¼Œè€Œä¸”å®˜æ–¹å¹¶æ²¡æœ‰ç»™å‡ºæˆç†Ÿçš„ç‰ˆæœ¬ï¼Œå½“æ—¶æ‰€æµ‹è¯•çš„åŠŸèƒ½è¿˜éƒ½æ˜¯ alpha ç‰ˆæœ¬ï¼Œæ‰€ä»¥å½“æ—¶å°±è¿˜æ˜¯ä½¿ç”¨äº†Spark Streaming<p>ä¸è¿‡ç°åœ¨æ¥çœ‹ï¼ŒStructured Streaming è¶Šæ¥è¶Šæˆç†Ÿï¼ŒSpark Streamingæ„Ÿè§‰ä¼¼ä¹åœæ­¢äº†æ›´æ–°ã€‚Structured streamingåº”è¯¥æ˜¯Sparkæµå¤„ç†çš„æœªæ¥ï¼Œä½†æ˜¯å¾ˆéš¾æ›¿ä»£Flinkã€‚Flinkåœ¨æµå¤„ç†ä¸Šçš„å¤©ç„¶ä¼˜åŠ¿å¾ˆéš¾è¢«Sparkè¶…è¶Šã€‚<br><br><br>åœ¨è¯»å®Œäº†Structured Streamingå®˜ç½‘åï¼Œè¿˜æ˜¯äº²æ‰‹çš„å†™ä¸€äº›å®ä¾‹æ„Ÿå—ä¸€ä¸‹ï¼Œä»¥ååšæ¶æ„çš„æ—¶å€™ï¼Œå¦‚æœé€‚åˆçš„è¯ï¼Œè¿˜å¯ä»¥åŠ è¿›æ¥ã€‚</p><p><a name="9BWc2"></a></p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><br><a name="TJ1U5"></a> ### complete, append, update<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.streaming.<span class="type">StreamingQuery</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">Dataset</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.&#123;<span class="type">JSON</span>, <span class="type">JSONObject</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">structured_kafka</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> logger:<span class="type">Logger</span> = <span class="type">Logger</span>.getRootLogger</span><br><span class="line">  <span class="type">Logger</span>.getLogger(<span class="string">"org"</span>).setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">kafka_format</span>(<span class="params">date_time: <span class="type">String</span>, keyword_list: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">val</span> <span class="title">spark</span></span>: <span class="type">SparkSession</span> = <span class="type">SparkSession</span></span><br><span class="line">      .builder()</span><br><span class="line">      .appName(<span class="string">"Structrued-Streaming"</span>)</span><br><span class="line">      .master(<span class="string">"local[2]"</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> kafka_df: <span class="type">DataFrame</span> = spark</span><br><span class="line">      .readStream</span><br><span class="line">      .format(<span class="string">"kafka"</span>)</span><br><span class="line">      .option(<span class="string">"kafka.bootstrap.servers"</span>, <span class="string">"localhost:9092"</span>)</span><br><span class="line">      .option(<span class="string">"subscribe"</span>, <span class="string">"weibo_keyword"</span>)</span><br><span class="line">      .option(<span class="string">"startingOffsets"</span>, <span class="string">"earliest"</span>)</span><br><span class="line">      .option(<span class="string">"includeTimestamp"</span>, value = <span class="literal">true</span>)</span><br><span class="line"><span class="comment">//      .option("endingOffsets", "latest")</span></span><br><span class="line"><span class="comment">//      .option("startingOffsets", """&#123;"topic1":&#123;"0":23,"1":-2&#125;,"topic2":&#123;"0":-2&#125;&#125;""")</span></span><br><span class="line"><span class="comment">//      .option("endingOffsets", """&#123;"topic1":&#123;"0":50,"1":-1&#125;,"topic2":&#123;"0":-1&#125;&#125;""")</span></span><br><span class="line">      .load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> keyvalue_df: <span class="type">DataFrame</span> = kafka_df</span><br><span class="line">      .selectExpr(<span class="string">"CAST(value AS STRING)"</span>)</span><br><span class="line">      .as[<span class="type">String</span>]</span><br><span class="line">      .map((x: <span class="type">String</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> date_time: <span class="type">String</span> = <span class="type">JSON</span>.parseObject(x).getString(<span class="string">"datetime"</span>)</span><br><span class="line">        <span class="keyword">val</span> keyword_list: <span class="type">String</span> = <span class="type">JSON</span>.parseObject(x).getString(<span class="string">"keywordList"</span>)</span><br><span class="line">        (date_time, keyword_list)</span><br><span class="line">      &#125;)</span><br><span class="line">      .flatMap((x: (<span class="type">String</span>, <span class="type">String</span>)) =&gt;&#123;</span><br><span class="line">        x._2.split(<span class="string">","</span>).map((word: <span class="type">String</span>) =&gt;(x._1,word))</span><br><span class="line">      &#125;)</span><br><span class="line">      .toDF(<span class="string">"date_time"</span>, <span class="string">"keyword"</span>)</span><br><span class="line">      .groupBy(<span class="string">"keyword"</span>).count()</span><br><span class="line">      .orderBy($<span class="string">"count"</span>.desc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> query: <span class="type">StreamingQuery</span> = keyvalue_df.writeStream</span><br><span class="line">      .outputMode(<span class="string">"complete"</span>) <span class="comment">//append</span></span><br><span class="line">      .format(<span class="string">"console"</span>)</span><br><span class="line">      .start()</span><br><span class="line"></span><br><span class="line">    query.awaitTermination()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>å…¶ä¸­éœ€è¦æ³¨æ„ï¼š<br>_<br>_Append output mode not supported when there are streaming aggregations on streaming DataFrames/DataSets without watermark;;_<br>_<br>Sorting is not supported on streaming DataFrames/Datasets, unless it is on aggregated DataFrame/Dataset in Complete output mode;<br><br>æœªè¿›è¡Œaggregateçš„streamä¸èƒ½sort<br>_<br>_ <a name="5prwS"></a> ### windowçª—å£ _<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.<span class="type">JSON</span></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.streaming.&#123;<span class="type">StreamingQuery</span>, <span class="type">Trigger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">structured_kafka_window</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> logger:<span class="type">Logger</span> = <span class="type">Logger</span>.getRootLogger</span><br><span class="line">  <span class="type">Logger</span>.getLogger(<span class="string">"org"</span>).setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">kafka_format</span>(<span class="params">date_time: <span class="type">String</span>, keyword_list: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">val</span> <span class="title">spark</span></span>: <span class="type">SparkSession</span> = <span class="type">SparkSession</span></span><br><span class="line">      .builder()</span><br><span class="line">      .appName(<span class="string">"Structrued-Streaming"</span>)</span><br><span class="line">      .master(<span class="string">"local[2]"</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> kafka_df: <span class="type">DataFrame</span> = spark</span><br><span class="line">      .readStream</span><br><span class="line">      .format(<span class="string">"kafka"</span>)</span><br><span class="line">      .option(<span class="string">"kafka.bootstrap.servers"</span>, <span class="string">"localhost:9092"</span>)</span><br><span class="line">      .option(<span class="string">"subscribe"</span>, <span class="string">"weibo_keyword"</span>)</span><br><span class="line">      .option(<span class="string">"startingOffsets"</span>, <span class="string">"latest"</span>)</span><br><span class="line">      .option(<span class="string">"includeTimestamp"</span>, value = <span class="literal">true</span>)</span><br><span class="line"><span class="comment">//      .option("endingOffsets", "latest")</span></span><br><span class="line"><span class="comment">//      .option("startingOffsets", """&#123;"topic1":&#123;"0":23,"1":-2&#125;,"topic2":&#123;"0":-2&#125;&#125;""")</span></span><br><span class="line"><span class="comment">//      .option("endingOffsets", """&#123;"topic1":&#123;"0":50,"1":-1&#125;,"topic2":&#123;"0":-1&#125;&#125;""")</span></span><br><span class="line">      .load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> keyvalue_df: <span class="type">DataFrame</span> = kafka_df</span><br><span class="line">      .selectExpr(<span class="string">"CAST(value AS STRING)"</span>)</span><br><span class="line">      .as[<span class="type">String</span>]</span><br><span class="line">      .map((x: <span class="type">String</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> date_time: <span class="type">String</span> = <span class="type">JSON</span>.parseObject(x).getString(<span class="string">"datetime"</span>)</span><br><span class="line">        <span class="keyword">val</span> keyword_list: <span class="type">String</span> = <span class="type">JSON</span>.parseObject(x).getString(<span class="string">"keywordList"</span>)</span><br><span class="line">        (date_time, keyword_list)</span><br><span class="line">      &#125;)</span><br><span class="line">      .flatMap((x: (<span class="type">String</span>, <span class="type">String</span>)) =&gt;&#123;</span><br><span class="line">        x._2.split(<span class="string">","</span>).map((word: <span class="type">String</span>) =&gt;(x._1,word))</span><br><span class="line">      &#125;)</span><br><span class="line">      .toDF(<span class="string">"date_time"</span>, <span class="string">"keyword"</span>)</span><br><span class="line">      .groupBy(window($<span class="string">"date_time"</span>, <span class="string">"5 minutes"</span>, <span class="string">"1 minutes"</span>),$<span class="string">"keyword"</span>)</span><br><span class="line">      .count()</span><br><span class="line">      .orderBy(<span class="string">"window"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> query: <span class="type">StreamingQuery</span> = keyvalue_df.writeStream</span><br><span class="line">      .outputMode(<span class="string">"complete"</span>) <span class="comment">//append</span></span><br><span class="line">      .format(<span class="string">"console"</span>)</span><br><span class="line">      .option(<span class="string">"truncate"</span>, <span class="string">"false"</span>)</span><br><span class="line">      .trigger(<span class="type">Trigger</span>.<span class="type">ProcessingTime</span>(<span class="string">"5 seconds"</span>))</span><br><span class="line">      .start()</span><br><span class="line">    query.awaitTermination()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>è¿™é‡Œå…³äºwindowçª—å£çš„åˆ’åˆ†ï¼Œæˆ‘å»ºè®®å¤§å®¶å¥½å¥½çš„ç ”è¯»ä¸€ä¸‹æºç ï¼š<br>**ä½ç½®ï¼špackage **org.apache.spark.sql.catalyst.analysis<br>![å±å¹•å¿«ç…§ 2020-05-08 ä¸‹åˆ11.29.50.png](https://cdn.nlark.com/yuque/0/2020/png/1072113/1588952005543-007c1291-12fd-4148-a625-587b1a6149f3.png#align=left&display=inline&height=1694&margin=%5Bobject%20Object%5D&name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-05-08%20%E4%B8%8B%E5%8D%8811.29.50.png&originHeight=1694&originWidth=1936&size=488433&status=done&style=none&width=1936)<br><p><a name="cuL0b"></a></p><h3 id="Watermark"><a href="#Watermark" class="headerlink" title="Watermark"></a>Watermark</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸºäºevent-timeçš„windowï¼ŒwordsåŒ…å«timestampå’Œwordä¸¤åˆ—</span></span><br><span class="line">word</span><br><span class="line">  .withWatermark(<span class="string">"timestamp"</span>, <span class="string">"30 minutes"</span>)<span class="comment">//æŸçª—å£ç»“æœä¸ºxï¼Œä½†æ˜¯éƒ¨åˆ†æ•°æ®åœ¨è¿™ä¸ªçª—å£çš„æœ€åä¸€ä¸ªtimestampè¿‡åè¿˜æ²¡åˆ°è¾¾ï¼ŒSparkåœ¨è¿™ä¼šç­‰30minï¼Œè¿‡åå°±ä¸å†æ›´æ–°xäº†ã€‚</span></span><br><span class="line">  .dropDuplicates(<span class="string">"User"</span>, <span class="string">"timestamp"</span>)</span><br><span class="line">  .groupBy(window(col(<span class="string">"timestamp"</span>), <span class="string">"10 minutes"</span>),col(<span class="string">"User"</span>))<span class="comment">// 10minåå†åŠ ä¸€ä¸ªå‚æ•°å˜ä¸ºSliding windowsï¼Œè¡¨ç¤ºæ¯éš”å¤šä¹…è®¡ç®—ä¸€æ¬¡ã€‚</span></span><br><span class="line">  .count() </span><br><span class="line">  .writeStream</span><br><span class="line">  .queryName(<span class="string">"events_per_window"</span>)</span><br><span class="line">  .format(<span class="string">"memory"</span>)</span><br><span class="line">  .outputMode(<span class="string">"complete"</span>)</span><br><span class="line">  .start()</span><br><span class="line"></span><br><span class="line">spark.sql(<span class="string">"SELECT * FROM events_per_window"</span>)</span><br></pre></td></tr></table></figure><p>watermark = max event time seen by the engine - late thresholdï¼Œç›¸å½“äºFlinkçš„BoundedOutOfOrdernessTximestampExtractorã€‚<br><br><br>åœ¨windowè®¡ç®—è¢«è§¦å‘æ—¶ï¼ŒSparkä¼šåˆ é™¤ç»“æŸæ—¶é—´ä½äºå½“å‰wmçš„windowçš„ä¸­é—´ç»“æœï¼Œå±äºè¯¥windowçš„è¿Ÿåˆ°æ•°æ®â€œå¯èƒ½â€ä¼šè¢«å¿½ç•¥ï¼Œè¶Šè¿Ÿè¶Šå¯èƒ½è¢«å¿½ç•¥ï¼Œåˆ é™¤å®Œåæ‰æ›´æ–°wmï¼Œæ‰€ä»¥å³ä¾¿ä¸‹ä¸€æ‰¹æ²¡æœ‰æ•°æ®åŠ å…¥ï¼ŒSparkæ‰€ä¾æ®çš„wmä¹Ÿæ˜¯æ–°çš„ï¼Œä¸‹ä¸‹ä¸€æ‰¹wmä¸å˜ã€‚<br><br><br>ä¸Šé¢æ˜¯update modeï¼Œå¦‚æœæ˜¯appendæ¨¡å¼ï¼Œé‚£ä¹ˆç»“æœè¦ç­‰åˆ°triggeråå‘ç°windowçš„ç»“æŸæ—¶é—´ä½äºæ›´æ–°åçš„æ°´ä½çº¿æ—¶æ‰ä¼šå‡ºæ¥ã€‚å¦å¤–ï¼Œmax event time seen by the engine - late thresholdæœºåˆ¶æ„å‘³ç€å¦‚æœä¸‹ä¸€æ‰¹è®¡ç®—æ²¡æœ‰æ›´æ™šçš„æ•°æ®åŠ å…¥ï¼Œé‚£ä¹ˆwmå°±ä¸ä¼šå‰è¿›ï¼Œé‚£ä¹ˆæ•°æ®çš„appendå°±ä¼šè¢«å»¶åã€‚<br><br><br>Conditions for watermarking to clean aggregation state(as of Spark 2.1.1, subject to change in the future)</p><ul><li>ä¸æ”¯æŒcompleteæ¨¡å¼ã€‚</li><li>groupByå¿…é¡»åŒ…å«timestampåˆ—æˆ–è€…window(col(timestamp))ï¼ŒwithWatermarkä¸­çš„åˆ—è¦å’Œå‰é¢çš„timestampåˆ—ç›¸åŒ</li><li>é¡ºåºå¿…é¡»æ˜¯å…ˆwithWatermarkå†åˆ°groupBy</li></ul><p><br>å‚è€ƒï¼š<br><a href="https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html" target="_blank" rel="external nofollow noopener noreferrer">ç»“æ„åŒ–æµç¼–ç¨‹æŒ‡å—</a><br><a href="https://www.cnblogs.com/code2one/p/9872355.html" target="_blank" rel="external nofollow noopener noreferrer">Sparkä¹‹Structured Streaming</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;a name=&quot;N4GjR&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2 id=&quot;æ€»è§ˆ&quot;&gt;&lt;a href=&quot;#æ€»è§ˆ&quot; class=&quot;headerlink&quot; tit
      
    
    </summary>
    
    
      <category term="å¤§æ•°æ®" scheme="cpeixin.cn/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    
      <category term="spark" scheme="cpeixin.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹  Let&#39;s go</title>
    <link href="cpeixin.cn/2019/01/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-Let-s-go/"/>
    <id>cpeixin.cn/2019/01/01/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-Let-s-go/</id>
    <published>2019-01-01T15:03:48.000Z</published>
    <updated>2020-05-06T16:54:06.970Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>å‰æ®µæ—¶é—´è®²äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ï¼Œåœ¨å®æˆ˜ä¸­ä¹Ÿäº†è§£äº†éšæœºæ£®æ—ã€é€»è¾‘å›å½’çš„æ¦‚å¿µåŠå·¥å…·ä½¿ç”¨ã€‚è¿™äº›ç®—æ³•éƒ½å±äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ä½ è‚¯å®šå¬è¯´è¿‡è¿™ä¸¤å¹´å¾ˆç«çš„æ·±åº¦å­¦ä¹ ï¼Œé‚£ä¹ˆæœºå™¨å­¦ä¹ ç®—æ³•å’Œæ·±åº¦å­¦ä¹ æœ‰ä»€ä¹ˆå…³è”å‘¢ï¼Ÿåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ–¹é¢äº†è§£æ·±åº¦å­¦ä¹ ï¼š</p><ol><li>æ•°æ®æŒ–æ˜ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿè¿™äº›æ¦‚å¿µéƒ½ä»£è¡¨ä»€ä¹ˆï¼Ÿ</li><li>æˆ‘ä»¬é€šè¿‡æ·±åº¦å­¦ä¹ è®©æœºå™¨å…·å¤‡äººçš„èƒ½åŠ›ï¼Œç”šè‡³æŸäº›æŠ€èƒ½çš„æ°´å¹³è¶…è¿‡äººç±»ï¼Œæ¯”å¦‚å›¾åƒè¯†åˆ«ã€ä¸‹æ£‹å¯¹å¼ˆç­‰ã€‚é‚£ä¹ˆæ·±åº¦å­¦ä¹ çš„å¤§è„‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</li><li>æ·±åº¦å­¦ä¹ æ˜¯åŸºäºç¥ç»ç½‘ç»œæ„å»ºçš„ï¼Œéƒ½æœ‰å“ªäº›å¸¸ç”¨çš„ç½‘ç»œæ¨¡å‹ï¼Ÿ</li><li>æ·±åº¦å­¦ä¹ æœ‰ä¸‰ä¸ªé‡è¦çš„åº”ç”¨é¢†åŸŸï¼Œè¿™ä¸‰ä¸ªåº”ç”¨é¢†åŸŸåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><p><a name="a1lJh"></a></p><h3 id="æ•°æ®æŒ–æ˜ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ•°æ®æŒ–æ˜ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ•°æ®æŒ–æ˜ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ•°æ®æŒ–æ˜ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><br>å®é™…ä¸Šæ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯é‡å çš„ã€‚ä¸€äº›å¸¸ç”¨ç®—æ³•ï¼Œæ¯”å¦‚ K-Meansã€KNNã€SVMã€å†³ç­–æ ‘å’Œæœ´ç´ è´å¶æ–¯ç­‰ï¼Œæ—¢å¯ä»¥è¯´æ˜¯æ•°æ®æŒ–æ˜ç®—æ³•ï¼Œåˆå¯ä»¥è¯´æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ã€‚é‚£ä¹ˆæ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæ•°æ®æŒ–æ˜é€šå¸¸æ˜¯ä»ç°æœ‰çš„æ•°æ®ä¸­æå–è§„å¾‹æ¨¡å¼ï¼ˆpatternï¼‰ä»¥åŠä½¿ç”¨ç®—æ³•æ¨¡å‹ï¼ˆmodelï¼‰ã€‚æ ¸å¿ƒç›®çš„æ˜¯æ‰¾åˆ°è¿™äº›æ•°æ®å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿä¼šé€šè¿‡æ•°æ®å¯è§†åŒ–å¯¹å˜é‡ä¹‹é—´çš„å…³ç³»è¿›è¡Œå‘ˆç°ï¼Œç”¨ç®—æ³•æ¨¡å‹æŒ–æ˜å˜é‡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªèƒ½åˆ¤æ–­å‡ºæ¥å˜é‡ A å’Œå˜é‡ B æ˜¯æœ‰å…³ç³»çš„ï¼Œä½†å¹¶ä¸ä¸€å®šæ¸…æ¥šè¿™ä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆå…·ä½“å…³ç³»ã€‚åœ¨æˆ‘ä»¬è°ˆè®ºæ•°æ®æŒ–æ˜çš„æ—¶å€™ï¼Œæ›´å¼ºè°ƒçš„æ˜¯ä»æ•°æ®ä¸­æŒ–æ˜ä»·å€¼ã€‚<br><br><br>æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæŒ‡çš„æ˜¯é€šè¿‡è®­ç»ƒæ•°æ®å’Œç®—æ³•æ¨¡å‹è®©æœºå™¨å…·æœ‰ä¸€å®šçš„æ™ºèƒ½ã€‚ä¸€èˆ¬æ˜¯é€šè¿‡å·²æœ‰çš„æ•°æ®æ¥å­¦ä¹ çŸ¥è¯†ï¼Œå¹¶é€šè¿‡å„ç§ç®—æ³•æ¨¡å‹å½¢æˆä¸€å®šçš„å¤„ç†èƒ½åŠ›ï¼Œæ¯”å¦‚åˆ†ç±»ã€èšç±»ã€é¢„æµ‹ã€æ¨èèƒ½åŠ›ç­‰ã€‚è¿™æ ·å½“æœ‰æ–°çš„æ•°æ®è¿›æ¥æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹è¿™äº›æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æœºå™¨çš„æ™ºèƒ½å¸®æˆ‘ä»¬å®ŒæˆæŸäº›ç‰¹å®šçš„ä»»åŠ¡ã€‚æ·±åº¦å­¦ä¹ å±äºæœºå™¨å­¦ä¹ çš„ä¸€ç§ï¼Œå®ƒçš„ç›®æ ‡åŒæ ·æ˜¯è®©æœºå™¨å…·æœ‰æ™ºèƒ½ï¼Œåªæ˜¯ä¸ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ä¸åŒï¼Œå®ƒæ˜¯é€šè¿‡ç¥ç»ç½‘ç»œæ¥å®ç°çš„ã€‚<br><br><br>ç¥ç»ç½‘ç»œå°±å¥½æ¯”æ˜¯æœºå™¨çš„å¤§è„‘ï¼Œåˆšå¼€å§‹å°±åƒä¸€ä¸ªå©´å„¿ä¸€æ ·ï¼Œæ˜¯ä¸€å¼ ç™½çº¸ã€‚ä½†é€šè¿‡å¤šæ¬¡è®­ç»ƒä¹‹åï¼Œâ€œå¤§è„‘â€å°±å¯ä»¥é€æ¸å…·å¤‡æŸç§èƒ½åŠ›ã€‚è¿™ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Šè¯‰è¿™ä¸ªå¤§è„‘è¾“å…¥æ•°æ®æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå¯¹åº”çš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆå³å¯ã€‚é€šè¿‡å¤šæ¬¡è®­ç»ƒï¼Œâ€œå¤§è„‘â€ä¸­çš„å¤šå±‚ç¥ç»ç½‘ç»œçš„å‚æ•°å°±ä¼šè‡ªåŠ¨ä¼˜åŒ–ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªé€‚åº”äºè®­ç»ƒæ•°æ®çš„æ¨¡å‹ã€‚æ‰€ä»¥ä½ èƒ½çœ‹åˆ°åœ¨ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šè®²è§£æ¨¡å‹çš„ç®—æ³•åŸç†ï¼Œæ¯”å¦‚ K-Means çš„ç®—æ³•åŸç†ï¼ŒKNN çš„åŸç†ç­‰ã€‚è€Œåˆ°äº†ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬æ›´å…³æ³¨çš„æ˜¯ç½‘ç»œç»“æ„ï¼Œä»¥åŠç½‘ç»œç»“æ„ä¸­æ¯å±‚ç¥ç»å…ƒçš„ä¼ è¾“æœºåˆ¶ã€‚æˆ‘ä»¬ä¸éœ€è¦å‘Šè¯‰æœºå™¨å…·ä½“çš„ç‰¹å¾è§„å¾‹æ˜¯ä»€ä¹ˆï¼Œåªéœ€æŠŠæˆ‘ä»¬æƒ³è¦è®­ç»ƒçš„æ•°æ®å’Œå¯¹åº”çš„ç»“æœå‘Šè¯‰æœºå™¨å¤§è„‘å³å¯ã€‚æ·±åº¦å­¦ä¹ ä¼šè‡ªå·±æ‰¾åˆ°æ•°æ®çš„ç‰¹å¾è§„å¾‹ï¼è€Œä¼ ç»Ÿæœºå™¨å­¦ä¹ å¾€å¾€éœ€è¦ä¸“å®¶ï¼ˆæˆ‘ä»¬ï¼‰æ¥å‘Šè¯‰æœºå™¨é‡‡ç”¨ä»€ä¹ˆæ ·çš„æ¨¡å‹ç®—æ³•ï¼Œè¿™å°±æ˜¯æ·±åº¦å­¦ä¹ ä¸ä¼ ç»Ÿæœºå™¨å­¦ä¹ æœ€å¤§çš„åŒºåˆ«ã€‚<br><br><br>å¦å¤–æ·±åº¦å­¦ä¹ çš„ç¥ç»ç½‘ç»œç»“æ„é€šå¸¸æ¯”è¾ƒæ·±ï¼Œä¸€èˆ¬éƒ½æ˜¯ 5 å±‚ä»¥ä¸Šï¼Œç”šè‡³ä¹Ÿæœ‰ 101 å±‚æˆ–æ›´å¤šçš„å±‚æ•°ã€‚è¿™äº›æ·±åº¦çš„ç¥ç»ç½‘ç»œå¯ä»¥è®©æœºå™¨æ›´å¥½åœ°è‡ªåŠ¨æ•è·æ•°æ®çš„ç‰¹å¾ã€‚<br><a name="FSGJb"></a></p><h3><a href="#" class="headerlink"></a></h3><p><a name="Eijqr"></a></p><h3 id="ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œçš„</h3><p><br>ç¥ç»ç½‘ç»œå¯ä»¥è¯´æ˜¯æœºå™¨çš„å¤§è„‘ï¼Œç»å…¸çš„ç¥ç»ç½‘ç»œç»“æ„å¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥è¡¨ç¤ºã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/1072113/1588344895471-60b8702d-0d33-4043-93a6-2fe227044890.jpeg#align=left&display=inline&height=1327&margin=%5Bobject%20Object%5D&name=image.jpeg&originHeight=1327&originWidth=2237&size=290312&status=done&style=none&width=2237" alt="image.jpeg"><br><br><br>è¿™é‡Œæœ‰ä¸€äº›æ¦‚å¿µä½ éœ€è¦äº†è§£ã€‚<br><br><br>èŠ‚ç‚¹ï¼šç¥ç»ç½‘ç»œæ˜¯ç”±ç¥ç»å…ƒç»„æˆçš„ï¼Œä¹Ÿç§°ä¹‹ä¸ºèŠ‚ç‚¹ï¼Œå®ƒä»¬åˆ†å¸ƒåœ¨ç¥ç»ç½‘ç»œçš„å„ä¸ªå±‚ä¸­ï¼Œè¿™äº›å±‚åŒ…æ‹¬è¾“å…¥å±‚ï¼Œè¾“å‡ºå±‚å’Œéšè—å±‚ã€‚<br><br><br>è¾“å…¥å±‚ï¼šè´Ÿè´£æ¥æ”¶ä¿¡å·ï¼Œå¹¶åˆ†å‘åˆ°éšè—å±‚ã€‚ä¸€èˆ¬æˆ‘ä»¬å°†æ•°æ®ä¼ ç»™è¾“å…¥å±‚ã€‚<br><br><br>è¾“å‡ºå±‚ï¼šè´Ÿè´£è¾“å‡ºè®¡ç®—ç»“æœï¼Œä¸€èˆ¬æ¥è¯´è¾“å‡ºå±‚èŠ‚ç‚¹æ•°ç­‰äºæˆ‘ä»¬è¦åˆ†ç±»çš„ä¸ªæ•°ã€‚<br><br><br>éšè—å±‚ï¼šé™¤äº†è¾“å…¥å±‚å’Œè¾“å‡ºå±‚å¤–çš„ç¥ç»ç½‘ç»œéƒ½å±äºéšè—å±‚ï¼Œéšè—å±‚å¯ä»¥æ˜¯ä¸€å±‚ä¹Ÿå¯ä»¥æ˜¯å¤šå±‚ï¼Œæ¯ä¸ªéšè—å±‚éƒ½ä¼šæŠŠå‰ä¸€å±‚èŠ‚ç‚¹ä¼ è¾“å‡ºæ¥çš„æ•°æ®è¿›è¡Œè®¡ç®—ï¼ˆä½ å¯ä»¥ç†è§£æ˜¯æŸç§æŠ½è±¡è¡¨ç¤ºï¼‰ï¼Œè¿™ç›¸å½“äºæŠŠæ•°æ®æŠ½è±¡åˆ°å¦ä¸€ä¸ªç»´åº¦çš„ç©ºé—´ä¸­ï¼Œå¯ä»¥æ›´å¥½åœ°æå–å’Œè®¡ç®—æ•°æ®çš„ç‰¹å¾ã€‚<br><br><br>å·¥ä½œåŸç†ï¼šç¥ç»ç½‘ç»œå°±å¥½æ¯”ä¸€ä¸ªé»‘ç›’å­ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Šè¯‰è¿™ä¸ªé»‘ç›’å­è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®ï¼Œç¥ç»ç½‘ç»œå°±å¯ä»¥è‡ªæˆ‘è®­ç»ƒã€‚ä¸€æ—¦è®­ç»ƒå¥½ä¹‹åï¼Œå°±å¯ä»¥åƒé»‘ç›’å­ä¸€æ ·ä½¿ç”¨ï¼Œå½“ä½ ä¼ å…¥ä¸€ä¸ªæ–°çš„æ•°æ®æ—¶ï¼Œå®ƒå°±ä¼šå‘Šè¯‰ä½ å¯¹åº”çš„è¾“å‡ºç»“æœã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç¥ç»ç½‘ç»œä¸»è¦æ˜¯é€šè¿‡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­æœºåˆ¶è¿ä½œçš„ã€‚<br><br><br>ä»€ä¹ˆæ˜¯å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­å‘¢ï¼Ÿ<br><br><br>å‰å‘ä¼ æ’­ï¼šæ•°æ®ä»è¾“å…¥å±‚ä¼ é€’åˆ°è¾“å‡ºå±‚çš„è¿‡ç¨‹å«åšå‰å‘ä¼ æ’­ã€‚è¿™ä¸ªè¿‡ç¨‹çš„è®¡ç®—ç»“æœé€šå¸¸æ˜¯é€šè¿‡ä¸Šä¸€å±‚çš„ç¥ç»å…ƒçš„è¾“å‡ºç»è¿‡çŸ©é˜µè¿ç®—å’Œæ¿€æ´»å‡½æ•°å¾—åˆ°çš„ã€‚è¿™æ ·å°±å®Œæˆäº†æ¯å±‚ä¹‹é—´çš„ç¥ç»å…ƒæ•°æ®çš„ä¼ è¾“ã€‚<br><br><br>åå‘ä¼ æ’­ï¼šå½“å‰å‘ä¼ æ’­ä½œç”¨åˆ°è¾“å‡ºå±‚å¾—åˆ°åˆ†ç±»ç»“æœä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸å®é™…å€¼è¿›è¡Œæ¯”å¯¹ï¼Œä»è€Œå¾—åˆ°è¯¯å·®ã€‚åå‘ä¼ æ’­ä¹Ÿå«ä½œè¯¯å·®åå‘ä¼ æ’­ï¼Œæ ¸å¿ƒåŸç†æ˜¯é€šè¿‡ä»£ä»·å‡½æ•°å¯¹ç½‘ç»œä¸­çš„å‚æ•°è¿›è¡Œä¿®æ­£ï¼Œè¿™æ ·æ›´å®¹æ˜“è®©ç½‘ç»œå‚æ•°å¾—åˆ°æ”¶æ•›ã€‚æ‰€ä»¥ï¼Œæ•´ä¸ªç¥ç»ç½‘ç»œè®­ç»ƒçš„è¿‡ç¨‹å°±æ˜¯ä¸æ–­åœ°é€šè¿‡å‰å‘ - åå‘ä¼ æ’­è¿­ä»£å®Œæˆçš„ï¼Œå½“è¾¾åˆ°æŒ‡å®šçš„è¿­ä»£æ¬¡æ•°æˆ–è€…è¾¾åˆ°æ”¶æ•›æ ‡å‡†çš„æ—¶å€™å³å¯ä»¥åœæ­¢è®­ç»ƒã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ‹¿è®­ç»ƒå¥½çš„ç½‘ç»œæ¨¡å‹å¯¹æ–°çš„æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚å½“ç„¶ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œæ˜¯åŸºäºç¥ç»ç½‘ç»œå‘å±•èµ·æ¥çš„ï¼Œå®ƒçš„åŸç†ä¸ç¥ç»ç½‘ç»œçš„åŸç†ä¸€æ ·ï¼Œåªä¸è¿‡å¼ºè°ƒäº†æ¨¡å‹ç»“æ„çš„æ·±åº¦ï¼Œé€šå¸¸æœ‰ 5 å±‚ä»¥ä¸Šï¼Œè¿™æ ·æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ä¼šæ›´å¼ºå¤§ã€‚å¸¸ç”¨çš„ç¥ç»ç½‘ç»œéƒ½æœ‰å“ªäº›æŒ‰ç…§ä¸­é—´å±‚åŠŸèƒ½çš„ä¸åŒï¼Œç¥ç»ç½‘ç»œå¯ä»¥åˆ†ä¸ºä¸‰ç§ç½‘ç»œç»“æ„ï¼Œåˆ†åˆ«ä¸º FNNã€CNN å’Œ RNNã€‚<br><br><br>FNNï¼ˆFully-connected Neural Networkï¼‰æŒ‡çš„æ˜¯å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œå…¨è¿æ¥çš„æ„æ€æ˜¯æ¯ä¸€å±‚çš„ç¥ç»å…ƒä¸ä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒéƒ½æ˜¯è¿æ¥çš„ã€‚ä¸è¿‡åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå…¨è¿æ¥çš„å‚æ•°ä¼šè¿‡å¤šï¼Œå¯¼è‡´è®¡ç®—é‡è¿‡å¤§ã€‚å› æ­¤åœ¨å®é™…ä½¿ç”¨ä¸­å…¨è¿æ¥ç¥ç»ç½‘ç»œçš„å±‚æ•°ä¸€èˆ¬æ¯”è¾ƒå°‘ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/1072113/1588344980493-f83f763c-164a-4c40-9f68-cc8f9368eea5.jpeg#align=left&display=inline&height=1355&margin=%5Bobject%20Object%5D&name=c2bfd532360e5cc026aa12f45c86957a.jpg&originHeight=1355&originWidth=2448&size=424117&status=done&style=none&width=2448" alt="c2bfd532360e5cc026aa12f45c86957a.jpg"></p><p>CNN å«ä½œå·ç§¯ç¥ç»ç½‘ç»œï¼Œåœ¨å›¾åƒå¤„ç†ä¸­æœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œäº†è§£å›¾åƒè¯†åˆ«çš„åŒå­¦å¯¹è¿™ä¸ªè¯ä¸€å®šä¸é™Œç”Ÿã€‚CNN ç½‘ç»œä¸­ï¼ŒåŒ…æ‹¬äº†å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ã€‚è¿™ä¸‰ä¸ªå±‚éƒ½æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿå·ç§¯å±‚ç›¸å½“äºä¸€ä¸ªæ»¤é•œçš„ä½œç”¨ï¼Œå®ƒå¯ä»¥æŠŠå›¾åƒè¿›è¡Œåˆ†å—ï¼Œå¯¹æ¯ä¸€å—çš„å›¾åƒè¿›è¡Œå˜æ¢æ“ä½œã€‚æ± åŒ–å±‚ç›¸å½“äºå¯¹ç¥ç»å…ƒçš„æ•°æ®è¿›è¡Œé™ç»´å¤„ç†ï¼Œè¿™æ ·è¾“å‡ºçš„ç»´æ•°å°±ä¼šå‡å°‘å¾ˆå¤šï¼Œä»è€Œé™ä½æ•´ä½“çš„è®¡ç®—é‡ã€‚å…¨è¿æ¥å±‚é€šå¸¸æ˜¯è¾“å‡ºå±‚çš„ä¸Šä¸€å±‚ï¼Œå®ƒå°†ä¸Šä¸€å±‚ç¥ç»å…ƒè¾“å‡ºçš„æ•°æ®è½¬å˜æˆä¸€ç»´çš„å‘é‡ã€‚<br><br><br>RNN ç§°ä¸ºå¾ªç¯ç¥ç»ç½‘ç»œï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ç¥ç»å…ƒçš„è¾“å‡ºå¯ä»¥åœ¨ä¸‹ä¸€ä¸ªæ—¶åˆ»ä½œç”¨åˆ°è‡ªèº«ï¼Œè¿™æ · RNN å°±å¯ä»¥çœ‹åšæ˜¯åœ¨æ—¶é—´ä¸Šä¼ é€’çš„ç¥ç»ç½‘ç»œã€‚å®ƒå¯ä»¥åº”ç”¨åœ¨è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„åœºæ™¯ã€‚æ·±åº¦å­¦ä¹ ç½‘ç»œå¾€å¾€åŒ…æ‹¬äº†è¿™ä¸‰ç§ç½‘ç»œçš„å˜ç§å½¢æˆï¼Œå¸¸ç”¨çš„æ·±åº¦ç¥ç»ç½‘ç»œåŒ…æ‹¬ AlexNetã€VGG19ã€GoogleNetã€ResNet ç­‰ï¼Œæˆ‘æ€»ç»“äº†è¿™äº›ç½‘ç»œçš„ç‰¹ç‚¹ï¼Œä½ å¯ä»¥çœ‹ä¸‹ï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1588344996865-24933d1e-03b9-4fe1-9255-402068146252.png#align=left&display=inline&height=205&margin=%5Bobject%20Object%5D&name=490ced74dc6cf70403e73c05f302449f.png&originHeight=205&originWidth=560&size=33554&status=done&style=none&width=560" alt="490ced74dc6cf70403e73c05f302449f.png"><br>ä½ èƒ½çœ‹å‡ºéšç€æ—¶é—´çš„æ¨è¿›ï¼Œæå‡ºçš„æ·±åº¦å­¦ä¹ ç½‘ç»œå±‚æ•°è¶Šæ¥è¶Šæ·±ï¼ŒTop-5 é”™è¯¯ç‡è¶Šæ¥è¶Šä½ã€‚ä½ å¯èƒ½ä¼šé—®ä»€ä¹ˆæ˜¯ Top-5 é”™è¯¯ç‡ï¼Œå®é™…ä¸Šè¿™äº›ç½‘ç»œç»“æ„çš„æå‡ºå’Œä¸€ä¸ªæ¯”èµ›ç›¸å…³ï¼Œè¿™ä¸ªæ¯”èµ›å«åš ILSVRCï¼Œè‹±æ–‡å…¨ç§°å«åš Large Scale Visual Recognition Challengeã€‚å®ƒæ˜¯ä¸€ä¸ªå…³äºå¤§è§„æ¨¡å›¾åƒå¯è§†åŒ–è¯†åˆ«çš„æ¯”èµ›ï¼Œæ‰€åŸºäºçš„æ•°æ®é›†å°±æ˜¯è‘—åçš„ ImageNet æ•°æ®é›†ï¼Œä¸€å…±åŒ…æ‹¬äº† 1400 ä¸‡å¼ å›¾ç‰‡ï¼Œæ¶µç›– 2 ä¸‡å¤šä¸ªç±»åˆ«ã€‚è¡¨æ ¼ä¸­çš„ AlexNet å°±æ˜¯ 2012 å¹´çš„ ILSVRC å† å†›ï¼Œå½“æ—¶çš„ Top-5 æ­£ç¡®ç‡æ˜¯ 84.7%ï¼ŒVGG å’Œ GoogleNet æ˜¯ 2014 å¹´ ILSVRC æ¯”èµ›çš„æ¨¡å‹ï¼Œå…¶ä¸­ GoogleNet æ˜¯å½“æ—¶æ¯”èµ›çš„å† å†›ï¼Œè€Œ VGG æ˜¯å½“æ—¶æ¯”èµ›çš„äºšå†›ï¼Œå®ƒçš„æ•ˆç‡ä½äº GoogleNetã€‚VGG æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒVGG16 å’Œ VGG19ï¼Œåˆ†åˆ«æ˜¯ 16 å±‚å’Œ 19 å±‚çš„ VGG ç½‘ç»œï¼Œè¿™ä¸¤è€…æ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œåªæ˜¯ç½‘ç»œæ·±åº¦ä¸åŒã€‚åˆ°äº† 2015 å¹´ï¼Œæ¯”èµ›å† å†›æ˜¯ ResNetï¼ŒTop-5 æ­£ç¡®ç‡è¾¾åˆ°äº† 96.43%ã€‚ResNet ä¹Ÿæœ‰ä¸åŒçš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ ResNet50ã€ResNet101 å’Œ ResNet152 ç­‰ï¼Œåç§°åé¢çš„æ•°å­—ä»£è¡¨çš„æ˜¯ä¸åŒçš„ç½‘ç»œæ·±åº¦ã€‚ä¹‹å ResNet åœ¨å…¶ä»–å›¾åƒæ¯”èµ›ä¸­ä¹Ÿå¤šæ¬¡æ‹¿åˆ°å† å†›ã€‚<br></p><p><a name="OxXl6"></a></p><h3 id="æ·±åº¦å­¦ä¹ çš„åº”ç”¨é¢†åŸŸ"><a href="#æ·±åº¦å­¦ä¹ çš„åº”ç”¨é¢†åŸŸ" class="headerlink" title="æ·±åº¦å­¦ä¹ çš„åº”ç”¨é¢†åŸŸ"></a>æ·±åº¦å­¦ä¹ çš„åº”ç”¨é¢†åŸŸ</h3><p><br>ä» ImageNet è·‘å‡ºæ¥çš„è¿™äº›ä¼˜ç§€æ¨¡å‹éƒ½æ˜¯åŸºäº CNN å·ç§¯ç¥ç»ç½‘ç»œçš„ã€‚å®é™…ä¸Šæ·±åº¦å­¦ä¹ æœ‰ä¸‰å¤§åº”ç”¨é¢†åŸŸï¼Œå›¾åƒè¯†åˆ«å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå…¶ä»–é¢†åŸŸåˆ†åˆ«æ˜¯è¯­éŸ³è¯†åˆ«å’Œè‡ªç„¶è¯­è¨€å¤„ç†ã€‚è¿™ä¸‰ä¸ªåº”ç”¨é¢†åŸŸæœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹æ€§ï¼Œå°±æ˜¯éƒ½æ¥è‡ªäºä¿¡å·å¤„ç†ã€‚æˆ‘ä»¬äººç±»å¹³æ—¶ä¼šå¤„ç†å›¾åƒä¿¡æ¯ï¼Œè¯­éŸ³ä¿¡æ¯ä»¥åŠè¯­è¨€æ–‡å­—ä¿¡æ¯ã€‚æœºå™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä¸‰ä¸ªåº”ç”¨é‡Œçš„æŸäº›å·¥ä½œã€‚<br><br><br>æ¯”å¦‚å›¾åƒè¯†åˆ«é¢†åŸŸä¸­å›¾åƒåˆ†ç±»å’Œç‰©ä½“æ£€æµ‹å°±æ˜¯ä¸¤ä¸ªæ ¸å¿ƒçš„ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥è®©æœºå™¨åˆ¤æ–­å›¾åƒä¸­éƒ½æœ‰å“ªäº›ç‰©ä½“ï¼Œç±»åˆ«æ˜¯ä»€ä¹ˆï¼Œä»¥åŠè¿™äº›ç‰©ä½“æ‰€å¤„çš„ä½ç½®ã€‚å›¾åƒè¯†åˆ«è¢«å¹¿æ³›åº”ç”¨åœ¨å®‰é˜²æ£€æµ‹ä¸­ã€‚æ­¤å¤–äººè„¸è¯†åˆ«ä¹Ÿæ˜¯å›¾åƒè¯†åˆ«é‡è¦çš„åº”ç”¨åœºæ™¯ã€‚Siri å¤§å®¶ä¸€å®šä¸é™Œç”Ÿï¼Œæ­¤å¤–è¿˜æœ‰æˆ‘ä»¬ä½¿ç”¨çš„æ™ºèƒ½ç”µè§†ç­‰ï¼Œéƒ½é‡‡ç”¨äº†è¯­éŸ³è¯†åˆ«æŠ€æœ¯ã€‚è¯­éŸ³è¯†åˆ«æŠ€æœ¯å¯ä»¥è¯†åˆ«äººç±»çš„è¯­éŸ³æŒ‡ä»¤å¹¶è¿›è¡Œäº¤äº’ã€‚åœ¨è¯­éŸ³å¯¼èˆªä¸­ï¼Œè¿˜é‡‡ç”¨äº†è¯­éŸ³åˆæˆæŠ€æœ¯ï¼Œè¿™æ ·å°±å¯ä»¥è®©æœºå™¨æ¨¡æ‹Ÿäººçš„å£°éŸ³ä¸ºæˆ‘ä»¬æœåŠ¡ï¼ŒSiri è¯­éŸ³åŠ©æ‰‹ä¹Ÿé‡‡ç”¨äº†è¯­éŸ³è¯†åˆ«å’Œåˆæˆçš„æŠ€æœ¯ã€‚è‡ªç„¶è¯­è¨€å¤„ç†çš„è‹±æ–‡ç¼©å†™æ˜¯ NLPï¼Œå®ƒè¢«å¹¿æ³›åº”ç”¨åˆ°è‡ªåŠ¨é—®ç­”ã€æ™ºèƒ½å®¢æœã€è¿‡æ»¤åƒåœ¾é‚®ä»¶å’ŒçŸ­ä¿¡ç­‰é¢†åŸŸä¸­ã€‚åœ¨ç”µå•†é¢†åŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ NLP è‡ªåŠ¨ç»™å•†å“è¯„è®ºæ‰“æ ‡ç­¾ï¼Œåœ¨ç”¨æˆ·å†³ç­–çš„æ—¶å€™æä¾›æ•°æ®æ”¯æŒã€‚åœ¨è‡ªåŠ¨é—®ç­”ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥è‡ªå·±æƒ³é—®çš„é—®é¢˜ï¼Œè®©æœºå™¨æ¥å›ç­”ï¼Œæ¯”å¦‚åœ¨ç™¾åº¦ä¸­è¾“å…¥â€œå§šæ˜çš„è€å©†â€ï¼Œå°±ä¼šè‡ªåŠ¨æ˜¾ç¤ºå‡ºâ€å¶è‰â€œã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1588345111082-f2216446-9de9-4195-aebd-d2be302b80db.png#align=left&display=inline&height=700&margin=%5Bobject%20Object%5D&name=image.png&originHeight=700&originWidth=1729&size=364371&status=done&style=none&width=1729" alt="image.png"><br><br><br>æ­¤å¤–è¿™äº›æŠ€æœ¯è¿˜å¯ä»¥ç›¸äº’ç»„åˆä¸ºæˆ‘ä»¬æä¾›æœåŠ¡ï¼Œæ¯”å¦‚åœ¨æ— äººé©¾é©¶ä¸­å°±é‡‡ç”¨äº†å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ç­‰æŠ€æœ¯ã€‚åœ¨è¶…å¸‚è´­ç‰©ä¸­ä¹Ÿé‡‡ç”¨äº†é›†æˆå›¾åƒè¯†åˆ«ã€æ„å›¾è¯†åˆ«ç­‰æŠ€æœ¯ç­‰ã€‚<br></p><p><a name="HkLRt"></a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><br>ä»Šå¤©æˆ‘ä»¬å¤§æ¦‚äº†è§£äº†ä¸€ä¸‹æ·±åº¦å­¦ä¹ ã€‚æ·±åº¦å­¦ä¹ ä¹Ÿæ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ç§ã€‚æˆ‘ä»¬ä¹‹å‰è®²è§£äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ï¼Œè¿˜æœ‰é€»è¾‘å›å½’ã€éšæœºæ£®æ—ç®—æ³•ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚ä½†æ˜¯å¯¹äºæ•°æ®é‡æ›´å¤§ï¼Œæ›´å¼€æ”¾æ€§çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨æ·±åº¦å­¦ä¹ çš„ç®—æ³•ï¼Œè®©æœºå™¨è‡ªå·±æ¥æ‰¾è§„å¾‹ï¼Œè€Œä¸æ˜¯é€šè¿‡æˆ‘ä»¬æŒ‡å®šçš„ç®—æ³•æ¥æ‰¾åˆ†ç±»è§„å¾‹ã€‚æ‰€ä»¥æ·±åº¦å­¦ä¹ çš„æ™®é€‚æ€§ä¼šæ›´å¼ºä¸€äº›ï¼Œä½†ä¹Ÿå¹¶ä¸ä»£è¡¨æ·±åº¦å­¦ä¹ å°±ä¼˜äºæœºå™¨å­¦ä¹ ã€‚<br><br><br>ä¸€æ–¹é¢æ·±åº¦å­¦ä¹ éœ€è¦å¤§é‡çš„æ•°æ®ï¼Œå¦ä¸€æ–¹é¢æ·±åº¦å­¦ä¹ çš„å­¦ä¹ æ—¶é—´ï¼Œå’Œéœ€è¦çš„è®¡ç®—èµ„æºéƒ½è¦å¤§äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ã€‚ä½ èƒ½çœ‹åˆ°å„ç§æ·±åº¦å­¦ä¹ çš„è®­ç»ƒé›†ä¸€èˆ¬éƒ½è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ¯”å¦‚ ImageNet å°±åŒ…æ‹¬äº† 1400 ä¸‡å¼ å›¾ç‰‡ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰æä¾›å¤§é‡çš„è®­ç»ƒæ•°æ®ï¼Œè®­ç»ƒå‡ºæ¥çš„æ·±åº¦æ¨¡å‹è¯†åˆ«ç»“æœæœªå¿…å¥½äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ã€‚<br><br><br>å®é™…ä¸Šç¥ç»ç½‘ç»œæœ€æ—©æ˜¯åœ¨ 1986 å¹´æå‡ºæ¥çš„ï¼Œä¹‹åä¸æ¸©ä¸ç«ï¼Œç›´åˆ° ImageNet äº 2009 å¹´æå‡ºï¼Œåœ¨ 2010 å¹´å¼€å§‹ä¸¾åŠæ¯å¹´çš„ ImageNet å¤§è§„æ¨¡è§†è§‰è¯†åˆ«æŒ‘æˆ˜èµ›ï¼ˆILSVRCï¼‰ï¼Œæ·±åº¦å­¦ä¹ æ‰å¾—åˆ°è¿…çŒ›å‘å±•ã€‚2016 å¹´ Google ç ”å‘çš„ AlphaGo å‡»è´¥äº†äººç±»å† å†›æä¸–çŸ³ï¼Œæ›´æ˜¯è®©äººä»¬çœ‹åˆ°äº†æ·±åº¦å­¦ä¹ çš„åŠ›é‡ã€‚ä¸€ä¸ªå¥½é—®é¢˜çš„æå‡ºï¼Œå¯ä»¥æ¿€å‘æ— ç©·çš„èƒ½é‡ï¼Œè¿™æ˜¯ç§‘æŠ€è¿›æ­¥çš„æºæ³‰ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ç§‘å­¦ä¸Šï¼Œæˆ‘ä»¬ä¼šæœ‰å„ç§å…¬å¼€çš„æ•°æ®é›†ã€‚ä¸€ä¸ªå¥½çš„æ•°æ®é›†å°±ä»£è¡¨äº†ä¸€ä¸ªå¥½çš„é—®é¢˜å’Œä½¿ç”¨åœºæ™¯ã€‚æ­£æ˜¯è¿™äº›éœ€æ±‚çš„å‡ºç°ï¼Œæ‰èƒ½è®©æˆ‘ä»¬çš„ç®—æ³•æœ‰æ›´å¥½çš„ç”¨æ­¦ä¹‹åœ°ï¼ŒåŒæ—¶ä¹Ÿæœ‰äº†å„ç§ç®—æ³•ç›¸äº’æ¯”æ‹¼çš„å¹³å°ã€‚</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;å‰æ®µæ—¶é—´è®²äº†æ•°æ®æŒ–æ˜åå¤§ç»å…¸ç®—æ³•ï¼Œåœ¨å®æˆ˜ä¸­ä¹Ÿäº†è§£äº†éšæœºæ£®æ—ã€é€»è¾‘å›å½’çš„æ¦‚å¿µåŠå·¥å…·ä½¿ç”¨ã€‚è¿™äº›ç®—æ³•éƒ½å±äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ä½ è‚¯å®šå¬è¯´è¿‡è¿™ä¸¤å¹´å¾ˆç«çš„
      
    
    </summary>
    
    
      <category term="æ·±åº¦å­¦ä¹ " scheme="cpeixin.cn/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ·±åº¦å­¦ä¹ " scheme="cpeixin.cn/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>æ¯”ç‰¹å¸èµ°åŠ¿é¢„æµ‹</title>
    <link href="cpeixin.cn/2018/10/05/%E6%AF%94%E7%89%B9%E5%B8%81%E8%B5%B0%E5%8A%BF%E9%A2%84%E6%B5%8B/"/>
    <id>cpeixin.cn/2018/10/05/%E6%AF%94%E7%89%B9%E5%B8%81%E8%B5%B0%E5%8A%BF%E9%A2%84%E6%B5%8B/</id>
    <published>2018-10-04T16:43:58.000Z</published>
    <updated>2020-05-01T14:21:22.500Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>æˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†æ•°æ®æŒ–æ˜ç®—æ³•ä¸­çš„åˆ†ç±»ã€èšç±»ã€å›å½’å’Œå…³è”åˆ†æç®—æ³•ï¼Œé‚£ä¹ˆå¯¹äºæ¯”ç‰¹å¸èµ°åŠ¿çš„é¢„æµ‹ï¼Œé‡‡ç”¨å“ªç§æ–¹æ³•æ¯”è¾ƒå¥½å‘¢ï¼Ÿ<br><br><br>å¯èƒ½æœ‰äº›äººä¼šè®¤ä¸ºé‡‡ç”¨å›å½’åˆ†æä¼šå¥½ä¸€äº›ï¼Œå› ä¸ºé¢„æµ‹çš„ç»“æœæ˜¯è¿ç»­çš„æ•°å€¼ç±»å‹ã€‚å®é™…ä¸Šï¼Œæ•°æ®æŒ–æ˜ç®—æ³•è¿˜æœ‰ä¸€ç§å«æ—¶é—´åºåˆ—åˆ†æçš„ç®—æ³•ï¼Œæ—¶é—´åºåˆ—åˆ†ææ¨¡å‹å»ºç«‹äº†è§‚å¯Ÿç»“æœä¸æ—¶é—´å˜åŒ–çš„å…³ç³»ï¼Œèƒ½å¸®æˆ‘ä»¬é¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´å†…çš„ç»“æœå˜åŒ–æƒ…å†µã€‚é‚£ä¹ˆæ—¶é—´åºåˆ—åˆ†æå’Œå›å½’åˆ†ææœ‰å“ªäº›åŒºåˆ«å‘¢ï¼Ÿ<br><br><br>é¦–å…ˆï¼Œåœ¨é€‰æ‹©æ¨¡å‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šç»“æœä¸å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å›å½’åˆ†æè®­ç»ƒå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡ y ä¸è‡ªå˜é‡ xï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰çš„ç›¸å…³æ€§ï¼Œç„¶åé€šè¿‡æ–°çš„è‡ªå˜é‡ x æ¥é¢„æµ‹ç›®æ ‡å˜é‡ yã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡ y ä¸æ—¶é—´çš„ç›¸å…³æ€§ã€‚<br><br><br>å¦å¤–ï¼Œå›å½’åˆ†ææ“…é•¿çš„æ˜¯å¤šå˜é‡ä¸ç›®æ ‡ç»“æœä¹‹é—´çš„åˆ†æï¼Œå³ä¾¿æ˜¯å•ä¸€å˜é‡ï¼Œä¹Ÿå¾€å¾€ä¸æ—¶é—´æ— å…³ã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå»ºç«‹åœ¨æ—¶é—´å˜åŒ–çš„åŸºç¡€ä¸Šï¼Œå®ƒä¼šåˆ†æç›®æ ‡å˜é‡çš„è¶‹åŠ¿ã€å‘¨æœŸã€æ—¶æœŸå’Œä¸ç¨³å®šå› ç´ ç­‰ã€‚è¿™äº›è¶‹åŠ¿å’Œå‘¨æœŸéƒ½æ˜¯åœ¨æ—¶é—´ç»´åº¦çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¦è§‚å¯Ÿçš„é‡è¦ç‰¹å¾ã€‚<br><br><br>é‚£ä¹ˆé’ˆå¯¹ä»Šå¤©è¦è¿›è¡Œçš„é¢„æµ‹æ¯”ç‰¹å¸èµ°åŠ¿çš„é¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŒæ¡å“ªäº›ç›®æ ‡å‘¢ï¼Ÿ</p><ol><li>äº†è§£æ—¶é—´åºåˆ—é¢„æµ‹çš„æ¦‚å¿µï¼Œä»¥åŠå¸¸ç”¨çš„æ¨¡å‹ç®—æ³•ï¼ŒåŒ…æ‹¬ ARã€MAã€ARMAã€ARIMA æ¨¡å‹ç­‰ï¼›</li><li>æŒæ¡å¹¶ä½¿ç”¨ ARMA æ¨¡å‹å·¥å…·ï¼Œå¯¹ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œå»ºæ¨¡å’Œé¢„æµ‹ï¼›</li><li>å¯¹æ¯”ç‰¹å¸çš„å†å²æ•°æ®è¿›è¡Œæ—¶é—´åºåˆ—å»ºæ¨¡ï¼Œå¹¶é¢„æµ‹æœªæ¥ 6 ä¸ªæœˆçš„èµ°åŠ¿ã€‚</li></ol><p><a name="cFXtt"></a></p><h3 id="æ—¶é—´åºåˆ—é¢„æµ‹"><a href="#æ—¶é—´åºåˆ—é¢„æµ‹" class="headerlink" title="æ—¶é—´åºåˆ—é¢„æµ‹"></a>æ—¶é—´åºåˆ—é¢„æµ‹</h3><p>å…³äºæ—¶é—´åºåˆ—ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºæŒ‰ç…§æ—¶é—´é¡ºåºç»„æˆçš„æ•°å­—åºåˆ—ã€‚å®é™…ä¸Šåœ¨ä¸­å›½å¤ä»£çš„å†œä¸šç¤¾ä¼šä¸­ï¼Œäººä»¬å°±å°†ä¸€å¹´ä¸­ä¸åŒæ—¶é—´èŠ‚ç‚¹å’Œå¤©æ°”çš„è§„å¾‹æ€»ç»“äº†ä¸‹æ¥ï¼Œå½¢æˆäº†äºŒåå››èŠ‚æ°”ï¼Œä¹Ÿå°±æ˜¯ä»æ—¶é—´åºåˆ—ä¸­è§‚å¯Ÿå¤©æ°”å’Œå¤ªé˜³çš„è§„å¾‹ï¼ˆåªæ˜¯å½“æ—¶æ²¡æœ‰æ—¶é—´åºåˆ—æ¨¡å‹å’Œç›¸åº”å·¥å…·ï¼‰ï¼Œä»è€Œä½¿å¾—å†œä¸šå¾—åˆ°è¿…é€Ÿå‘å±•ã€‚</p><p>åœ¨ç°ä»£ç¤¾ä¼šï¼Œæ—¶é—´åºåˆ—åœ¨é‡‘èã€ç»æµã€å•†ä¸šé¢†åŸŸæ‹¥æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚åœ¨æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ä¸­ï¼Œæœ‰ä¸€äº›ç»å…¸çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬ ARã€MAã€ARMAã€ARIMAã€‚æˆ‘æ¥ç»™ä½ ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p><p>AR çš„è‹±æ–‡å…¨ç§°å«åš Auto Regressiveï¼Œä¸­æ–‡å«è‡ªå›å½’æ¨¡å‹ã€‚è¿™ä¸ªç®—æ³•çš„æ€æƒ³æ¯”è¾ƒç®€å•ï¼Œå®ƒè®¤ä¸ºè¿‡å»è‹¥å¹²æ—¶åˆ»çš„ç‚¹é€šè¿‡çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°å°±å¯ä»¥é¢„æµ‹æœªæ¥æŸä¸ªæ—¶åˆ»çš„ç‚¹ã€‚åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ç¯å¢ƒä¸­å°±å­˜åœ¨ç™½å™ªå£°ï¼Œåœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªæœŸæœ›ä¸º 0ï¼Œæ–¹å·®ä¸ºå¸¸æ•°çš„çº¯éšæœºè¿‡ç¨‹ã€‚AR æ¨¡å‹è¿˜å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARï¼ˆpï¼‰æ¨¡å‹ï¼Œä¹Ÿå«ä½œ p é˜¶è‡ªå›å½’æ¨¡å‹ã€‚å®ƒæŒ‡çš„æ˜¯é€šè¿‡è¿™ä¸ªæ—¶åˆ»ç‚¹çš„å‰ p ä¸ªç‚¹ï¼Œé€šè¿‡çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°æ¥é¢„æµ‹å½“å‰æ—¶åˆ»ç‚¹çš„å€¼ã€‚</p><p>MA çš„è‹±æ–‡å…¨ç§°å«åš Moving Averageï¼Œä¸­æ–‡å«åšæ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚å®ƒä¸ AR æ¨¡å‹å¤§åŒå°å¼‚ï¼ŒAR æ¨¡å‹æ˜¯å†å²æ—¶åºå€¼çš„çº¿æ€§ç»„åˆï¼ŒMA æ˜¯é€šè¿‡å†å²ç™½å™ªå£°è¿›è¡Œçº¿æ€§ç»„åˆæ¥å½±å“å½“å‰æ—¶åˆ»ç‚¹ã€‚AR æ¨¡å‹ä¸­çš„å†å²ç™½å™ªå£°æ˜¯é€šè¿‡å½±å“å†å²æ—¶åºå€¼ï¼Œä»è€Œé—´æ¥å½±å“åˆ°å½“å‰æ—¶åˆ»ç‚¹çš„é¢„æµ‹å€¼ã€‚åŒæ · MA æ¨¡å‹ä¹Ÿå­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º MA(q) æ¨¡å‹ï¼Œä¹Ÿå«ä½œ q é˜¶ç§»åŠ¨å¹³å‡æ¨¡å‹ã€‚æˆ‘ä»¬èƒ½çœ‹åˆ° AR å’Œ MA æ¨¡å‹éƒ½å­˜åœ¨é˜¶æ•°ï¼Œåœ¨ AR æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ç”¨ p è¡¨ç¤ºï¼Œåœ¨ MA æ¨¡å‹ä¸­æˆ‘ä»¬ç”¨ q è¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹å¤§åŒå°å¼‚ï¼Œä¸ AR æ¨¡å‹ä¸åŒçš„æ˜¯ MA æ¨¡å‹æ˜¯å†å²ç™½å™ªå£°çš„çº¿æ€§ç»„åˆã€‚</p><p>ARMA çš„è‹±æ–‡å…¨ç§°æ˜¯ Auto Regressive Moving Averageï¼Œä¸­æ–‡å«åšè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ AR æ¨¡å‹å’Œ MA æ¨¡å‹çš„æ··åˆã€‚ç›¸æ¯” AR æ¨¡å‹å’Œ MA æ¨¡å‹ï¼Œå®ƒæœ‰æ›´å‡†ç¡®çš„ä¼°è®¡ã€‚åŒæ · ARMA æ¨¡å‹å­˜åœ¨ p å’Œ q ä¸¤ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARMA(p,q) æ¨¡å‹ã€‚</p><p>ARIMA çš„è‹±æ–‡å…¨ç§°æ˜¯ Auto Regressive Integrated Moving Average æ¨¡å‹ï¼Œä¸­æ–‡å«å·®åˆ†è‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå«æ±‚åˆè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚ç›¸æ¯”äº ARMAï¼ŒARIMA å¤šäº†ä¸€ä¸ªå·®åˆ†çš„è¿‡ç¨‹ï¼Œä½œç”¨æ˜¯å¯¹ä¸å¹³ç¨³æ•°æ®è¿›è¡Œå·®åˆ†å¹³ç¨³ï¼Œåœ¨å·®åˆ†å¹³ç¨³åå†è¿›è¡Œå»ºæ¨¡ã€‚ARIMA çš„åŸç†å’ŒARMA æ¨¡å‹ä¸€æ ·ã€‚ç›¸æ¯”äº ARMA(p,q) çš„ä¸¤ä¸ªé˜¶æ•°ï¼ŒARIMA æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„çš„é˜¶æ•° (p,d,q)ï¼Œç§°ä¸º ARIMA(p,d,q) æ¨¡å‹ã€‚å…¶ä¸­ d æ˜¯å·®åˆ†é˜¶æ•°ã€‚<br><br><br></p><p><a name="3RhDh"></a></p><h3 id="ARMA-æ¨¡å‹å·¥å…·"><a href="#ARMA-æ¨¡å‹å·¥å…·" class="headerlink" title="ARMA æ¨¡å‹å·¥å…·"></a>ARMA æ¨¡å‹å·¥å…·</h3><p>ä¸Šé¢ä»‹ç»çš„ ARï¼ŒMAï¼ŒARMAï¼ŒARIMA å››ç§æ¨¡å‹ï¼Œä½ åªéœ€è¦äº†è§£åŸºç¡€æ¦‚å¿µå³å¯ï¼Œä¸­é—´æ¶‰åŠåˆ°çš„ä¸€äº›æ•°å­¦å…¬å¼è¿™é‡Œä¸è¿›è¡Œå±•å¼€ã€‚åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ›´å¤šçš„æ˜¯ä½¿ç”¨å·¥å…·ï¼Œæˆ‘åœ¨è¿™é‡Œä¸»è¦è®²è§£ä¸‹å¦‚ä½•ä½¿ç”¨ ARMA æ¨¡å‹å·¥å…·ã€‚åœ¨ä½¿ç”¨ ARMA å·¥å…·å‰ï¼Œä½ éœ€è¦å…ˆå¼•ç”¨ç›¸å…³å·¥å…·åŒ…ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa.arima_model <span class="keyword">import</span> ARMA</span><br></pre></td></tr></table></figure><p><br>ç„¶åé€šè¿‡ ARMA(endog,order,exog=None) åˆ›å»º ARMA ç±»ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¸»è¦çš„å‚æ•°ç®€å•è¯´æ˜ä¸‹ï¼š<br><br><br>endogï¼šè‹±æ–‡æ˜¯ endogenous variableï¼Œä»£è¡¨å†…ç”Ÿå˜é‡ï¼Œåˆå«éæ”¿ç­–æ€§å˜é‡ï¼Œå®ƒæ˜¯ç”±æ¨¡å‹å†³å®šçš„ï¼Œä¸è¢«æ”¿ç­–å·¦å³ï¼Œå¯ä»¥è¯´æ˜¯æˆ‘ä»¬æƒ³è¦åˆ†æçš„å˜é‡ï¼Œæˆ–è€…è¯´æ˜¯æˆ‘ä»¬è¿™æ¬¡é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„å˜é‡ã€‚<br><br><br>orderï¼šä»£è¡¨æ˜¯ p å’Œ q çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ ARMA ä¸­çš„é˜¶æ•°ã€‚<br><br><br>exogï¼šè‹±æ–‡æ˜¯ exogenous variablesï¼Œä»£è¡¨å¤–ç”Ÿå˜é‡ã€‚å¤–ç”Ÿå˜é‡å’Œå†…ç”Ÿå˜é‡ä¸€æ ·æ˜¯ç»æµæ¨¡å‹ä¸­çš„ä¸¤ä¸ªé‡è¦å˜é‡ã€‚ç›¸å¯¹äºå†…ç”Ÿå˜é‡è€Œè¨€ï¼Œå¤–ç”Ÿå˜é‡åˆç§°ä½œä¸ºæ”¿ç­–æ€§å˜é‡ï¼Œåœ¨ç»æµæœºåˆ¶å†…å—å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œä¸æ˜¯æˆ‘ä»¬æ¨¡å‹è¦ç ”ç©¶çš„å˜é‡ã€‚<br><br><br>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»º ARMA(7,0) æ¨¡å‹ï¼Œå¯ä»¥å†™æˆï¼šARMA(data,(7,0))ï¼Œå…¶ä¸­ data æ˜¯æˆ‘ä»¬æƒ³è¦è§‚å¯Ÿçš„å˜é‡ï¼Œ(7,0) ä»£è¡¨ (p,q) çš„é˜¶æ•°ã€‚åˆ›å»ºå¥½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ fit å‡½æ•°è¿›è¡Œæ‹Ÿåˆï¼Œé€šè¿‡ predict(start, end) å‡½æ•°è¿›è¡Œé¢„æµ‹ï¼Œå…¶ä¸­ start ä¸ºé¢„æµ‹çš„èµ·å§‹æ—¶é—´ï¼Œend ä¸ºé¢„æµ‹çš„ç»ˆæ­¢æ—¶é—´ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ ARMA æ¨¡å‹å¯¹ä¸€ç»„æ—¶é—´åºåˆ—åšå»ºæ¨¡ï¼Œä»£ç å¦‚ä¸‹ï¼š<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="comment"># ç”¨ARMAè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"><span class="keyword">from</span> statsmodels.tsa.arima_model <span class="keyword">import</span> ARMA</span><br><span class="line"><span class="keyword">from</span> statsmodels.graphics.api <span class="keyword">import</span> qqplot</span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®</span></span><br><span class="line">data = [<span class="number">5922</span>, <span class="number">5308</span>, <span class="number">5546</span>, <span class="number">5975</span>, <span class="number">2704</span>, <span class="number">1767</span>, <span class="number">4111</span>, <span class="number">5542</span>, <span class="number">4726</span>, <span class="number">5866</span>, <span class="number">6183</span>, <span class="number">3199</span>, <span class="number">1471</span>, <span class="number">1325</span>, <span class="number">6618</span>, <span class="number">6644</span>, <span class="number">5337</span>, <span class="number">7064</span>, <span class="number">2912</span>, <span class="number">1456</span>, <span class="number">4705</span>, <span class="number">4579</span>, <span class="number">4990</span>, <span class="number">4331</span>, <span class="number">4481</span>, <span class="number">1813</span>, <span class="number">1258</span>, <span class="number">4383</span>, <span class="number">5451</span>, <span class="number">5169</span>, <span class="number">5362</span>, <span class="number">6259</span>, <span class="number">3743</span>, <span class="number">2268</span>, <span class="number">5397</span>, <span class="number">5821</span>, <span class="number">6115</span>, <span class="number">6631</span>, <span class="number">6474</span>, <span class="number">4134</span>, <span class="number">2728</span>, <span class="number">5753</span>, <span class="number">7130</span>, <span class="number">7860</span>, <span class="number">6991</span>, <span class="number">7499</span>, <span class="number">5301</span>, <span class="number">2808</span>, <span class="number">6755</span>, <span class="number">6658</span>, <span class="number">7644</span>, <span class="number">6472</span>, <span class="number">8680</span>, <span class="number">6366</span>, <span class="number">5252</span>, <span class="number">8223</span>, <span class="number">8181</span>, <span class="number">10548</span>, <span class="number">11823</span>, <span class="number">14640</span>, <span class="number">9873</span>, <span class="number">6613</span>, <span class="number">14415</span>, <span class="number">13204</span>, <span class="number">14982</span>, <span class="number">9690</span>, <span class="number">10693</span>, <span class="number">8276</span>, <span class="number">4519</span>, <span class="number">7865</span>, <span class="number">8137</span>, <span class="number">10022</span>, <span class="number">7646</span>, <span class="number">8749</span>, <span class="number">5246</span>, <span class="number">4736</span>, <span class="number">9705</span>, <span class="number">7501</span>, <span class="number">9587</span>, <span class="number">10078</span>, <span class="number">9732</span>, <span class="number">6986</span>, <span class="number">4385</span>, <span class="number">8451</span>, <span class="number">9815</span>, <span class="number">10894</span>, <span class="number">10287</span>, <span class="number">9666</span>, <span class="number">6072</span>, <span class="number">5418</span>]</span><br><span class="line">data=pd.Series(data)</span><br><span class="line">data_index = sm.tsa.datetools.dates_from_range(<span class="string">'1901'</span>,<span class="string">'1990'</span>)</span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ•°æ®å›¾</span></span><br><span class="line">data.index = pd.Index(data_index)</span><br><span class="line">data.plot(figsize=(<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># åˆ›å»ºARMAæ¨¡å‹# åˆ›å»ºARMAæ¨¡å‹</span></span><br><span class="line">arma = ARMA(data,(<span class="number">7</span>,<span class="number">0</span>)).fit()</span><br><span class="line">print(<span class="string">'AIC: %0.4lf'</span> %arma.aic)</span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">predict_y = arma.predict(<span class="string">'1990'</span>, <span class="string">'2000'</span>)</span><br><span class="line"><span class="comment"># é¢„æµ‹ç»“æœç»˜åˆ¶</span></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line">ax = data.ix[<span class="string">'1901'</span>:].plot(ax=ax)</span><br><span class="line">predict_y.plot(ax=ax)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587566465755-51d3a226-d74c-47a7-83a2-3f19889b168c.png#align=left&display=inline&height=1153&margin=%5Bobject%20Object%5D&name=71c5fe77926ba65e4b4aca48c337c66a.png&originHeight=1153&originWidth=1726&size=295229&status=done&style=none&width=1726" alt="71c5fe77926ba65e4b4aca48c337c66a.png">)<img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587566483385-5c01d718-1103-4b3b-be36-1f1bc4e0d11d.png#align=left&display=inline&height=1131&margin=%5Bobject%20Object%5D&name=082ff6d7e85e176b8fd5c38f528314fc.png&originHeight=1131&originWidth=1727&size=291062&status=done&style=none&width=1727" alt="082ff6d7e85e176b8fd5c38f528314fc.png"><br><br><br>æˆ‘åˆ›å»ºäº† 1901 å¹´ -1990 å¹´ä¹‹é—´çš„æ—¶é—´åºåˆ—æ•°æ® dataï¼Œç„¶ååˆ›å»º ARMA(7,0) æ¨¡å‹ï¼Œå¹¶ä¼ å…¥æ—¶é—´åºåˆ—æ•°æ® dataï¼Œä½¿ç”¨ fit å‡½æ•°æ‹Ÿåˆï¼Œç„¶åå¯¹ 1990 å¹´ -2000 å¹´ä¹‹é—´çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œæœ€åç»˜åˆ¶é¢„æµ‹ç»“æœã€‚<br><br><br>ä½ èƒ½çœ‹åˆ° ARMA å·¥å…·çš„ä½¿ç”¨è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œåªæ˜¯æˆ‘ä»¬éœ€è¦ p å’Œ q çš„å–å€¼ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ p å’Œ q æŒ‡å®šä¸€ä¸ªèŒƒå›´ï¼Œè®© ARMA éƒ½è¿è¡Œä¸€ä¸‹ï¼Œç„¶åé€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚<br><br><br>ä½ å¯èƒ½ä¼šé—®ï¼Œæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªæ¨¡å‹æ˜¯å¦é€‚åˆï¼Ÿæˆ‘ä»¬éœ€è¦å¼•å…¥ AIC å‡†åˆ™ï¼Œä¹Ÿå«ä½œèµ¤æ± æ¶ˆæ¯å‡†åˆ™ï¼Œå®ƒæ˜¯è¡¡é‡ç»Ÿè®¡æ¨¡å‹æ‹Ÿåˆå¥½åçš„ä¸€ä¸ªæ ‡å‡†ï¼Œæ•°å€¼è¶Šå°ä»£è¡¨æ¨¡å‹æ‹Ÿåˆå¾—è¶Šå¥½ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ èƒ½çœ‹åˆ° ARMA(7,0) è¿™ä¸ªæ¨¡å‹æ‹Ÿåˆå‡ºæ¥çš„ AIC æ˜¯ 1619.6323ï¼ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜ï¼‰ã€‚<br></p><p><a name="NqVK6"></a></p><h3 id="å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹"><a href="#å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹" class="headerlink" title="å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹"></a>å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹</h3><p><br>æˆ‘ä»¬éƒ½çŸ¥é“æ¯”ç‰¹å¸çš„èµ°åŠ¿é™¤äº†å’Œå†å²æ•°æ®ä»¥å¤–ï¼Œè¿˜å’Œå¾ˆå¤šå¤–ç•Œå› ç´ ç›¸å…³ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å…³æ³¨åº¦ï¼Œå„å›½çš„æ”¿ç­–ï¼Œå¸åœˆä¹‹é—´æ˜¯å¦æ‰“æ¶ç­‰ç­‰ã€‚å½“ç„¶è¿™äº›å¤–ç•Œçš„å› ç´ ä¸æ˜¯æˆ‘ä»¬è¿™èŠ‚è¯¾éœ€è¦è€ƒè™‘çš„å¯¹è±¡ã€‚å‡è®¾æˆ‘ä»¬åªè€ƒè™‘æ¯”ç‰¹å¸ä»¥å¾€çš„å†å²æ•°æ®ï¼Œç”¨ ARMA è¿™ä¸ªæ—¶é—´åºåˆ—æ¨¡å‹é¢„æµ‹æ¯”ç‰¹å¸çš„èµ°åŠ¿ã€‚æ¯”ç‰¹å¸å†å²æ•°æ®ï¼ˆä» 2012-01-01 åˆ° 2018-10-31ï¼‰å¯ä»¥ä» GitHub ä¸Šä¸‹è½½ï¼š<a href="https://github.com/cystanford/bitcoinã€‚" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/cystanford/bitcoinã€‚</a><br><br><br>ä½ èƒ½çœ‹åˆ°æ•°æ®ä¸€å…±åŒ…æ‹¬äº† 8 ä¸ªå­—æ®µï¼Œä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587566670077-1f6dd13e-fd86-40c8-8be1-f125067a6e36.png#align=left&display=inline&height=288&margin=%5Bobject%20Object%5D&name=b0db4047723ec5e649240e2a87196a36%20%281%29.png&originHeight=288&originWidth=468&size=33146&status=done&style=none&width=468" alt="b0db4047723ec5e649240e2a87196a36 (1).png"><br>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„é€  ARMA æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œé¢„æµ‹æ¯”ç‰¹å¸ï¼ˆå¹³å‡ï¼‰ä»·æ ¼èµ°åŠ¿ã€‚p å’Œ q å‚æ•°å…·ä½“é€‰æ‹©å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œç„¶åé€‰æ‹© AIC æœ€ä½çš„ ARMA æ¨¡å‹ã€‚<br><br><br>é¦–å…ˆæˆ‘ä»¬éœ€è¦åŠ è½½æ•°æ®ã€‚åœ¨å‡†å¤‡é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¢ç´¢æ•°æ®ï¼Œé‡‡ç”¨æ•°æ®å¯è§†åŒ–æ–¹å¼æŸ¥çœ‹æ¯”ç‰¹å¸çš„å†å²èµ°åŠ¿ã€‚æŒ‰ç…§ä¸åŒçš„æ—¶é—´å°ºåº¦ï¼ˆå¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´ï¼‰å¯ä»¥å°†æ•°æ®å‹ç¼©ï¼Œå¾—åˆ°ä¸åŒå°ºåº¦çš„æ•°æ®ï¼Œç„¶ååšå¯è§†åŒ–å‘ˆç°ã€‚<br><br><br>è¿™ 4 ä¸ªæ—¶é—´å°ºåº¦ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©æœˆä½œä¸ºé¢„æµ‹æ¨¡å‹çš„æ—¶é—´å°ºåº¦ï¼Œç›¸åº”çš„ï¼Œæˆ‘ä»¬é€‰æ‹© Weighted_Price è¿™ä¸ªå­—æ®µçš„æ•°å€¼ä½œä¸ºè§‚å¯Ÿç»“æœï¼Œåœ¨åŸå§‹æ•°æ®ä¸­ï¼ŒWeighted_Price å¯¹åº”çš„æ˜¯æ¯”ç‰¹å¸æ¯å¤©çš„å¹³å‡ä»·æ ¼ï¼Œå½“æˆ‘ä»¬ä»¥â€œæœˆâ€ä¸ºå•ä½è¿›è¡Œå‹ç¼©çš„æ—¶å€™ï¼Œå¯¹åº”çš„ Weighted_Price å¾—åˆ°çš„å°±æ˜¯å½“æœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼ã€‚å‹ç¼©ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_month = df.resample(<span class="string">'M'</span>).mean()</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨é¢„æµ‹é˜¶æ®µåˆ›å»º ARMA æ—¶é—´åºåˆ—æ¨¡å‹ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“ p å’Œ q å–ä»€ä¹ˆå€¼æ—¶ï¼Œæ¨¡å‹æœ€ä¼˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»™å®ƒä»¬è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œæ¯”å¦‚éƒ½æ˜¯ range(0,3)ï¼Œç„¶åè®¡ç®—ä¸åŒæ¨¡å‹çš„ AIC æ•°å€¼ï¼Œé€‰æ‹©æœ€å°çš„ AIC æ•°å€¼å¯¹åº”çš„é‚£ä¸ª ARMA æ¨¡å‹ã€‚æœ€åç”¨è¿™ä¸ªæœ€ä¼˜çš„ ARMA æ¨¡å‹é¢„æµ‹æœªæ¥ 8 ä¸ªæœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼èµ°åŠ¿ï¼Œå¹¶å°†ç»“æœåšå¯è§†åŒ–å‘ˆç°ã€‚<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># æ¯”ç‰¹å¸èµ°åŠ¿é¢„æµ‹ï¼Œä½¿ç”¨æ—¶é—´åºåˆ—ARMA</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> statsmodels.tsa.arima_model <span class="keyword">import</span> ARMA</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</span><br><span class="line"><span class="comment"># æ•°æ®åŠ è½½</span></span><br><span class="line">df = pd.read_csv(<span class="string">'./bitcoin_2012-01-01_to_2018-10-31.csv'</span>)</span><br><span class="line"><span class="comment"># å°†æ—¶é—´ä½œä¸ºdfçš„ç´¢å¼•</span></span><br><span class="line">df.Timestamp = pd.to_datetime(df.Timestamp)</span><br><span class="line">df.index = df.Timestamp</span><br><span class="line"><span class="comment"># æ•°æ®æ¢ç´¢</span></span><br><span class="line">print(df.head())</span><br><span class="line"><span class="comment"># æŒ‰ç…§æœˆï¼Œå­£åº¦ï¼Œå¹´æ¥ç»Ÿè®¡</span></span><br><span class="line">df_month = df.resample(<span class="string">'M'</span>).mean()</span><br><span class="line">df_Q = df.resample(<span class="string">'Q-DEC'</span>).mean()</span><br><span class="line">df_year = df.resample(<span class="string">'A-DEC'</span>).mean()</span><br><span class="line"><span class="comment"># æŒ‰ç…§å¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´æ¥æ˜¾ç¤ºæ¯”ç‰¹å¸çš„èµ°åŠ¿</span></span><br><span class="line">fig = plt.figure(figsize=[<span class="number">15</span>, <span class="number">7</span>])</span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>]=[<span class="string">'SimHei'</span>] <span class="comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.suptitle(<span class="string">'æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰'</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.subplot(<span class="number">221</span>)</span><br><span class="line">plt.plot(df.Weighted_Price, <span class="string">'-'</span>, label=<span class="string">'æŒ‰å¤©'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">222</span>)</span><br><span class="line">plt.plot(df_month.Weighted_Price, <span class="string">'-'</span>, label=<span class="string">'æŒ‰æœˆ'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">223</span>)</span><br><span class="line">plt.plot(df_Q.Weighted_Price, <span class="string">'-'</span>, label=<span class="string">'æŒ‰å­£åº¦'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.subplot(<span class="number">224</span>)</span><br><span class="line">plt.plot(df_year.Weighted_Price, <span class="string">'-'</span>, label=<span class="string">'æŒ‰å¹´'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># è®¾ç½®å‚æ•°èŒƒå›´</span></span><br><span class="line">ps = range(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">qs = range(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">parameters = product(ps, qs)</span><br><span class="line">parameters_list = list(parameters)</span><br><span class="line"><span class="comment"># å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œå³best_aicæœ€å°</span></span><br><span class="line">results = []</span><br><span class="line">best_aic = float(<span class="string">"inf"</span>) <span class="comment"># æ­£æ— ç©·</span></span><br><span class="line"><span class="keyword">for</span> param <span class="keyword">in</span> parameters_list:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        model = ARMA(df_month.Weighted_Price,order=(param[<span class="number">0</span>], param[<span class="number">1</span>])).fit()</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">'å‚æ•°é”™è¯¯:'</span>, param)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    aic = model.aic</span><br><span class="line">    <span class="keyword">if</span> aic &lt; best_aic:</span><br><span class="line">        best_model = model</span><br><span class="line">        best_aic = aic</span><br><span class="line">        best_param = param</span><br><span class="line">    results.append([param, model.aic])</span><br><span class="line"><span class="comment"># è¾“å‡ºæœ€ä¼˜æ¨¡å‹</span></span><br><span class="line">result_table = pd.DataFrame(results)</span><br><span class="line">result_table.columns = [<span class="string">'parameters'</span>, <span class="string">'aic'</span>]</span><br><span class="line">print(<span class="string">'æœ€ä¼˜æ¨¡å‹: '</span>, best_model.summary())</span><br><span class="line"><span class="comment"># æ¯”ç‰¹å¸é¢„æµ‹</span></span><br><span class="line">df_month2 = df_month[[<span class="string">'Weighted_Price'</span>]]</span><br><span class="line">date_list = [datetime(<span class="number">2018</span>, <span class="number">11</span>, <span class="number">30</span>), datetime(<span class="number">2018</span>, <span class="number">12</span>, <span class="number">31</span>), datetime(<span class="number">2019</span>, <span class="number">1</span>, <span class="number">31</span>), datetime(<span class="number">2019</span>, <span class="number">2</span>, <span class="number">28</span>), datetime(<span class="number">2019</span>, <span class="number">3</span>, <span class="number">31</span>), </span><br><span class="line">             datetime(<span class="number">2019</span>, <span class="number">4</span>, <span class="number">30</span>), datetime(<span class="number">2019</span>, <span class="number">5</span>, <span class="number">31</span>), datetime(<span class="number">2019</span>, <span class="number">6</span>, <span class="number">30</span>)]</span><br><span class="line">future = pd.DataFrame(index=date_list, columns= df_month.columns)</span><br><span class="line">df_month2 = pd.concat([df_month2, future])</span><br><span class="line">df_month2[<span class="string">'forecast'</span>] = best_model.predict(start=<span class="number">0</span>, end=<span class="number">91</span>)</span><br><span class="line"><span class="comment"># æ¯”ç‰¹å¸é¢„æµ‹ç»“æœæ˜¾ç¤º</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">7</span>))</span><br><span class="line">df_month2.Weighted_Price.plot(label=<span class="string">'å®é™…é‡‘é¢'</span>)</span><br><span class="line">df_month2.forecast.plot(color=<span class="string">'r'</span>, ls=<span class="string">'--'</span>, label=<span class="string">'é¢„æµ‹é‡‘é¢'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.title(<span class="string">'æ¯”ç‰¹å¸é‡‘é¢ï¼ˆæœˆï¼‰'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'æ—¶é—´'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'ç¾é‡‘'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587568120533-48e72652-d6c8-48d7-89b5-e85444e01f0b.png#align=left&display=inline&height=387&margin=%5Bobject%20Object%5D&name=image.png&originHeight=896&originWidth=1726&size=185308&status=done&style=none&width=746" alt="image.png">)<img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587568146325-8a757836-53be-48dc-bd78-db7c3ac4b303.png#align=left&display=inline&height=661&margin=%5Bobject%20Object%5D&name=image.png&originHeight=661&originWidth=1729&size=105845&status=done&style=none&width=1729" alt="image.png">)<img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1587568269473-039c43af-0ead-4c73-934f-240ea39180db.png#align=left&display=inline&height=932&margin=%5Bobject%20Object%5D&name=image.png&originHeight=932&originWidth=1729&size=516959&status=done&style=none&width=1729" alt="image.png"><br><br><br>æˆ‘ä»¬é€šè¿‡ product å‡½æ•°åˆ›å»ºäº† (p,q) åœ¨ range(0,3) èŒƒå›´å†…çš„æ‰€æœ‰å¯èƒ½ç»„åˆï¼Œå¹¶å¯¹æ¯ä¸ª ARMA(p,q) æ¨¡å‹è¿›è¡Œäº† AIC æ•°å€¼è®¡ç®—ï¼Œä¿å­˜äº† AIC æ•°å€¼æœ€å°çš„æ¨¡å‹å‚æ•°ã€‚ç„¶åç”¨è¿™ä¸ªæ¨¡å‹å¯¹æ¯”ç‰¹å¸çš„æœªæ¥ 8 ä¸ªæœˆè¿›è¡Œäº†é¢„æµ‹ã€‚<br><br><br>ä»ç»“æœä¸­ä½ èƒ½çœ‹åˆ°ï¼Œåœ¨ 2018 å¹´ 10 æœˆä¹‹å 8 ä¸ªæœˆçš„æ—¶é—´é‡Œï¼Œæ¯”ç‰¹å¸ä¼šè§¦åº•åˆ° 4000 ç¾é‡‘å·¦å³ï¼Œå®é™…ä¸Šæ¯”ç‰¹å¸åœ¨è¿™ä¸ªé˜¶æ®µç¡®å®é™ä½åˆ°äº† 4000 å…ƒç¾é‡‘ç”šè‡³æ›´ä½ã€‚åœ¨æ—¶é—´å°ºåº¦çš„é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©äº†æœˆï¼Œè¿™æ ·å°±å¯¹æ•°æ®è¿›è¡Œäº†é™ç»´ï¼Œä¹ŸèŠ‚çº¦äº† ARMA çš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚ä½ èƒ½çœ‹åˆ°æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰è¿™å¼ å›¾ä¸­ï¼ŒæŒ‰æœˆåˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å’ŒæŒ‰å¤©åˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å·®åˆ«ä¸å¤§ï¼Œåœ¨å‡å°‘äº†å±€éƒ¨çš„æ³¢åŠ¨çš„åŒæ—¶ä¹Ÿèƒ½ä½“ç°å‡ºæ¯”ç‰¹å¸çš„è¶‹åŠ¿ï¼Œè¿™æ ·å°±èŠ‚çº¦äº† ARMA çš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚<br></p><p><a name="3wkzY"></a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><br>ä»Šå¤©æˆ‘ç»™ä½ è®²äº†ä¸€ä¸ªæ¯”ç‰¹å¸è¶‹åŠ¿é¢„æµ‹çš„å®æˆ˜é¡¹ç›®ã€‚é€šè¿‡è¿™ä¸ªé¡¹ç›®ä½ åº”è¯¥èƒ½ä½“ä¼šåˆ°ï¼Œå½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œé¢„æµ‹çš„æ—¶å€™ï¼Œå¦‚æœè€ƒè™‘çš„æ˜¯å¤šä¸ªå˜é‡å’Œç»“æœä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥é‡‡ç”¨å›å½’åˆ†æï¼Œå¦‚æœè€ƒè™‘å•ä¸ªæ—¶é—´ç»´åº¦ä¸ç»“æœçš„å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†æã€‚<br><br><br>æ ¹æ®æ¯”ç‰¹å¸çš„å†å²æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ ARMA æ¨¡å‹å¯¹æ¯”ç‰¹å¸æœªæ¥ 8 ä¸ªæœˆçš„èµ°åŠ¿è¿›è¡Œäº†é¢„æµ‹ï¼Œå¹¶å¯¹ç»“æœè¿›è¡Œäº†å¯è§†åŒ–æ˜¾ç¤ºã€‚ä½ èƒ½çœ‹åˆ° ARMA å·¥å…·è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ï¼Œè™½ç„¶æ¯”ç‰¹å¸çš„èµ°åŠ¿å—å¾ˆå¤šå¤–åœ¨å› ç´ å½±å“ï¼Œæ¯”å¦‚æ”¿ç­–ç¯å¢ƒã€‚ä¸è¿‡å½“æˆ‘ä»¬æŒæ¡äº†è¿™äº›å†å²æ•°æ®ï¼Œä¹Ÿä¸å¦¨ç”¨æ—¶é—´åºåˆ—æ¨¡å‹æ¥åˆ†æé¢„æµ‹ä¸€ä¸‹ã€‚</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;æˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†æ•°æ®æŒ–æ˜ç®—æ³•ä¸­çš„åˆ†ç±»ã€èšç±»ã€å›å½’å’Œå…³è”åˆ†æç®—æ³•ï¼Œé‚£ä¹ˆå¯¹äºæ¯”ç‰¹å¸èµ°åŠ¿çš„é¢„æµ‹ï¼Œé‡‡ç”¨å“ªç§æ–¹æ³•æ¯”è¾ƒå¥½å‘¢ï¼Ÿ&lt;br&gt;&lt;br&gt;&lt;br&gt;å¯èƒ½æœ‰äº›äºº
      
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="cpeixin.cn/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æ—¶é—´åºåˆ—" scheme="cpeixin.cn/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>ä¿¡ç”¨å¡è¯ˆéª—åˆ†æ</title>
    <link href="cpeixin.cn/2018/10/03/%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%AF%88%E9%AA%97%E5%88%86%E6%9E%90/"/>
    <id>cpeixin.cn/2018/10/03/%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%AF%88%E9%AA%97%E5%88%86%E6%9E%90/</id>
    <published>2018-10-02T16:43:58.000Z</published>
    <updated>2020-05-01T14:20:36.160Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --><p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ç”¨éšæœºæ£®æ—ä»¥åŠä¹‹å‰è®²è¿‡çš„ SVMã€å†³ç­–æ ‘å’Œ KNN åˆ†ç±»å™¨å¯¹ä¿¡ç”¨å¡è¿çº¦æ•°æ®è¿›è¡Œäº†åˆ†æï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹ä¿¡ç”¨å¡æ¬ºè¯ˆã€‚<br><br><br>ç›¸æ¯”äºä¿¡ç”¨å¡è¿çº¦çš„æ¯”ä¾‹ï¼Œä¿¡ç”¨å¡æ¬ºè¯ˆçš„æ¯”ä¾‹æ›´å°ï¼Œä½†æ˜¯å±å®³æå¤§ã€‚å¦‚ä½•é€šè¿‡ä»¥å¾€çš„äº¤æ˜“æ•°æ®åˆ†æå‡ºæ¯ç¬”äº¤æ˜“æ˜¯å¦æ­£å¸¸ï¼Œæ˜¯å¦å­˜åœ¨ç›—åˆ·é£é™©æ˜¯æˆ‘ä»¬è¿™æ¬¡é¡¹ç›®çš„ç›®æ ‡ã€‚<br><br><br>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œä½ éœ€è¦æŒæ¡ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>äº†è§£é€»è¾‘å›å½’åˆ†ç±»ï¼Œä»¥åŠå¦‚ä½•åœ¨ sklearn ä¸­ä½¿ç”¨å®ƒï¼›</li><li>ä¿¡ç”¨å¡æ¬ºè¯ˆå±äºäºŒåˆ†ç±»é—®é¢˜ï¼Œæ¬ºè¯ˆäº¤æ˜“åœ¨æ‰€æœ‰äº¤æ˜“ä¸­çš„æ¯”ä¾‹å¾ˆå°ï¼Œå¯¹äºè¿™ç§æ•°æ®ä¸å¹³è¡¡çš„æƒ…å†µï¼Œåˆ°åº•é‡‡ç”¨ä»€ä¹ˆæ ·çš„æ¨¡å‹è¯„ä¼°æ ‡å‡†ä¼šæ›´å‡†ç¡®ï¼›</li><li>å®Œæˆä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æçš„å®æˆ˜é¡¹ç›®ï¼Œå¹¶é€šè¿‡æ•°æ®å¯è§†åŒ–å¯¹æ•°æ®æ¢ç´¢å’Œæ¨¡å‹ç»“æœè¯„ä¼°è¿›ä¸€æ­¥åŠ å¼ºäº†è§£ã€‚<br><a name="wwZpI"></a><h3><a href="#" class="headerlink"></a></h3><a name="evkL5"></a><h3 id="æ„å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨"><a href="#æ„å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨" class="headerlink" title="æ„å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨"></a>æ„å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨</h3></li></ul><p><br>é€»è¾‘å›å½’è™½ç„¶ä¸åœ¨æˆ‘ä»¬è®²è§£çš„åå¤§ç»å…¸æ•°æ®æŒ–æ˜ç®—æ³•é‡Œé¢ï¼Œä½†ä¹Ÿæ˜¯å¸¸ç”¨çš„æ•°æ®æŒ–æ˜ç®—æ³•ã€‚é€»è¾‘å›å½’ï¼Œä¹Ÿå«ä½œ logistic å›å½’ã€‚è™½ç„¶åå­—ä¸­å¸¦æœ‰â€œå›å½’â€ï¼Œä½†å®ƒå®é™…ä¸Šæ˜¯åˆ†ç±»æ–¹æ³•ï¼Œä¸»è¦è§£å†³çš„æ˜¯äºŒåˆ†ç±»é—®é¢˜ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥è§£å†³å¤šåˆ†ç±»é—®é¢˜ï¼Œåªæ˜¯äºŒåˆ†ç±»æ›´å¸¸è§ä¸€äº›ã€‚<br><br><br>åœ¨é€»è¾‘å›å½’ä¸­ä½¿ç”¨äº† Logistic å‡½æ•°ï¼Œä¹Ÿç§°ä¸º Sigmoid å‡½æ•°ã€‚Sigmoid å‡½æ•°æ˜¯åœ¨æ·±åº¦å­¦ä¹ ä¸­ç»å¸¸ç”¨åˆ°çš„å‡½æ•°ä¹‹ä¸€ï¼Œå‡½æ•°å…¬å¼ä¸ºï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586964265219-9919addd-92e8-42f4-8d14-fab4af3e5bb0.png#align=left&display=inline&height=204&margin=%5Bobject%20Object%5D&name=image.png&originHeight=204&originWidth=444&size=11021&status=done&style=none&width=444" alt="image.png"><br>å‡½æ•°çš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼Œç±»ä¼¼ S çŠ¶ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586964264055-79ceda30-ba6d-492e-808c-de24a6c1299d.png#align=left&display=inline&height=206&margin=%5Bobject%20Object%5D&name=b7a5d39d91fda02b21669137a489743b.png&originHeight=206&originWidth=477&size=7332&status=done&style=none&width=477" alt="b7a5d39d91fda02b21669137a489743b.png"><br><br><br>ä½ èƒ½çœ‹å‡º g(z) çš„ç»“æœåœ¨ 0-1 ä¹‹é—´ï¼Œå½“ z è¶Šå¤§çš„æ—¶å€™ï¼Œg(z) è¶Šå¤§ï¼Œå½“ z è¶‹è¿‘äºæ— ç©·å¤§çš„æ—¶å€™ï¼Œg(z) è¶‹è¿‘äº 1ã€‚åŒæ ·å½“ z è¶‹è¿‘äºæ— ç©·å°çš„æ—¶å€™ï¼Œg(z) è¶‹è¿‘äº 0ã€‚åŒæ—¶ï¼Œå‡½æ•°å€¼ä»¥ 0.5 ä¸ºä¸­å¿ƒã€‚<br><br><br>ä¸ºä»€ä¹ˆé€»è¾‘å›å½’ç®—æ³•æ˜¯åŸºäº Sigmoid å‡½æ•°å®ç°çš„å‘¢ï¼Ÿä½ å¯ä»¥è¿™æ ·ç†è§£ï¼šæˆ‘ä»¬è¦å®ç°ä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼Œ0 å³ä¸ºä¸å‘ç”Ÿï¼Œ1 å³ä¸ºå‘ç”Ÿã€‚æˆ‘ä»¬ç»™å®šä¸€äº›å†å²æ•°æ® X å’Œ yã€‚å…¶ä¸­ X ä»£è¡¨æ ·æœ¬çš„ n ä¸ªç‰¹å¾ï¼Œy ä»£è¡¨æ­£ä¾‹å’Œè´Ÿä¾‹ï¼Œä¹Ÿå°±æ˜¯ 0 æˆ– 1 çš„å–å€¼ã€‚é€šè¿‡å†å²æ ·æœ¬çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œå½“ç»™å®šæ–°çš„ X çš„æ—¶å€™ï¼Œå¯ä»¥é¢„æµ‹å‡º yã€‚è¿™é‡Œæˆ‘ä»¬å¾—åˆ°çš„ y æ˜¯ä¸€ä¸ªé¢„æµ‹çš„æ¦‚ç‡ï¼Œé€šå¸¸ä¸æ˜¯ 0% å’Œ 100%ï¼Œè€Œæ˜¯ä¸­é—´çš„å–å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ¦‚ç‡å¤§äº 50% çš„æ—¶å€™ï¼Œå³ä¸ºå‘ç”Ÿï¼ˆæ­£ä¾‹ï¼‰ï¼Œæ¦‚ç‡å°äº 50% çš„æ—¶å€™ï¼Œå³ä¸ºä¸å‘ç”Ÿï¼ˆè´Ÿä¾‹ï¼‰ã€‚è¿™æ ·å°±å®Œæˆäº†äºŒåˆ†ç±»çš„é¢„æµ‹ã€‚<br><br><br>é€»è¾‘å›å½’æ¨¡å‹çš„æ±‚è§£è¿™é‡Œä¸åšä»‹ç»ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨ sklearn ä¸­çš„é€»è¾‘å›å½’å·¥å…·ã€‚åœ¨ sklearn ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ LogisticRegression() å‡½æ•°æ„å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨ï¼Œå‡½æ•°é‡Œæœ‰ä¸€äº›å¸¸ç”¨çš„æ„é€ å‚æ•°ï¼š<br></p><ol><li>penaltyï¼šæƒ©ç½šé¡¹ï¼Œå–å€¼ä¸º l1 æˆ– l2ï¼Œé»˜è®¤ä¸º l2ã€‚å½“æ¨¡å‹å‚æ•°æ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„æ—¶å€™ï¼Œä½¿ç”¨ l2ï¼Œå½“æ¨¡å‹å‚æ•°æ»¡è¶³æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒçš„æ—¶å€™ï¼Œä½¿ç”¨ l1ï¼›</li><li>solverï¼šä»£è¡¨çš„æ˜¯é€»è¾‘å›å½’æŸå¤±å‡½æ•°çš„ä¼˜åŒ–æ–¹æ³•ã€‚æœ‰ 5 ä¸ªå‚æ•°å¯é€‰ï¼Œåˆ†åˆ«ä¸º liblinearã€lbfgsã€newton-cgã€sag å’Œ sagaã€‚é»˜è®¤ä¸º liblinearï¼Œé€‚ç”¨äºæ•°æ®é‡å°çš„æ•°æ®é›†ï¼Œå½“æ•°æ®é‡å¤§çš„æ—¶å€™å¯ä»¥é€‰ç”¨ sag æˆ– saga æ–¹æ³•ã€‚</li><li>max_iterï¼šç®—æ³•æ”¶æ•›çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º 10ã€‚</li><li>n_jobsï¼šæ‹Ÿåˆå’Œé¢„æµ‹çš„æ—¶å€™ CPU çš„æ ¸æ•°ï¼Œé»˜è®¤æ˜¯ 1ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•´æ•°ï¼Œå¦‚æœæ˜¯ -1 åˆ™ä»£è¡¨ CPU çš„æ ¸æ•°ã€‚</li></ol><p><br>å½“æˆ‘ä»¬åˆ›å»ºå¥½ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ fit å‡½æ•°æ‹Ÿåˆï¼Œä½¿ç”¨ predict å‡½æ•°é¢„æµ‹ã€‚<br><br><br></p><p><a name="gdmvF"></a></p><h3 id="æ¨¡å‹è¯„ä¼°æŒ‡æ ‡"><a href="#æ¨¡å‹è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="æ¨¡å‹è¯„ä¼°æŒ‡æ ‡"></a>æ¨¡å‹è¯„ä¼°æŒ‡æ ‡</h3><p><br>æˆ‘ä»¬ä¹‹å‰å¯¹æ¨¡å‹åšè¯„ä¼°æ—¶ï¼Œé€šå¸¸é‡‡ç”¨çš„æ˜¯å‡†ç¡®ç‡ (accuracy)ï¼Œå®ƒæŒ‡çš„æ˜¯åˆ†ç±»å™¨æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬æ•°ä¸æ€»ä½“æ ·æœ¬æ•°ä¹‹é—´çš„æ¯”ä¾‹ã€‚è¿™ä¸ªæŒ‡æ ‡å¯¹å¤§éƒ¨åˆ†çš„åˆ†ç±»æƒ…å†µæ˜¯æœ‰æ•ˆçš„ï¼Œä¸è¿‡å½“åˆ†ç±»ç»“æœä¸¥é‡ä¸å¹³è¡¡çš„æ—¶å€™ï¼Œå‡†ç¡®ç‡å¾ˆéš¾ååº”æ¨¡å‹çš„å¥½åã€‚<br><br><br>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºæœºåœºå®‰æ£€ä¸­ææ€–åˆ†å­çš„åˆ¤æ–­ï¼Œå°±ä¸èƒ½é‡‡ç”¨å‡†ç¡®ç‡å¯¹æ¨¡å‹è¿›è¡Œè¯„ä¼°ã€‚æˆ‘ä»¬çŸ¥é“ææ€–åˆ†å­çš„æ¯”ä¾‹æ˜¯æä½çš„ï¼Œå› æ­¤å½“æˆ‘ä»¬ç”¨å‡†ç¡®ç‡åšåˆ¤æ–­æ—¶ï¼Œå¦‚æœå‡†ç¡®ç‡é«˜è¾¾ 99.999%ï¼Œå°±è¯´æ˜è¿™ä¸ªæ¨¡å‹ä¸€å®šå¥½ä¹ˆï¼Ÿå…¶å®æ­£å› ä¸ºç°å®ç”Ÿæ´»ä¸­ææ€–åˆ†å­çš„æ¯”ä¾‹æä½ï¼Œå°±ç®—æˆ‘ä»¬ä¸èƒ½è¯†åˆ«å‡ºä¸€ä¸ªææ€–åˆ†å­ï¼Œä¹Ÿä¼šå¾—åˆ°éå¸¸é«˜çš„å‡†ç¡®ç‡ã€‚å› ä¸ºå‡†ç¡®ç‡çš„è¯„åˆ¤æ ‡å‡†æ˜¯æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬ä¸ªæ•°ä¸æ€»æ ·æœ¬æ•°ä¹‹é—´çš„æ¯”ä¾‹ã€‚å› æ­¤éææ€–åˆ†å­çš„æ¯”ä¾‹ä¼šå¾ˆé«˜ï¼Œå°±ç®—æˆ‘ä»¬è¯†åˆ«ä¸å‡ºæ¥ææ€–åˆ†å­ï¼Œæ­£ç¡®åˆ†ç±»çš„ä¸ªæ•°å æ€»æ ·æœ¬çš„æ¯”ä¾‹ä¹Ÿä¼šå¾ˆé«˜ï¼Œä¹Ÿå°±æ˜¯å‡†ç¡®ç‡é«˜ã€‚<br><br><br>å®é™…ä¸Šæˆ‘ä»¬åº”è¯¥æ›´å…³æ³¨ææ€–åˆ†å­çš„è¯†åˆ«ï¼Œè¿™é‡Œå…ˆä»‹ç»ä¸‹æ•°æ®é¢„æµ‹çš„å››ç§æƒ…å†µï¼šTPã€FPã€TNã€FNã€‚æˆ‘ä»¬ç”¨ç¬¬äºŒä¸ªå­—æ¯ P æˆ– N ä»£è¡¨é¢„æµ‹ä¸ºæ­£ä¾‹è¿˜æ˜¯è´Ÿä¾‹ï¼ŒP ä¸ºæ­£ï¼ŒN ä¸ºè´Ÿã€‚ç¬¬ä¸€ä¸ªå­—æ¯ T æˆ– F ä»£è¡¨çš„æ˜¯é¢„æµ‹ç»“æœæ˜¯å¦æ­£ç¡®ï¼ŒT ä¸ºæ­£ç¡®ï¼ŒF ä¸ºé”™è¯¯ã€‚æ‰€ä»¥å››ç§æƒ…å†µåˆ†åˆ«ä¸ºï¼š</p><ul><li>TPï¼šé¢„æµ‹ä¸ºæ­£ï¼Œåˆ¤æ–­æ­£ç¡®ï¼›</li><li>FPï¼šé¢„æµ‹ä¸ºæ­£ï¼Œåˆ¤æ–­é”™è¯¯ï¼›</li><li>TNï¼šé¢„æµ‹ä¸ºè´Ÿï¼Œåˆ¤æ–­æ­£ç¡®ï¼›</li><li>FNï¼šé¢„æµ‹ä¸ºè´Ÿï¼Œåˆ¤æ–­é”™è¯¯ã€‚</li></ul><p><br>æˆ‘ä»¬çŸ¥é“æ ·æœ¬æ€»æ•° =TP+FP+TN+FNï¼Œé¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°ä¸º TP+TNï¼Œå› æ­¤å‡†ç¡®ç‡ Accuracy = (TP+TN)/(TP+TN+FN+FP)ã€‚<br><br><br>å®é™…ä¸Šï¼Œå¯¹äºåˆ†ç±»ä¸å¹³è¡¡çš„æƒ…å†µï¼Œæœ‰ä¸¤ä¸ªæŒ‡æ ‡éå¸¸é‡è¦ï¼Œ<strong>å®ƒä»¬åˆ†åˆ«æ˜¯ç²¾ç¡®åº¦å’Œå¬å›ç‡</strong>ã€‚<br><br><br>ç²¾ç¡®ç‡ P = TP/ (TP+FP)ï¼Œå¯¹åº”ä¸Šé¢ææ€–åˆ†å­è¿™ä¸ªä¾‹å­ï¼Œåœ¨æ‰€æœ‰åˆ¤æ–­ä¸ºææ€–åˆ†å­çš„äººæ•°ä¸­ï¼ŒçœŸæ­£æ˜¯ææ€–åˆ†å­çš„æ¯”ä¾‹ã€‚<br><br><br>å¬å›ç‡ R = TP/ (TP+FN)ï¼Œä¹Ÿç§°ä¸ºæŸ¥å…¨ç‡ã€‚ä»£è¡¨çš„æ˜¯ææ€–åˆ†å­è¢«æ­£ç¡®è¯†åˆ«å‡ºæ¥çš„ä¸ªæ•°ä¸ææ€–åˆ†å­æ€»æ•°çš„æ¯”ä¾‹ã€‚ä¸ºä»€ä¹ˆè¦ç»Ÿè®¡å¬å›ç‡å’Œç²¾ç¡®ç‡è¿™ä¸¤ä¸ªæŒ‡æ ‡å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬åªç»Ÿè®¡å¬å›ç‡ï¼Œå½“å¬å›ç‡ç­‰äº 100% çš„æ—¶å€™ï¼Œæ¨¡å‹æ˜¯å¦çœŸçš„å¥½å‘¢ï¼Ÿ<br><br><br>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æŠŠæœºåœºæ‰€æœ‰çš„äººéƒ½è®¤ä¸ºæ˜¯ææ€–åˆ†å­ï¼Œææ€–åˆ†å­éƒ½ä¼šè¢«æ­£ç¡®è¯†åˆ«ï¼Œè¿™ä¸ªæ•°å­—ä¸ææ€–åˆ†å­çš„æ€»æ•°æ¯”ä¾‹ç­‰äº 100%ï¼Œä½†æ˜¯è¿™ä¸ªç»“æœæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å¦‚æœæˆ‘ä»¬è®¤ä¸ºæœºåœºé‡Œæ‰€æœ‰äººéƒ½æ˜¯ææ€–åˆ†å­çš„è¯ï¼Œé‚£ä¹ˆéææ€–åˆ†å­ï¼ˆæé«˜æ¯”ä¾‹ï¼‰éƒ½ä¼šè®¤ä¸ºæ˜¯ææ€–åˆ†å­ï¼Œè¯¯åˆ¤ç‡å¤ªé«˜äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç»Ÿè®¡ç²¾ç¡®ç‡ä½œä¸ºå¬å›ç‡çš„è¡¥å……ã€‚å®é™…ä¸Šæœ‰ä¸€ä¸ªæŒ‡æ ‡ç»¼åˆäº†ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œå¯ä»¥æ›´å¥½åœ°è¯„ä¼°æ¨¡å‹çš„å¥½åã€‚è¿™ä¸ªæŒ‡æ ‡å«åš F1ï¼Œç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586964834238-6a4ec2e1-306d-4057-9a97-7df5e831b85c.png#align=left&display=inline&height=182&margin=%5Bobject%20Object%5D&name=b122244eae9a74eded619d14c0bc12ce.png&originHeight=182&originWidth=398&size=11527&status=done&style=none&width=398" alt="b122244eae9a74eded619d14c0bc12ce.png"><br><br><br>F1 ä½œä¸ºç²¾ç¡®ç‡ P å’Œå¬å›ç‡ R çš„è°ƒå’Œå¹³å‡ï¼Œæ•°å€¼è¶Šå¤§ä»£è¡¨æ¨¡å‹çš„ç»“æœè¶Šå¥½ã€‚<br><br><br></p><p><a name="jZ1Vb"></a></p><h3 id="ä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æ"><a href="#ä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æ" class="headerlink" title="ä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æ"></a>ä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æ</h3><p><br>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æçš„é¡¹ç›®ï¼Œè¿™ä¸ªæ•°æ®é›†ä½ å¯ä»¥ä»ç™¾åº¦ç½‘ç›˜ï¼ˆå› ä¸ºæ•°æ®é›†å¤§äº 100Mï¼Œæ‰€ä»¥é‡‡ç”¨äº†ç½‘ç›˜ï¼‰ä¸­ä¸‹è½½ï¼šé“¾æ¥ï¼š<a href="https://pan.baidu.com/s/14F8WuX0ZJntdB_r1EC08HA" target="_blank" rel="external nofollow noopener noreferrer">https://pan.baidu.com/s/14F8WuX0ZJntdB_r1EC08HA</a> æå–ç ï¼š58gp<br><br><br>æ•°æ®é›†åŒ…æ‹¬äº† 2013 å¹´ 9 æœˆä»½ä¸¤å¤©æ—¶é—´å†…çš„ä¿¡ç”¨å¡äº¤æ˜“æ•°æ®ï¼Œ284807 ç¬”äº¤æ˜“ä¸­ï¼Œä¸€å…±æœ‰ 492 ç¬”æ˜¯æ¬ºè¯ˆè¡Œä¸ºã€‚è¾“å…¥æ•°æ®ä¸€å…±åŒ…æ‹¬äº† 28 ä¸ªç‰¹å¾ V1ï¼ŒV2ï¼Œâ€¦â€¦V28 å¯¹åº”çš„å–å€¼ï¼Œä»¥åŠäº¤æ˜“æ—¶é—´ Time å’Œäº¤æ˜“é‡‘é¢ Amountã€‚ä¸ºäº†ä¿æŠ¤æ•°æ®éšç§ï¼Œæˆ‘ä»¬ä¸çŸ¥é“ V1 åˆ° V28 è¿™äº›ç‰¹å¾ä»£è¡¨çš„å…·ä½“å«ä¹‰ï¼ŒåªçŸ¥é“è¿™ 28 ä¸ªç‰¹å¾å€¼æ˜¯é€šè¿‡ PCA å˜æ¢å¾—åˆ°çš„ç»“æœã€‚å¦å¤–å­—æ®µ Class ä»£è¡¨è¯¥ç¬”äº¤æ˜“çš„åˆ†ç±»ï¼ŒClass=0 ä¸ºæ­£å¸¸ï¼ˆéæ¬ºè¯ˆï¼‰ï¼ŒClass=1 ä»£è¡¨æ¬ºè¯ˆã€‚<br><br><br>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é’ˆå¯¹è¿™ä¸ªæ•°æ®é›†æ„å»ºä¸€ä¸ªä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æçš„åˆ†ç±»å™¨ï¼Œé‡‡ç”¨çš„æ˜¯é€»è¾‘å›å½’ã€‚ä»æ•°æ®ä¸­ä½ èƒ½çœ‹åˆ°æ¬ºè¯ˆè¡Œä¸ºåªå åˆ°äº† 492/284807=0.172%ï¼Œæ•°æ®åˆ†ç±»ç»“æœçš„åˆ†å¸ƒæ˜¯éå¸¸ä¸å¹³è¡¡çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å‡†ç¡®ç‡è¯„ä¼°æ¨¡å‹çš„å¥½åï¼Œè€Œæ˜¯éœ€è¦ç»Ÿè®¡ F1 å€¼ï¼ˆç»¼åˆç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼‰ã€‚æˆ‘ä»¬å…ˆæ¢³ç†ä¸‹æ•´ä¸ªé¡¹ç›®çš„æµç¨‹ï¼š<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/1072113/1586965086920-af9f8f64-ed51-45a0-99bc-b5d7dbe3d7fb.jpeg#align=left&display=inline&height=1079&margin=%5Bobject%20Object%5D&name=image.jpeg&originHeight=1079&originWidth=2350&size=262963&status=done&style=none&width=2350" alt="image.jpeg"><br></p><ol><li>åŠ è½½æ•°æ®ï¼›</li></ol><ol start="2"><li>å‡†å¤‡é˜¶æ®µï¼šæˆ‘ä»¬éœ€è¦æ¢ç´¢æ•°æ®ï¼Œç”¨æ•°æ®å¯è§†åŒ–çš„æ–¹å¼æŸ¥çœ‹åˆ†ç±»ç»“æœçš„æƒ…å†µï¼Œä»¥åŠéšç€æ—¶é—´çš„å˜åŒ–ï¼Œæ¬ºè¯ˆäº¤æ˜“å’Œæ­£å¸¸äº¤æ˜“çš„åˆ†å¸ƒæƒ…å†µã€‚ä¸Šé¢å·²ç»æåˆ°è¿‡ï¼ŒV1-V28 çš„ç‰¹å¾å€¼éƒ½ç»è¿‡ PCA çš„å˜æ¢ï¼Œä½†æ˜¯å…¶ä½™çš„ä¸¤ä¸ªå­—æ®µï¼ŒTime å’Œ Amount è¿˜éœ€è¦è¿›è¡Œè§„èŒƒåŒ–ã€‚Time å­—æ®µå’Œäº¤æ˜“æœ¬èº«æ˜¯å¦ä¸ºæ¬ºè¯ˆäº¤æ˜“æ— å…³ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä½œä¸ºç‰¹å¾é€‰æ‹©ï¼Œåªéœ€è¦å¯¹ Amount åšæ•°æ®è§„èŒƒåŒ–å°±è¡Œäº†ã€‚åŒæ—¶æ•°æ®é›†æ²¡æœ‰ä¸“é—¨çš„æµ‹è¯•é›†ï¼Œä½¿ç”¨ train_test_split å¯¹æ•°æ®é›†è¿›è¡Œåˆ’åˆ†ï¼›</li></ol><ol start="3"><li>åˆ†ç±»é˜¶æ®µï¼šæˆ‘ä»¬éœ€è¦åˆ›å»ºé€»è¾‘å›å½’åˆ†ç±»å™¨ï¼Œç„¶åä¼ å…¥è®­ç»ƒé›†æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¼ å…¥æµ‹è¯•é›†é¢„æµ‹ç»“æœï¼Œå°†é¢„æµ‹ç»“æœä¸æµ‹è¯•é›†çš„ç»“æœè¿›è¡Œæ¯”å¯¹ã€‚è¿™é‡Œçš„æ¨¡å‹è¯„ä¼°æŒ‡æ ‡ç”¨åˆ°äº†<strong>ç²¾ç¡®ç‡ã€å¬å›ç‡å’Œ F1 å€¼</strong>ã€‚åŒæ—¶æˆ‘ä»¬å°†ç²¾ç¡®ç‡ - å¬å›ç‡è¿›è¡Œäº†å¯è§†åŒ–å‘ˆç°ã€‚</li></ol><p><br>åŸºäºä¸Šé¢çš„æµç¨‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨é€»è¾‘å›å½’å¯¹ä¿¡ç”¨å¡æ¬ºè¯ˆè¿›è¡Œåˆ†ç±»</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix, precision_recall_curve</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ··æ·†çŸ©é˜µå¯è§†åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_confusion_matrix</span><span class="params">(cm, classes, normalize = False, title = <span class="string">'Confusion matrix"'</span>, cmap = plt.cm.Blues)</span> :</span></span><br><span class="line">    plt.figure()</span><br><span class="line">    plt.imshow(cm, interpolation = <span class="string">'nearest'</span>, cmap = cmap)</span><br><span class="line">    plt.title(title)</span><br><span class="line">    plt.colorbar()</span><br><span class="line">    tick_marks = np.arange(len(classes))</span><br><span class="line">    plt.xticks(tick_marks, classes, rotation = <span class="number">0</span>)</span><br><span class="line">    plt.yticks(tick_marks, classes)</span><br><span class="line"> </span><br><span class="line">    thresh = cm.max() / <span class="number">2.</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> itertools.product(range(cm.shape[<span class="number">0</span>]), range(cm.shape[<span class="number">1</span>])) :</span><br><span class="line">        plt.text(j, i, cm[i, j],</span><br><span class="line">                 horizontalalignment = <span class="string">'center'</span>,</span><br><span class="line">                 color = <span class="string">'white'</span> <span class="keyword">if</span> cm[i, j] &gt; thresh <span class="keyword">else</span> <span class="string">'black'</span>)</span><br><span class="line"> </span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    plt.ylabel(<span class="string">'True label'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">'Predicted label'</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ¨¡å‹è¯„ä¼°ç»“æœ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_metrics</span><span class="params">()</span>:</span></span><br><span class="line">    tp = cm[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">    fn = cm[<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">    fp = cm[<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">    tn = cm[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    print(<span class="string">'ç²¾ç¡®ç‡: &#123;:.3f&#125;'</span>.format(tp/(tp+fp)))</span><br><span class="line">    print(<span class="string">'å¬å›ç‡: &#123;:.3f&#125;'</span>.format(tp/(tp+fn)))</span><br><span class="line">    print(<span class="string">'F1å€¼: &#123;:.3f&#125;'</span>.format(<span class="number">2</span>*(((tp/(tp+fp))*(tp/(tp+fn)))/((tp/(tp+fp))+(tp/(tp+fn))))))</span><br><span class="line"><span class="comment"># ç»˜åˆ¶ç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_precision_recall</span><span class="params">()</span>:</span></span><br><span class="line">    plt.step(recall, precision, color = <span class="string">'b'</span>, alpha = <span class="number">0.2</span>, where = <span class="string">'post'</span>)</span><br><span class="line">    plt.fill_between(recall, precision, step =<span class="string">'post'</span>, alpha = <span class="number">0.2</span>, color = <span class="string">'b'</span>)</span><br><span class="line">    plt.plot(recall, precision, linewidth=<span class="number">2</span>)</span><br><span class="line">    plt.xlim([<span class="number">0.0</span>,<span class="number">1</span>])</span><br><span class="line">    plt.ylim([<span class="number">0.0</span>,<span class="number">1.05</span>])</span><br><span class="line">    plt.xlabel(<span class="string">'å¬å›ç‡'</span>)</span><br><span class="line">    plt.ylabel(<span class="string">'ç²¾ç¡®ç‡'</span>)</span><br><span class="line">    plt.title(<span class="string">'ç²¾ç¡®ç‡-å¬å›ç‡ æ›²çº¿'</span>)</span><br><span class="line">    plt.show();</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ•°æ®åŠ è½½</span></span><br><span class="line">data = pd.read_csv(<span class="string">'./creditcard.csv'</span>)</span><br><span class="line"><span class="comment"># æ•°æ®æ¢ç´¢</span></span><br><span class="line">print(data.describe())</span><br><span class="line"><span class="comment"># è®¾ç½®pltæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡</span></span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'SimHei'</span>]</span><br><span class="line"><span class="comment"># ç»˜åˆ¶ç±»åˆ«åˆ†å¸ƒ</span></span><br><span class="line">plt.figure()</span><br><span class="line">ax = sns.countplot(x = <span class="string">'Class'</span>, data = data)</span><br><span class="line">plt.title(<span class="string">'ç±»åˆ«åˆ†å¸ƒ'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºäº¤æ˜“ç¬”æ•°ï¼Œæ¬ºè¯ˆäº¤æ˜“ç¬”æ•°</span></span><br><span class="line">num = len(data)</span><br><span class="line">num_fraud = len(data[data[<span class="string">'Class'</span>]==<span class="number">1</span>]) </span><br><span class="line">print(<span class="string">'æ€»äº¤æ˜“ç¬”æ•°: '</span>, num)</span><br><span class="line">print(<span class="string">'è¯ˆéª—äº¤æ˜“ç¬”æ•°ï¼š'</span>, num_fraud)</span><br><span class="line">print(<span class="string">'è¯ˆéª—äº¤æ˜“æ¯”ä¾‹ï¼š&#123;:.6f&#125;'</span>.format(num_fraud/num))</span><br><span class="line"><span class="comment"># æ¬ºè¯ˆå’Œæ­£å¸¸äº¤æ˜“å¯è§†åŒ–</span></span><br><span class="line">f, (ax1, ax2) = plt.subplots(<span class="number">2</span>, <span class="number">1</span>, sharex=<span class="literal">True</span>, figsize=(<span class="number">15</span>,<span class="number">8</span>))</span><br><span class="line">bins = <span class="number">50</span></span><br><span class="line">ax1.hist(data.Time[data.Class == <span class="number">1</span>], bins = bins, color = <span class="string">'deeppink'</span>)</span><br><span class="line">ax1.set_title(<span class="string">'è¯ˆéª—äº¤æ˜“'</span>)</span><br><span class="line">ax2.hist(data.Time[data.Class == <span class="number">0</span>], bins = bins, color = <span class="string">'deepskyblue'</span>)</span><br><span class="line">ax2.set_title(<span class="string">'æ­£å¸¸äº¤æ˜“'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'æ—¶é—´'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'äº¤æ˜“æ¬¡æ•°'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># å¯¹Amountè¿›è¡Œæ•°æ®è§„èŒƒåŒ–</span></span><br><span class="line">data[<span class="string">'Amount_Norm'</span>] = StandardScaler().fit_transform(data[<span class="string">'Amount'</span>].values.reshape(<span class="number">-1</span>,<span class="number">1</span>))</span><br><span class="line"><span class="comment"># ç‰¹å¾é€‰æ‹©</span></span><br><span class="line">y = np.array(data.Class.tolist())</span><br><span class="line">data = data.drop([<span class="string">'Time'</span>,<span class="string">'Amount'</span>,<span class="string">'Class'</span>],axis=<span class="number">1</span>)</span><br><span class="line">X = np.array(data.as_matrix())</span><br><span class="line"><span class="comment"># å‡†å¤‡è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">train_x, test_x, train_y, test_y = train_test_split (X, y, test_size = <span class="number">0.1</span>, random_state = <span class="number">33</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># é€»è¾‘å›å½’åˆ†ç±»</span></span><br><span class="line">clf = LogisticRegression()</span><br><span class="line">clf.fit(train_x, train_y)</span><br><span class="line">predict_y = clf.predict(test_x)</span><br><span class="line"><span class="comment"># é¢„æµ‹æ ·æœ¬çš„ç½®ä¿¡åˆ†æ•°</span></span><br><span class="line">score_y = clf.decision_function(test_x)  </span><br><span class="line"><span class="comment"># è®¡ç®—æ··æ·†çŸ©é˜µï¼Œå¹¶æ˜¾ç¤º</span></span><br><span class="line">cm = confusion_matrix(test_y, predict_y)</span><br><span class="line">class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ··æ·†çŸ©é˜µ</span></span><br><span class="line">plot_confusion_matrix(cm, classes = class_names, title = <span class="string">'é€»è¾‘å›å½’ æ··æ·†çŸ©é˜µ'</span>)</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ¨¡å‹è¯„ä¼°åˆ†æ•°</span></span><br><span class="line">show_metrics()</span><br><span class="line"><span class="comment"># è®¡ç®—ç²¾ç¡®ç‡ï¼Œå¬å›ç‡ï¼Œé˜ˆå€¼ç”¨äºå¯è§†åŒ–</span></span><br><span class="line">precision, recall, thresholds = precision_recall_curve(test_y, score_y)</span><br><span class="line">plot_precision_recall()</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">                Time            V1      ...               Amount          Class</span><br><span class="line">count  <span class="number">284807.000000</span>  <span class="number">2.848070e+05</span>      ...        <span class="number">284807.000000</span>  <span class="number">284807.000000</span></span><br><span class="line">mean    <span class="number">94813.859575</span>  <span class="number">1.165980e-15</span>      ...            <span class="number">88.349619</span>       <span class="number">0.001727</span></span><br><span class="line">std     <span class="number">47488.145955</span>  <span class="number">1.958696e+00</span>      ...           <span class="number">250.120109</span>       <span class="number">0.041527</span></span><br><span class="line">min         <span class="number">0.000000</span> <span class="number">-5.640751e+01</span>      ...             <span class="number">0.000000</span>       <span class="number">0.000000</span></span><br><span class="line"><span class="number">25</span>%     <span class="number">54201.500000</span> <span class="number">-9.203734e-01</span>      ...             <span class="number">5.600000</span>       <span class="number">0.000000</span></span><br><span class="line"><span class="number">50</span>%     <span class="number">84692.000000</span>  <span class="number">1.810880e-02</span>      ...            <span class="number">22.000000</span>       <span class="number">0.000000</span></span><br><span class="line"><span class="number">75</span>%    <span class="number">139320.500000</span>  <span class="number">1.315642e+00</span>      ...            <span class="number">77.165000</span>       <span class="number">0.000000</span></span><br><span class="line">max    <span class="number">172792.000000</span>  <span class="number">2.454930e+00</span>      ...         <span class="number">25691.160000</span>       <span class="number">1.000000</span></span><br><span class="line"></span><br><span class="line">[<span class="number">8</span> rows x <span class="number">31</span> columns]</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586967850283-e9af3698-331c-4e3e-ae8f-d490803e2811.png#align=left&display=inline&height=1363&margin=%5Bobject%20Object%5D&name=5e98974d6c2e87168b40e5f751d00f61.png&originHeight=1363&originWidth=1728&size=89241&status=done&style=none&width=1728" alt="5e98974d6c2e87168b40e5f751d00f61.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ€»äº¤æ˜“ç¬”æ•°:  284807</span><br><span class="line">è¯ˆéª—äº¤æ˜“ç¬”æ•°ï¼š 492</span><br><span class="line">è¯ˆéª—äº¤æ˜“æ¯”ä¾‹ï¼š0.001727</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586967935125-87c5538f-27a4-44d1-8a27-c67cb6cbde4d.png#align=left&display=inline&height=1458&margin=%5Bobject%20Object%5D&name=bfe65c34b74de661477d9b59d4db6a39.png&originHeight=1458&originWidth=1729&size=121793&status=done&style=none&width=1729" alt="bfe65c34b74de661477d9b59d4db6a39.png">)<img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586967952349-d6855347-0edd-4caa-819e-7c98e253769b.png#align=left&display=inline&height=1022&margin=%5Bobject%20Object%5D&name=c8a59cb4f3d94c91eb6648be1b0429d2.png&originHeight=1022&originWidth=1726&size=88131&status=done&style=none&width=1726" alt="c8a59cb4f3d94c91eb6648be1b0429d2.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç²¾ç¡®ç‡: 0.841</span><br><span class="line">å¬å›ç‡: 0.617</span><br><span class="line">F1å€¼: 0.712</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586967968745-3cf776d3-884d-4af6-a270-b33cefc550c9.png#align=left&display=inline&height=446&margin=%5Bobject%20Object%5D&name=28ccd0f8d609046b2bafb27fb1195269.png&originHeight=446&originWidth=567&size=16903&status=done&style=none&width=567" alt="28ccd0f8d609046b2bafb27fb1195269.png"><br>ä½ èƒ½çœ‹å‡ºæ¥æ¬ºè¯ˆäº¤æ˜“çš„ç¬”æ•°ä¸º 492 ç¬”ï¼Œå æ‰€æœ‰äº¤æ˜“çš„æ¯”ä¾‹æ˜¯å¾ˆä½çš„ï¼Œå³ 0.001727ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ•°æ®å¯è§†åŒ–çš„æ–¹å¼å¯¹æ¬ºè¯ˆäº¤æ˜“å’Œæ­£å¸¸äº¤æ˜“çš„åˆ†å¸ƒè¿›è¡Œå‘ˆç°ã€‚å¦å¤–é€šè¿‡å¯è§†åŒ–ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡ºç²¾ç¡®ç‡å’Œå¬å›ç‡ä¹‹é—´çš„å…³ç³»ï¼Œå½“ç²¾ç¡®ç‡é«˜çš„æ—¶å€™ï¼Œå¬å›ç‡å¾€å¾€å¾ˆä½ï¼Œå¬å›ç‡é«˜çš„æ—¶å€™ï¼Œç²¾ç¡®ç‡ä¼šæ¯”è¾ƒä½ã€‚<br><br><br>ä»£ç æœ‰ä¸€äº›æ¨¡å—éœ€è¦è¯´æ˜ä¸‹ã€‚æˆ‘å®šä¹‰äº† plot_confusion_matrix å‡½æ•°å¯¹æ··æ·†çŸ©é˜µè¿›è¡Œå¯è§†åŒ–ã€‚ä»€ä¹ˆæ˜¯æ··æ·†çŸ©é˜µå‘¢ï¼Ÿæ··æ·†çŸ©é˜µä¹Ÿå«è¯¯å·®çŸ©é˜µï¼Œå®é™…ä¸Šå®ƒå°±æ˜¯ TPã€FPã€TNã€FN è¿™å››ä¸ªæ•°å€¼çš„çŸ©é˜µè¡¨ç¤ºï¼Œå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­é¢„æµ‹å€¼å’Œå®é™…å€¼ç›¸æ¯”ï¼Œå¯¹äº†å¤šå°‘ã€‚ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ èƒ½çœ‹å‡º TP=37ï¼ŒFP=7ï¼ŒFN=23ã€‚æ‰€ä»¥ç²¾ç¡®ç‡ P=TP/(TP+FP)=37/(37+7)=0.841ï¼Œå¬å›ç‡ R=TP/(TP+FN)=37/(37+23)=0.617ã€‚ç„¶åä½¿ç”¨äº† sklearn ä¸­çš„ precision_recall_curve å‡½æ•°ï¼Œé€šè¿‡é¢„æµ‹å€¼å’ŒçœŸå®å€¼æ¥è®¡ç®—ç²¾ç¡®ç‡ - å¬å›ç‡æ›²çº¿ã€‚<br><br><br>precision_recall_curve å‡½æ•°ä¼šè®¡ç®—åœ¨ä¸åŒæ¦‚ç‡é˜ˆå€¼æƒ…å†µä¸‹çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡ã€‚æœ€åå®šä¹‰ plot_precision_recall å‡½æ•°ï¼Œç»˜åˆ¶æ›²çº¿ã€‚<br></p><p><a name="ig5Sr"></a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><br>ä»Šå¤©æˆ‘ç»™ä½ è®²äº†é€»è¾‘å›å½’çš„æ¦‚å¿µå’Œç›¸å…³å·¥å…·çš„ä½¿ç”¨ï¼Œå¦å¤–å­¦ä¹ äº†åœ¨æ•°æ®æ ·æœ¬ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•è¯„ä¼°æ¨¡å‹ã€‚è¿™é‡Œä½ éœ€è¦äº†è§£ç²¾ç¡®ç‡ï¼Œå¬å›ç‡å’Œ F1 çš„æ¦‚å¿µå’Œè®¡ç®—æ–¹å¼ã€‚<br><br><br>æœ€ååœ¨ä¿¡ç”¨å¡æ¬ºè¯ˆåˆ†æçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é€»è¾‘å›å½’å·¥å…·ï¼Œå¹¶å¯¹æ··æ·†çŸ©é˜µè¿›è¡Œäº†è®¡ç®—ï¼ŒåŒæ—¶åœ¨æ¨¡å‹ç»“æœè¯„ä¼°ä¸­ï¼Œä½¿ç”¨äº†ç²¾ç¡®ç‡ã€å¬å›ç‡å’Œ F1 å€¼ï¼Œæœ€åå¾—åˆ°ç²¾ç¡®ç‡ - å¬å›ç‡æ›²çº¿çš„å¯è§†åŒ–ç»“æœã€‚ä»è¿™ä¸ªé¡¹ç›®ä¸­ä½ èƒ½çœ‹å‡ºæ¥ï¼Œä¸æ˜¯æ‰€æœ‰çš„åˆ†ç±»éƒ½æ˜¯æ ·æœ¬å¹³è¡¡çš„æƒ…å†µï¼Œé’ˆå¯¹æ­£ä¾‹æ¯”ä¾‹æä½çš„æƒ…å†µï¼Œæ¯”å¦‚ä¿¡ç”¨å¡æ¬ºè¯ˆã€æŸäº›ç–¾ç—…çš„è¯†åˆ«ï¼Œæˆ–è€…æ˜¯ææ€–åˆ†å­çš„åˆ¤æ–­ç­‰ï¼Œéƒ½éœ€è¦é‡‡ç”¨ç²¾ç¡®ç‡ - å¬å›ç‡æ¥è¿›è¡Œç»Ÿè®¡ã€‚<br><br><br><img src="https://cdn.nlark.com/yuque/0/2020/png/1072113/1586968908701-9553e7eb-6051-4c47-86c4-3af7e07d490d.png#align=left&display=inline&height=356&margin=%5Bobject%20Object%5D&name=abee1a58b99814f1e0218778b98a6950.png&originHeight=824&originWidth=1729&size=318818&status=done&style=none&width=746" alt="abee1a58b99814f1e0218778b98a6950.png"><br></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sun May 31 2020 18:17:01 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ç”¨éšæœºæ£®æ—ä»¥åŠä¹‹å‰è®²è¿‡çš„ SVMã€å†³ç­–æ ‘å’Œ KNN åˆ†ç±»å™¨å¯¹ä¿¡ç”¨å¡è¿çº¦æ•°æ®è¿›è¡Œäº†åˆ†æï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬æ¥ç ”ç©¶ä¸‹ä¿¡ç”¨å¡æ¬ºè¯ˆã€‚&lt;br&gt;&lt;
      
    
    </summary>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="cpeixin.cn/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="é€»è¾‘å›å½’" scheme="cpeixin.cn/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"/>
    
  </entry>
  
</feed>
